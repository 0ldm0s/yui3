<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>API: node   NodeExtras.js  (YUI Library)</title>
	<link rel="stylesheet" type="text/css" href="assets/api.css">
    <script type="text/javascript" src="assets/api-js"></script>
    <script type="text/javascript" src="assets/ac-js"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">

	<div id="hd">
        <a href="http://developer.yahoo.com/yui/"><h1>Yahoo! UI Library</h1></a>
        <h3>node&nbsp; <span class="subtitle">3.00PR1</span></h3>
        <p>
        <a href="./index.html">Yahoo! UI Library</a> 
            &gt; <a href="./module_node.html">node</a>
                
                 &gt; NodeExtras.js (source view) 
            </p>

	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form name="yui-classopts-form">
    <span id="classopts"><input type="checkbox" name="showprivate" id="showprivate" /> Show Private</span>
    <span id="classopts"><input type="checkbox" name="showprotected" id="showprotected" /> Show Protected</span>
    <span id="classopts"><input type="checkbox" name="showdeprecated" id="showdeprecated" /> Show Deprecated</span>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 #classopts { display:none; }
                        </style>
<div class="highlight" ><pre><span class="c">/**</span>
<span class="c"> * Extended interface for Node</span>
<span class="c"> * @module nodeextras</span>
<span class="c"> */</span>

<span class="nx">YUI</span><span class="o">.</span><span class="nx">add</span><span class="o">(</span><span class="s1">&#39;nodeextras&#39;</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">Y</span><span class="o">)</span> <span class="o">{</span>

    <span class="c">/**</span>
<span class="c">     * An interface for advanced DOM features.</span>
<span class="c">     * @interface NodeExtras</span>
<span class="c">     */</span>

    <span class="k">var</span> <span class="nx">CLASS_NAME</span> <span class="o">=</span> <span class="s1">&#39;className&#39;</span><span class="o">,</span>
        <span class="nx">OFFSET_TOP</span> <span class="o">=</span> <span class="s1">&#39;offsetTop&#39;</span><span class="o">,</span>
        <span class="nx">POSITION</span> <span class="o">=</span> <span class="s1">&#39;position&#39;</span><span class="o">,</span>
        <span class="nx">FIXED</span> <span class="o">=</span> <span class="s1">&#39;fixed&#39;</span><span class="o">,</span>
        <span class="nx">RELATIVE</span> <span class="o">=</span> <span class="s1">&#39;relative&#39;</span><span class="o">,</span>
        <span class="nx">LEFT</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="o">,</span>
        <span class="nx">TOP</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span><span class="o">,</span>
        <span class="nx">NODE_TYPE</span> <span class="o">=</span> <span class="s1">&#39;nodeType&#39;</span><span class="o">,</span>
        <span class="nx">OFFSET_LEFT</span> <span class="o">=</span> <span class="s1">&#39;offsetLeft&#39;</span><span class="o">,</span>
        <span class="nx">GET_BOUNDING_CLIENT_RECT</span> <span class="o">=</span> <span class="s1">&#39;getBoundingClientRect&#39;</span><span class="o">,</span>
        <span class="nx">COMPARE_DOCUMENT_POSITION</span> <span class="o">=</span> <span class="s1">&#39;compareDocumentPosition&#39;</span><span class="o">;</span>

    <span class="k">var</span> <span class="nx">regexCache</span> <span class="o">=</span> <span class="o">{};</span>
    <span class="k">var</span> <span class="nx">getRegExp</span> <span class="o">=</span> <span class="k">function</span><span class="o">(</span><span class="nx">str</span><span class="o">,</span> <span class="nx">flags</span><span class="o">)</span> <span class="o">{</span>
        <span class="nx">flags</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(!</span><span class="nx">regexCache</span><span class="o">[</span><span class="nx">str</span> <span class="o">+</span> <span class="nx">flags</span><span class="o">])</span> <span class="o">{</span>
            <span class="nx">regexCache</span><span class="o">[</span><span class="nx">str</span> <span class="o">+</span> <span class="nx">flags</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="o">(</span><span class="nx">str</span><span class="o">,</span> <span class="nx">flags</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="nx">regexCache</span><span class="o">[</span><span class="nx">str</span> <span class="o">+</span> <span class="nx">flags</span><span class="o">];</span>
    <span class="o">};</span>

    <span class="nx">Y</span><span class="o">.</span><span class="nx">Node</span><span class="o">.</span><span class="nx">getters</span><span class="o">({</span>
        <span class="c">/**</span>
<span class="c">         * Normalizes nodeInnerText and textContent. </span>
<span class="c">         * @property text</span>
<span class="c">         * @type String</span>
<span class="c">         */</span>
        <span class="s1">&#39;text&#39;</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;innerText&#39;</span><span class="o">)</span> <span class="o">||</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;textContent&#39;</span><span class="o">)</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">});</span>

    <span class="nx">Y</span><span class="o">.</span><span class="nx">Node</span><span class="o">.</span><span class="nx">methods</span><span class="o">({</span>
        <span class="c">/**</span>
<span class="c">         * Determines whether an HTMLElement has the given className.</span>
<span class="c">         * @method hasClass</span>
<span class="c">         * @param {String} className the class name to search for</span>
<span class="c">         * @return {Boolean | Array} A boolean value or array of boolean values</span>
<span class="c">         */</span>
        <span class="nx">hasClass</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">className</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">re</span> <span class="o">=</span> <span class="nx">getRegExp</span><span class="o">(</span><span class="s1">&#39;(?:^|\\s+)&#39;</span> <span class="o">+</span> <span class="nx">className</span> <span class="o">+</span> <span class="s1">&#39;(?:\\s+|$)&#39;</span><span class="o">);</span>
            <span class="k">return</span> <span class="nx">re</span><span class="o">.</span><span class="nx">test</span><span class="o">(</span><span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">));</span>
        <span class="o">},</span>

        <span class="c">/**</span>
<span class="c">         * Adds a class name to a given element or collection of elements.</span>
<span class="c">         * @method addClass         </span>
<span class="c">         * @param {String} className the class name to add to the class attribute</span>
<span class="c">         * @return {Boolean | Array} A pass/fail boolean or array of booleans</span>
<span class="c">         */</span>
        <span class="nx">addClass</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">className</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">node</span><span class="o">.</span><span class="nx">hasClass</span><span class="o">(</span><span class="nx">className</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span><span class="o">;</span> <span class="c">// already present</span>
<span class="c"></span>            <span class="o">}</span>
            
            <span class="c">//Y.log(&#39;addClass adding &#39; + className, &#39;info&#39;, &#39;Node&#39;);</span>
<span class="c"></span>            
            <span class="nx">node</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">,</span> <span class="nx">Y</span><span class="o">.</span><span class="nx">Lang</span><span class="o">.</span><span class="nx">trim</span><span class="o">([</span><span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">),</span> <span class="nx">className</span><span class="o">].</span><span class="nx">join</span><span class="o">(</span><span class="s1">&#39; &#39;</span><span class="o">)));</span>
        <span class="o">},</span>

        <span class="c">/**</span>
<span class="c">         * Removes a class name from a given element or collection of elements.</span>
<span class="c">         * @method removeClass         </span>
<span class="c">         * @param {String} className the class name to remove from the class attribute</span>
<span class="c">         * @return {Boolean | Array} A pass/fail boolean or array of booleans</span>
<span class="c">         */</span>
        <span class="nx">removeClass</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">className</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(!</span><span class="nx">className</span> <span class="o">||</span> <span class="o">!</span><span class="nx">node</span><span class="o">.</span><span class="nx">hasClass</span><span class="o">(</span><span class="nx">className</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span><span class="o">;</span> <span class="c">// not present</span>
<span class="c"></span>            <span class="o">}</span>                 

            <span class="c">//Y.log(&#39;removeClass removing &#39; + className, &#39;info&#39;, &#39;Node&#39;);</span>
<span class="c"></span>            
            <span class="nx">node</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">,</span>
                    <span class="nx">Y</span><span class="o">.</span><span class="nx">Lang</span><span class="o">.</span><span class="nx">trim</span><span class="o">(</span><span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">).</span><span class="nx">replace</span><span class="o">(</span><span class="nx">getRegExp</span><span class="o">(</span><span class="s1">&#39;(?:^|\\s+)&#39;</span> <span class="o">+</span>
                            <span class="nx">className</span> <span class="o">+</span> <span class="s1">&#39;(?:\\s+|$)&#39;</span><span class="o">),</span> <span class="s1">&#39; &#39;</span><span class="o">)));</span>

            <span class="k">if</span> <span class="o">(</span> <span class="nx">node</span><span class="o">.</span><span class="nx">hasClass</span><span class="o">(</span><span class="nx">className</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span> <span class="c">// in case of multiple adjacent</span>
<span class="c"></span>                <span class="nx">node</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">className</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">},</span>

        <span class="c">/**</span>
<span class="c">         * Replace a class with another class for a given element or collection of elements.</span>
<span class="c">         * If no oldClassName is present, the newClassName is simply added.</span>
<span class="c">         * @method replaceClass  </span>
<span class="c">         * @param {String} oldClassName the class name to be replaced</span>
<span class="c">         * @param {String} newClassName the class name that will be replacing the old class name</span>
<span class="c">         * @return {Boolean | Array} A pass/fail boolean or array of booleans</span>
<span class="c">         */</span>
        <span class="nx">replaceClass</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">newC</span><span class="o">,</span> <span class="nx">oldC</span><span class="o">)</span> <span class="o">{</span>
            <span class="c">//Y.log(&#39;replaceClass replacing &#39; + oldC + &#39; with &#39; + newC, &#39;info&#39;, &#39;Node&#39;);</span>
<span class="c"></span>        
            <span class="k">if</span> <span class="o">(</span> <span class="o">!</span><span class="nx">node</span><span class="o">.</span><span class="nx">hasClass</span><span class="o">(</span><span class="nx">oldC</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
                <span class="nx">node</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">newC</span><span class="o">);</span> <span class="c">// just add it if nothing to replace</span>
<span class="c"></span>                <span class="k">return</span><span class="o">;</span> <span class="c">// NOTE: return</span>
<span class="c"></span>            <span class="o">}</span>
        
            <span class="k">var</span> <span class="nx">re</span> <span class="o">=</span> <span class="nx">getRegExp</span><span class="o">(</span><span class="s1">&#39;(?:^|\\s+)&#39;</span> <span class="o">+</span> <span class="nx">oldC</span> <span class="o">+</span> <span class="s1">&#39;(?:\\s+|$)&#39;</span><span class="o">);</span>
            <span class="nx">node</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">,</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">).</span><span class="nx">replace</span><span class="o">(</span><span class="nx">re</span><span class="o">,</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">newC</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">));</span>

            <span class="k">if</span> <span class="o">(</span> <span class="nx">node</span><span class="o">.</span><span class="nx">hasClass</span><span class="o">(</span><span class="nx">oldC</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span> <span class="c">// in case of multiple adjacent</span>
<span class="c"></span>                <span class="nx">node</span><span class="o">.</span><span class="nx">replaceClass</span><span class="o">(</span><span class="nx">oldC</span><span class="o">,</span> <span class="nx">newC</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nx">node</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">,</span> <span class="nx">Y</span><span class="o">.</span><span class="nx">Lang</span><span class="o">.</span><span class="nx">trim</span><span class="o">(</span><span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">CLASS_NAME</span><span class="o">)));</span> <span class="c">// remove any trailing spaces</span>
<span class="c"></span>        <span class="o">},</span>

        <span class="c">/**</span>
<span class="c">         * Returns the previous sibling that is an HTMLElement. </span>
<span class="c">         * Returns the nearest HTMLElement sibling if no method provided.</span>
<span class="c">         * @method previous</span>
<span class="c">         * @param {Function} method A boolean function used to test siblings</span>
<span class="c">         * that receives the sibling node being tested as its only argument</span>
<span class="c">         * @return {Node} Node instance or null if not found</span>
<span class="c">         */</span>
        <span class="nx">previous</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">method</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="nx">node</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;previousSibling&#39;</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">NODE_TYPE</span><span class="o">)</span> <span class="o">===</span> <span class="m">1</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(!</span><span class="nx">method</span> <span class="o">||</span> <span class="nx">method</span><span class="o">(</span><span class="nx">node</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="nx">node</span><span class="o">;</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">},</span> 

        <span class="c">/**</span>
<span class="c">         * Returns the next HTMLElement sibling that passes the boolean method. </span>
<span class="c">         * Returns the nearest HTMLElement sibling if no method provided.</span>
<span class="c">         * @method next</span>
<span class="c">         * @param {Function} method A boolean function used to test siblings</span>
<span class="c">         * that receives the sibling node being tested as its only argument</span>
<span class="c">         * @return {Object} HTMLElement or null if not found</span>
<span class="c">         */</span>
        <span class="nx">next</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">method</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="nx">node</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;nextSibling&#39;</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">NODE_TYPE</span><span class="o">)</span> <span class="o">===</span> <span class="m">1</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(!</span><span class="nx">method</span> <span class="o">||</span> <span class="nx">method</span><span class="o">(</span><span class="nx">node</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="nx">node</span><span class="o">;</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">},</span>
        
        <span class="c">/**</span>
<span class="c">         * Gets the current position of an element based on page coordinates. </span>
<span class="c">         * Element must be part of the DOM tree to have page coordinates</span>
<span class="c">         * (display:none or elements not appended return false).</span>
<span class="c">         * @method getXY</span>
<span class="c">         * @return {Array} The XY position of the element</span>
<span class="c"></span>
<span class="c">         TODO: test inDocument/display</span>
<span class="c">         */</span>
        <span class="nx">getXY</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">Y</span><span class="o">.</span><span class="nx">Node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;document&#39;</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;documentElement&#39;</span><span class="o">).</span><span class="nx">hasMethod</span><span class="o">(</span><span class="nx">GET_BOUNDING_CLIENT_RECT</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">scrollLeft</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;docScrollX&#39;</span><span class="o">);</span>
                        <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;docScrollY&#39;</span><span class="o">);</span>
                        <span class="nx">box</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">invoke</span><span class="o">(</span><span class="nx">GET_BOUNDING_CLIENT_RECT</span><span class="o">),</span>
                        <span class="nx">xy</span> <span class="o">=</span> <span class="o">[</span><span class="nx">box</span><span class="o">[</span><span class="nx">LEFT</span><span class="o">],</span> <span class="nx">box</span><span class="o">[</span><span class="nx">TOP</span><span class="o">]];</span>

                    <span class="k">if</span> <span class="o">((</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nx">scrollLeft</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="nx">POSITION</span><span class="o">)</span> <span class="o">!=</span> <span class="nx">FIXED</span><span class="o">)</span> <span class="o">{</span> <span class="c">// no scroll accounting for fixed</span>
<span class="c"></span>                        <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+=</span> <span class="nx">scrollLeft</span><span class="o">;</span>
                        <span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+=</span> <span class="nx">scrollTop</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">return</span> <span class="nx">xy</span><span class="o">;</span>
                <span class="o">};</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">)</span> <span class="o">{</span> <span class="c">// manually calculate by crawling up offsetParents</span>
<span class="c"></span>                    <span class="k">var</span> <span class="nx">xy</span> <span class="o">=</span> <span class="o">[</span><span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_LEFT</span><span class="o">),</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_TOP</span><span class="o">)];</span>

                    <span class="k">var</span> <span class="nx">parentNode</span> <span class="o">=</span> <span class="nx">node</span><span class="o">;</span>
                    <span class="k">while</span> <span class="o">(</span><span class="nx">parentNode</span> <span class="o">=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;offsetParent&#39;</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_LEFT</span><span class="o">);</span>
                        <span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_TOP</span><span class="o">);</span>
                    <span class="o">}</span>

                    <span class="c">// account for any scrolled ancestors</span>
<span class="c"></span>                    <span class="k">if</span> <span class="o">(</span><span class="nx">node</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="nx">POSITION</span><span class="o">)</span> <span class="o">!=</span> <span class="nx">FIXED</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">parentNode</span> <span class="o">=</span> <span class="nx">node</span><span class="o">;</span>
                        <span class="k">var</span> <span class="nx">scrollTop</span><span class="o">,</span> <span class="nx">scrollLeft</span><span class="o">;</span>

                        <span class="k">while</span> <span class="o">(</span><span class="nx">parentNode</span> <span class="o">=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;parentNode&#39;</span><span class="o">))</span> <span class="o">{</span>
                            <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;scrollTop&#39;</span><span class="o">);</span>
                            <span class="nx">scrollLeft</span> <span class="o">=</span> <span class="nx">parentNode</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">&#39;scrollLeft&#39;</span><span class="o">);</span>

                            <span class="k">if</span> <span class="o">(</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nx">scrollLeft</span><span class="o">)</span> <span class="o">{</span>
                                <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-=</span> <span class="nx">scrollLeft</span><span class="o">;</span>
                                <span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">-=</span> <span class="nx">scrollTop</span><span class="o">;</span>
                            <span class="o">}</span>
                        <span class="o">}</span>

                    <span class="o">}</span>
                    <span class="k">return</span> <span class="nx">xy</span><span class="o">;</span>
                <span class="o">};</span>
            <span class="o">}</span>
        <span class="o">}(),</span><span class="c">// NOTE: Executing for loadtime branching</span>
<span class="c"></span>
        <span class="c">/**</span>
<span class="c">         * Set the position of an html element in page coordinates, regardless of how the element is positioned.</span>
<span class="c">         * The element(s) must be part of the DOM tree to have page coordinates (display:none or elements not appended return false).</span>
<span class="c">         * @method setXY</span>
<span class="c">         * @param {Array} xy Contains X &amp; Y values for new position (coordinates are page-based)</span>
<span class="c">         * @param {Boolean} noRetry By default we try and set the position a second time if the first fails</span>
<span class="c">         */</span>
        <span class="nx">setXY</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">node</span><span class="o">,</span> <span class="nx">xy</span><span class="o">,</span> <span class="nx">noRetry</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="nx">POSITION</span><span class="o">),</span>
                <span class="nx">delta</span> <span class="o">=</span> <span class="o">[</span> <span class="c">// assuming pixels; if not we will have to retry</span>
<span class="c"></span>                    <span class="nb">parseInt</span><span class="o">(</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="nx">LEFT</span><span class="o">),</span> <span class="m">10</span> <span class="o">),</span>
                    <span class="nb">parseInt</span><span class="o">(</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="nx">TOP</span><span class="o">),</span> <span class="m">10</span> <span class="o">)</span>
                <span class="o">];</span>
        
            <span class="k">if</span> <span class="o">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="s1">&#39;static&#39;</span><span class="o">)</span> <span class="o">{</span> <span class="c">// default to relative</span>
<span class="c"></span>                <span class="nx">pos</span> <span class="o">=</span> <span class="nx">RELATIVE</span><span class="o">;</span>
                <span class="nx">node</span><span class="o">.</span><span class="nx">setStyle</span><span class="o">(</span><span class="nx">POSITION</span><span class="o">,</span> <span class="nx">RELATIVE</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="k">var</span> <span class="nx">currentXY</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getXY</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">currentXY</span> <span class="o">===</span> <span class="kc">false</span><span class="o">)</span> <span class="o">{</span> <span class="c">// has to be part of doc to have xy</span>
<span class="c"></span>                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">&#39;xy failed: node not available&#39;</span><span class="o">,</span> <span class="s1">&#39;error&#39;</span><span class="o">,</span> <span class="s1">&#39;Node&#39;</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span> 
            <span class="o">}</span>
            
            <span class="k">if</span> <span class="o">(</span> <span class="nb">isNaN</span><span class="o">(</span><span class="nx">delta</span><span class="o">[</span><span class="m">0</span><span class="o">])</span> <span class="o">)</span> <span class="o">{</span><span class="c">// in case of &#39;auto&#39;</span>
<span class="c"></span>                <span class="nx">delta</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="nx">RELATIVE</span><span class="o">)</span> <span class="o">?</span> <span class="m">0</span> <span class="o">:</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_LEFT</span><span class="o">);</span>
            <span class="o">}</span> 
            <span class="k">if</span> <span class="o">(</span> <span class="nb">isNaN</span><span class="o">(</span><span class="nx">delta</span><span class="o">[</span><span class="m">1</span><span class="o">])</span> <span class="o">)</span> <span class="o">{</span> <span class="c">// in case of &#39;auto&#39;</span>
<span class="c"></span>                <span class="nx">delta</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="nx">RELATIVE</span><span class="o">)</span> <span class="o">?</span> <span class="m">0</span> <span class="o">:</span> <span class="nx">node</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="nx">OFFSET_TOP</span><span class="o">);</span>
            <span class="o">}</span> 

            <span class="k">if</span> <span class="o">(</span><span class="nx">pos</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">node</span><span class="o">.</span><span class="nx">setStyle</span><span class="o">(</span><span class="nx">LEFT</span><span class="o">,</span> <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-</span> <span class="nx">currentXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nx">delta</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="k">if</span> <span class="o">(</span><span class="nx">pos</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">node</span><span class="o">.</span><span class="nx">setStyle</span><span class="o">(</span><span class="nx">TOP</span><span class="o">,</span> <span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">-</span> <span class="nx">currentXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="nx">delta</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="o">);</span>
            <span class="o">}</span>
          
            <span class="k">if</span> <span class="o">(!</span><span class="nx">noRetry</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">newXY</span> <span class="o">=</span> <span class="nx">node</span><span class="o">.</span><span class="nx">getXY</span><span class="o">();</span>

                <span class="c">// if retry is true, try one more time if we miss </span>
<span class="c"></span>               <span class="k">if</span> <span class="o">(</span> <span class="o">(</span><span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">!=</span> <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">])</span> <span class="o">||</span> 
                    <span class="o">(</span><span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">!=</span> <span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">])</span> <span class="o">)</span> <span class="o">{</span>
                   <span class="nx">node</span><span class="o">.</span><span class="nx">setXY</span><span class="o">(</span><span class="nx">xy</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
               <span class="o">}</span>
            <span class="o">}</span>        

            <span class="nx">Y</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">&#39;setXY setting position to &#39;</span> <span class="o">+</span> <span class="nx">xy</span><span class="o">,</span> <span class="s1">&#39;info&#39;</span><span class="o">,</span> <span class="s1">&#39;Node&#39;</span><span class="o">);</span>
        <span class="o">}</span>
    
    <span class="o">});</span>

<span class="o">},</span> <span class="s1">&#39;3.0.0&#39;</span><span class="o">,</span> <span class="o">{</span> <span class="nx">requires</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;node&#39;</span><span class="o">]</span> <span class="o">});</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div class="module">
                        <h4>Modules</h4>
                        <ul class="content">

                                <li class=""><a href="module_animation.html">animation</a></li>

                                <li class=""><a href="module_attribute.html">attribute</a></li>

                                <li class=""><a href="module_dd-constrain.html">dd-constrain</a></li>

                                <li class=""><a href="module_dd-ddm.html">dd-ddm</a></li>

                                <li class=""><a href="module_dd-ddm-base.html">dd-ddm-base</a></li>

                                <li class=""><a href="module_dd-ddm-drop.html">dd-ddm-drop</a></li>

                                <li class=""><a href="module_dd-drag.html">dd-drag</a></li>

                                <li class=""><a href="module_dd-drop.html">dd-drop</a></li>

                                <li class=""><a href="module_dd-plugin.html">dd-plugin</a></li>

                                <li class=""><a href="module_dd-proxy.html">dd-proxy</a></li>

                                <li class=""><a href="module_JSON.html">JSON</a></li>

                                <li class="selected"><a href="module_node.html">node</a></li>

                                <li class=""><a href="module_nodeextras.html">nodeextras</a></li>

                                <li class=""><a href="module_selector.html">selector</a></li>

                                <li class=""><a href="module_yui.html">yui</a></li>
                        </ul>
                    </div>

                    <div class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="Node.html">Node</a></li>
                                <li class=""><a href="NodeList.html">NodeList</a></li>
                        </ul>
                    </div>

                    <div class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class=""><a href="Node.js.html">Node.js</a></li>
                                <li class="selected"><a href="NodeExtras.js.html">NodeExtras.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2008 Yahoo! Inc. All rights reserved.
	</div>
</div>
</body>
</html>
