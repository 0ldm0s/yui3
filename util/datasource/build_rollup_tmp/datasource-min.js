YUI.add("datasource-base",function(Y){Y.namespace("DataSource");Y.mix(Y.DataSource,{_tId:0,TYPE_UNKNOWN:-1,TYPE_JSARRAY:0,TYPE_JSFUNCTION:1,TYPE_XHR:2,TYPE_JSON:3,TYPE_XML:4,TYPE_TEXT:5,TYPE_HTMLTABLE:6,TYPE_SCRIPTNODE:7,TYPE_LOCAL:8,issueCallback:function(callback,params,error){if(callback){var scope=callback.scope||window,callbackFunc=(error)?callback.failure:callback.success;if(callbackFunc){callbackFunc.apply(scope,params.concat([callback.argument]));}}}});var LANG=Y.Lang,Base=function(){Base.superclass.constructor.apply(this,arguments);};Y.mix(Base,{NAME:"DataSource.Base",ATTRS:{liveData:{},dataType:{value:Y.DataSource.TYPE_UNKNOWN},responseType:{value:Y.DataSource.TYPE_UNKNOWN},responseSchema:{value:{}},ERROR_DATAINVALID:{value:"Invalid data"},ERROR_DATANULL:{value:"Null data"}}});Y.extend(Base,Y.Base,{_queue:null,_intervals:null,_initEvents:function(){var events=["dataErrorEvent","requestEvent","responseEvent","responseParseEvent"];Y.each(events,function(v,k){this.publish(v,{type:v,emitFacade:true,bubbles:true,preventable:false,queuable:true});},this);},initializer:function(){this._queue={interval:null,conn:null,requests:[]};this._intervals=[];},destructor:function(){},setInterval:function(msec,request,callback){if(LANG.isNumber(msec)&&(msec>=0)){var self=this,id=setInterval(function(){self.makeConnection(request,callback);},msec);this._intervals.push(id);return id;}else{}},clearInterval:function(id){var tracker=this._intervals||[],i=tracker.length-1;for(;i>-1;i--){if(tracker[i]===id){tracker.splice(i,1);clearInterval(id);}}},sendRequest:function(request,callback){return this.makeConnection(request,callback);},makeConnection:function(request,callback){var tId=Y.DataSource._tId++;this.fire("requestEvent",{tId:tId,request:request,callback:callback});var rawresponse=this.get("liveData");this.handleResponse(request,rawresponse,callback,tId);return tId;},handleResponse:function(oRequest,oRawResponse,oCallback,tId){this.fire("responseEvent",{tId:tId,request:oRequest,response:oRawResponse,callback:oCallback});var xhr=(this.dataType==Y.DataSource.TYPE_XHR)?true:false;var oParsedResponse=null;var oFullResponse=oRawResponse;if(this.responseType===Y.DataSource.TYPE_UNKNOWN){var ctype=(oRawResponse&&oRawResponse.getResponseHeader)?oRawResponse.getResponseHeader["Content-Type"]:null;if(ctype){if(ctype.indexOf("text/xml")>-1){this.responseType=Y.DataSource.TYPE_XML;}else{if(ctype.indexOf("application/json")>-1){this.responseType=Y.DataSource.TYPE_JSON;}else{if(ctype.indexOf("text/plain")>-1){this.responseType=Y.DataSource.TYPE_TEXT;}}}}else{if(LANG.isArray(oRawResponse)){this.responseType=Y.DataSource.TYPE_JSARRAY;}else{if(oRawResponse&&oRawResponse.nodeType&&oRawResponse.nodeType==9){this.responseType=Y.DataSource.TYPE_XML;}else{if(oRawResponse&&oRawResponse.nodeName&&(oRawResponse.nodeName.toLowerCase()=="table")){this.responseType=Y.DataSource.TYPE_HTMLTABLE;}else{if(LANG.isObject(oRawResponse)){this.responseType=Y.DataSource.TYPE_JSON;}else{if(LANG.isString(oRawResponse)){this.responseType=Y.DataSourec.TYPE_TEXT;}}}}}}}switch(this.responseType){case Y.DataSource.TYPE_JSARRAY:if(xhr&&oRawResponse&&oRawResponse.responseText){oFullResponse=oRawResponse.responseText;}try{if(LANG.isString(oFullResponse)){if(LANG.JSON){oFullResponse=LANG.JSON.parse(oFullResponse);}else{if(window.JSON&&JSON.parse){oFullResponse=JSON.parse(oFullResponse);}else{if(oFullResponse.parseJSON){oFullResponse=oFullResponse.parseJSON();}else{while(oFullResponse.length>0&&(oFullResponse.charAt(0)!="{")&&(oFullResponse.charAt(0)!="[")){oFullResponse=oFullResponse.substring(1,oFullResponse.length);}if(oFullResponse.length>0){var arrayEnd=Math.max(oFullResponse.lastIndexOf("]"),oFullResponse.lastIndexOf("}"));oFullResponse=oFullResponse.substring(0,arrayEnd+1);oFullResponse=eval("("+oFullResponse+")");}}}}}}catch(e){}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseArrayData(oRequest,oFullResponse);break;case Y.DataSource.TYPE_JSON:if(xhr&&oRawResponse&&oRawResponse.responseText){oFullResponse=oRawResponse.responseText;}try{if(LANG.isString(oFullResponse)){if(LANG.JSON){oFullResponse=LANG.JSON.parse(oFullResponse);}else{if(window.JSON&&JSON.parse){oFullResponse=JSON.parse(oFullResponse);}else{if(oFullResponse.parseJSON){oFullResponse=oFullResponse.parseJSON();}else{while(oFullResponse.length>0&&(oFullResponse.charAt(0)!="{")&&(oFullResponse.charAt(0)!="[")){oFullResponse=oFullResponse.substring(1,oFullResponse.length);}if(oFullResponse.length>0){var objEnd=Math.max(oFullResponse.lastIndexOf("]"),oFullResponse.lastIndexOf("}"));oFullResponse=oFullResponse.substring(0,objEnd+1);oFullResponse=eval("("+oFullResponse+")");}}}}}}catch(e){}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseJSONData(oRequest,oFullResponse);break;case Y.DataSource.TYPE_HTMLTABLE:if(xhr&&oRawResponse.responseText){oFullResponse=oRawResponse.responseText;}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseHTMLTableData(oRequest,oFullResponse);break;case Y.DataSource.TYPE_XML:if(xhr&&oRawResponse.responseXML){oFullResponse=oRawResponse.responseXML;}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseXMLData(oRequest,oFullResponse);break;case Y.DataSource.TYPE_TEXT:if(xhr&&LANG.isString(oRawResponse.responseText)){oFullResponse=oRawResponse.responseText;}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseTextData(oRequest,oFullResponse);break;default:oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseData(oRequest,oFullResponse);break;}oParsedResponse=oParsedResponse||{};if(!oParsedResponse.results){oParsedResponse.results=[];}if(!oParsedResponse.meta){oParsedResponse.meta={};}if(oParsedResponse&&!oParsedResponse.error){oParsedResponse=this.doBeforeCallback(oRequest,oFullResponse,oParsedResponse,oCallback);
this.fire("responseParseEvent",{request:oRequest,response:oParsedResponse,callback:oCallback});}else{oParsedResponse.error=true;this.fire("dataErrorEvent",{request:oRequest,response:oRawResponse,callback:oCallback,message:this.get("ERROR_DATANULL")});}oParsedResponse.tId=tId;Y.DataSource.issueCallback(oCallback,[oRequest,oParsedResponse],oParsedResponse.error);},doBeforeParseData:function(oRequest,oFullResponse,oCallback){return oFullResponse;},doBeforeCallback:function(oRequest,oFullResponse,oParsedResponse,oCallback){return oParsedResponse;},parseData:function(oRequest,oFullResponse){if(LANG.isValue(oFullResponse)){var oParsedResponse={results:oFullResponse,meta:{}};return oParsedResponse;}return null;}});Y.DataSource.Base=Base;Y.namespace("String");Y.String.parse=function(data){if(!LANG.isValue(data)){return null;}var string=data+"";if(LANG.isString(string)){return string;}else{return null;}};Y.namespace("Number");Y.Number={parse:function(oData){var number=oData*1;if(LANG.isNumber(number)){return number;}else{return null;}},stringify:function(data,config){config=config||{};if(!LANG.isNumber(data)){data*=1;}if(LANG.isNumber(data)){var isNegative=(data<0),output=data+"",decimalSeparator=(config.decimalSeparator)?config.decimalSeparator:".",dotIndex;if(LANG.isNumber(config.decimalPlaces)){var decimalPlaces=config.decimalPlaces,decimal=Math.pow(10,decimalPlaces);output=Math.round(data*decimal)/decimal+"";dotIndex=output.lastIndexOf(".");if(decimalPlaces>0){if(dotIndex<0){output+=decimalSeparator;dotIndex=output.length-1;}else{if(decimalSeparator!=="."){output=output.replace(".",decimalSeparator);}}while((output.length-1-dotIndex)<decimalPlaces){output+="0";}}}if(config.thousandsSeparator){var thousandsSeparator=config.thousandsSeparator;dotIndex=output.lastIndexOf(decimalSeparator);dotIndex=(dotIndex>-1)?dotIndex:output.length;var newOutput=output.substring(dotIndex);var count=-1;for(var i=dotIndex;i>0;i--){count++;if((count%3===0)&&(i!==dotIndex)&&(!isNegative||(i>1))){newOutput=thousandsSeparator+newOutput;}newOutput=output.charAt(i-1)+newOutput;}output=newOutput;}output=(config.prefix)?config.prefix+output:output;output=(config.suffix)?output+config.suffix:output;return output;}else{return data;}}};var xPad=function(x,pad,r){if(typeof r==="undefined"){r=10;}for(;parseInt(x,10)<r&&r>1;r/=10){x=pad.toString()+x;}return x.toString();};Y.namespace("Date");var Dt={parse:function(data){var date=null;if(!(data instanceof Date)){date=new Date(data);}else{return data;}if(date instanceof Date){return date;}else{return null;}},formats:{a:function(d,l){return l.a[d.getDay()];},A:function(d,l){return l.A[d.getDay()];},b:function(d,l){return l.b[d.getMonth()];},B:function(d,l){return l.B[d.getMonth()];},C:function(d){return xPad(parseInt(d.getFullYear()/100,10),0);},d:["getDate","0"],e:["getDate"," "],g:function(d){return xPad(parseInt(Dt.formats.G(d)%100,10),0);},G:function(d){var y=d.getFullYear();var V=parseInt(Dt.formats.V(d),10);var W=parseInt(Dt.formats.W(d),10);if(W>V){y++;}else{if(W===0&&V>=52){y--;}}return y;},H:["getHours","0"],I:function(d){var I=d.getHours()%12;return xPad(I===0?12:I,0);},j:function(d){var gmd_1=new Date(""+d.getFullYear()+"/1/1 GMT");var gmdate=new Date(""+d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate()+" GMT");var ms=gmdate-gmd_1;var doy=parseInt(ms/60000/60/24,10)+1;return xPad(doy,0,100);},k:["getHours"," "],l:function(d){var I=d.getHours()%12;return xPad(I===0?12:I," ");},m:function(d){return xPad(d.getMonth()+1,0);},M:["getMinutes","0"],p:function(d,l){return l.p[d.getHours()>=12?1:0];},P:function(d,l){return l.P[d.getHours()>=12?1:0];},s:function(d,l){return parseInt(d.getTime()/1000,10);},S:["getSeconds","0"],u:function(d){var dow=d.getDay();return dow===0?7:dow;},U:function(d){var doy=parseInt(Dt.formats.j(d),10);var rdow=6-d.getDay();var woy=parseInt((doy+rdow)/7,10);return xPad(woy,0);},V:function(d){var woy=parseInt(Dt.formats.W(d),10);var dow1_1=(new Date(""+d.getFullYear()+"/1/1")).getDay();var idow=woy+(dow1_1>4||dow1_1<=1?0:1);if(idow===53&&(new Date(""+d.getFullYear()+"/12/31")).getDay()<4){idow=1;}else{if(idow===0){idow=Dt.formats.V(new Date(""+(d.getFullYear()-1)+"/12/31"));}}return xPad(idow,0);},w:"getDay",W:function(d){var doy=parseInt(Dt.formats.j(d),10);var rdow=7-Dt.formats.u(d);var woy=parseInt((doy+rdow)/7,10);return xPad(woy,0,10);},y:function(d){return xPad(d.getFullYear()%100,0);},Y:"getFullYear",z:function(d){var o=d.getTimezoneOffset();var H=xPad(parseInt(Math.abs(o/60),10),0);var M=xPad(Math.abs(o%60),0);return(o>0?"-":"+")+H+M;},Z:function(d){var tz=d.toString().replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,"");if(tz.length>4){tz=Dt.formats.z(d);}return tz;},"%":function(d){return"%";}},aggregates:{c:"locale",D:"%m/%d/%y",F:"%Y-%m-%d",h:"%b",n:"\n",r:"locale",R:"%H:%M",t:"\t",T:"%H:%M:%S",x:"locale",X:"locale"},stringify:function(oDate,oConfig,sLocale){oConfig=oConfig||{};if(!(oDate instanceof Date)){return LANG.isValue(oDate)?oDate:"";}var format=oConfig.format||"%m/%d/%Y";if(format==="YYYY/MM/DD"){format="%Y/%m/%d";}else{if(format==="DD/MM/YYYY"){format="%d/%m/%Y";}else{if(format==="MM/DD/YYYY"){format="%m/%d/%Y";}}}sLocale=sLocale||"en";if(!(sLocale in Y.DateLocale)){if(sLocale.replace(/-[a-zA-Z]+$/,"") in Y.DateLocale){sLocale=sLocale.replace(/-[a-zA-Z]+$/,"");}else{sLocale="en";}}var aLocale=Y.DateLocale[sLocale];var replace_aggs=function(m0,m1){var f=Dt.aggregates[m1];return(f==="locale"?aLocale[m1]:f);};var replace_formats=function(m0,m1){var f=Dt.formats[m1];if(typeof f==="string"){return oDate[f]();}else{if(typeof f==="function"){return f.call(oDate,oDate,aLocale);}else{if(typeof f==="object"&&typeof f[0]==="string"){return xPad(oDate[f[0]](),f[1]);}else{return m1;}}}};while(format.match(/%[cDFhnrRtTxX]/)){format=format.replace(/%([cDFhnrRtTxX])/g,replace_aggs);}var str=format.replace(/%([aAbBCdegGHIjklmMpPsSuUVwWyYzZ%])/g,replace_formats);replace_aggs=replace_formats=undefined;return str;}};
Y.Date=Dt;Y.namespace("DateLocale");var Dl={a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %T %Z",p:["AM","PM"],P:["am","pm"],r:"%I:%M:%S %p",x:"%d/%m/%y",X:"%T"};Dl["en"]=Y.merge(Dl,{});Dl["en-US"]=Y.merge(Dl["en"],{c:"%a %d %b %Y %I:%M:%S %p %Z",x:"%m/%d/%Y",X:"%I:%M:%S %p"});Dl["en-GB"]=Y.merge(Dl["en"],{r:"%l:%M:%S %P %Z"});Dl["en-AU"]=Y.merge(Dl["en"]);Y.DateLocal=Dl;},"@VERSION@",{requires:["base"]});YUI.add("datasource-local",function(B){var A=B.Lang,C=function(){C.superclass.constructor.apply(this,arguments);};B.mix(C,{NAME:"DataSource.Local",ATTRS:{}});B.extend(C,B.DataSource.Base,{});B.DataSource.Local=C;},"@VERSION@",{requires:["datasource-base"]});YUI.add("datasource",function(A){},"@VERSION@",{use:["datasource-base","datasource-local"]});