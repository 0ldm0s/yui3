YUI.add("node-menunav",function(A){var k=A.UA,AD=A.Lang,b=AD.later,AA=A.ClassNameManager.getClassName,h=true,y=false,j=null,U=j,N="menu",E="menuitem",K="presentation",w="hidden",t="tabIndex",O="parentNode",W="children",p="offsetHeight",s="offsetWidth",AB="px",f="id",G=".",C="handledMouseOut",m="handledMouseOver",V="hover",z="label",d="a",o="mousedown",AC="keydown",r="click",M="",i=AA(N),v=AA(N,w),a=AA(N,"horizontal"),x=AA(N,z),S=AA(N,z,V),Z=AA(N,z,(N+"visible")),H=AA(E),L=AA(E,V),T=AA("shim"),g=G+i,B=":first-child";var I=function(Y){var AF=Y.previous(),AE;if(!AF){AE=Y.get(O).get(W);AF=AE.item(AE.get("length")-1);}return AF;};var c=function(Y){var AF=Y.next(),AE;if(!AF){AE=Y.get(O).get(W);AF=AE.item(0);}return AF;};var P=function(Y,AE){Y.setAttribute("role",AE);};var Q=function(Y,AF,AE){Y.setAttribute(("aria-"+AF),AE);};var D=function(Y){var AE=y;if(Y){AE=Y.get("nodeName").toLowerCase()===d;}return AE;};var n=function(Y){var AE;if(Y){AE=D(Y)?Y:Y.ancestor(D);}return AE;};var q=function(AE,Y){var AF;if(AE){AF=AE.hasClass(Y)?AE:AE.ancestor((G+Y));}return AF;};var J=function(Y){return Y.ancestor(g);};var X=function(Y){return q(Y,i);};var l=function(Y){return q(Y,x);};var u=function(Y){return q(Y,H);};var e=function(Y,AE){return Y&&!Y[m]&&(Y===AE||Y.contains(AE));};var F=function(AE,Y){return AE&&!AE[C]&&(AE!==Y&&!AE.contains(Y));};var R=function(AF){var Y=this,AN=AF.owner,AK,AE,AJ,AH,AL,AM,AI,AG;if(AN){AM=AF.useARIA;AI=AF.autoSubmenuDisplay;AG=AF.mouseOutHideDelay;Y._useARIA=AD.isBoolean(AM)?AM:((k.gecko&&k.gecko>=1.9)||(k.ie&&k.ie>=8));Y._useARIA=y;Y._autoSubmenuDisplay=AD.isBoolean(AI)?AI:h;Y._submenuShowDelay=AF.submenuShowDelay||250;Y._submenuHideDelay=AF.submenuHideDelay||250;Y._mouseOutHideDelay=AD.isNumber(AG)?AG:750;AN.queryAll(g).addClass(v);AN.on("mouseover",A.bind(Y._onMouseOver,Y));AN.on("mouseout",A.bind(Y._onMouseOut,Y));AN.on("mousemove",A.bind(Y._onMouseMove,Y));AN.on(o,A.bind(Y._toggleSubmenuDisplay,Y));AN.on(AC,A.bind(Y._toggleSubmenuDisplay,Y));AN.on(r,A.bind(Y._toggleSubmenuDisplay,Y));AN.on("keypress",A.bind(Y._onKeyPress,Y));AN.on(AC,A.bind(Y._onKeyDown,Y));AK=AN.get("ownerDocument");AK.on(o,A.bind(Y._onDocMouseDown,Y));A.on("focus",A.bind(Y._onDocFocus,Y),AK);Y._rootMenu=AN;if(AM){P(AN,"menubar");AE=AN.queryAll("li").each(function(AO){var AP=AO.query(B);AP.set(t,-1);P(AP,E);P(AO,K);});AN.queryAll("ul").each(function(AO){P(AO,K);});AN.queryAll((G+x)).each(function(AO){Q(AO,"haspopup",h);AL=AO.get(f);if(!AL){AL=AO.get("_yuid");AO.set(f,AL);}AJ=AO.next();P(AJ,N);Q(AJ,"labelledby",AL);Q(AJ,w,h);});if(AE){AH=AE.item(0).query(B);AH.set(t,0);Y._firstItem=AH;}}}};R.prototype={_rootMenu:j,_activeItem:j,_activeMenu:j,_hasFocus:y,_blockMouseEvent:y,_currentMouseX:0,_movingToSubmenu:y,_showSubmenuTimer:j,_hideSubmenuTimer:j,_hideAllSubmenusTimer:j,_firstItem:j,_autoSubmenuDisplay:h,_isRoot:function(Y){return this._rootMenu.compareTo(Y);},_getTopmostSubmenu:function(AG){var AF=this,Y=J(AG),AE;if(!Y){AE=AG;}else{if(AF._isRoot(Y)){AE=AG;}else{AE=AF._getTopmostSubmenu(Y);}}return AE;},_blurItem:function(AF){var AE=D(AF)?AF:AF.query(d);try{AE.blur();}catch(Y){}},_focusItem:function(AF){var AE;if(this._hasFocus){AE=D(AF)?AF:AF.query(d);try{AE.focus();}catch(Y){}}},_showMenu:function(AI){var AG=this,AE=J(AI),Y,AH,AF;if(AE){AH=AI.get(O);AF=AH.getXY();if(AE.hasClass(a)){AF[1]=AF[1]+AH.get(p);}else{AF[0]=AF[0]+AH.get(s);}AI.setXY(AF);}if(k.ie===6){if(!U){U=A.Node.create(A.Plugin.NodeMenuNav.SHIM_TEMPLATE);}Y=AI.query(G+T);if(!Y){Y=U.cloneNode();AI.appendChild(Y);}AI.setStyles({height:(AI.get(p)+AB),width:(AI.get(s)+AB)});}AI.previous().addClass(Z);AI.removeClass(v);if(AG._useARIA){Q(AI,w,y);}AG._focusItem(AI.query(d));},_hideMenu:function(Y,AF){var AE=Y.previous();AE.removeClass(Z);if(AF){this._focusItem(AE);}Y.queryAll((G+L)).removeClass(L);Y.setStyles({left:M,top:M});Y.addClass(v);Q(Y,w,h);},_hideActiveItemMenu:function(){var AF=this,Y=AF._activeItem,AE;if(Y&&Y.hasClass(Z)){AE=Y.next();if(AE){AF._hideMenu(AE,h);}}},_hideAllSubmenus:function(AF){var AE=this,Y=AF.queryAll(g);Y.each(A.bind(function(AG){AE._hideMenu(AG);},AE));},_cancelShowSubmenuTimer:function(){var AE=this,Y=AE._showSubmenuTimer;if(Y){Y.cancel();AE._showSubmenuTimer=j;}},_cancelHideSubmenuTimer:function(){var Y=this,AE=Y._hideSubmenuTimer;if(AE){AE.cancel();Y._hideSubmenuTimer=j;}},_focusNextItem:function(){var AF=this,Y=AF._activeItem,AH,AG,AE;if(Y){AH=Y.hasClass(H)?Y:Y.get(O);AG=c(AH);AE=AG.query(d);if(AE){AF._focusItem(AE);}}},_focusPreviousItem:function(){var AF=this,AE=AF._activeItem,AH,AG,Y;if(AE){AH=AE.hasClass(H)?AE:AE.get(O);AG=I(AH);Y=AG.query(d);if(Y){AF._focusItem(Y);}}},_onMenuMouseOver:function(AF,AE){var Y=this;Y._cancelHideSubmenuTimer();Y._activeMenu=AF;},_onMenuMouseOut:function(AK,AI){var AH=this,AF=AH._activeMenu,AJ=AI.relatedTarget,Y=AH._activeItem,AG,AE;if(AF&&!AF.contains(AJ)){AG=J(AF);if(AG&&!AG.contains(AJ)){if(AH._mouseOutHideDelay>0){AH._cancelShowSubmenuTimer();AH._hideAllSubmenusTimer=b(AH._mouseOutHideDelay,AH,function(){var AL;AF=AH._activeMenu;AH._hideAllSubmenus(AH._rootMenu);if(AF){AL=AH._getTopmostSubmenu(AF);AH._focusItem(AL.previous());}});}}else{if(Y){AE=J(Y);if(!AH._isRoot(AE)){AH._focusItem(AE.previous());}}}}},_onMenuLabelMouseOver:function(AH,AK){var AJ=this,AG=AJ._activeMenu,Y=AJ._isRoot(AG),AF=(AJ._autoSubmenuDisplay&&Y||!Y),AI=AJ._hideAllSubmenusTimer,AE;AJ._focusItem(AH);AH.addClass(S);if(AF&&!AJ._movingToSubmenu){if(AI){AI.cancel();AJ._hideAllSubmenusTimer=j;}AJ._cancelHideSubmenuTimer();AJ._cancelShowSubmenuTimer();if(!AH.hasClass(Z)){AE=AH.next();if(AE){AJ._hideAllSubmenus(AG);AJ._showSubmenuTimer=b(AJ._submenuShowDelay,AJ,AJ._showMenu,AE);}}}},_onMenuLabelMouseOut:function(AG,AI){var AH=this,Y=AH._isRoot(AH._activeMenu),AF=(AH._autoSubmenuDisplay&&Y||!Y),AJ=AI.relatedTarget,AE=AG.next();AG.removeClass(S);if(AF){if(AH._movingToSubmenu&&!AH._showSubmenuTimer&&AE){AH._hideSubmenuTimer=b(AH._submenuHideDelay,AH,AH._hideMenu,AE);}else{if(!AH._movingToSubmenu&&AE&&!AE.contains(AJ)&&AJ!==AE){AH._cancelShowSubmenuTimer();
AH._hideMenu(AE);}}}},_onMenuItemMouseOver:function(AG,AI){var AH=this,AF=AH._activeMenu,Y=AH._isRoot(AF),AE=(AH._autoSubmenuDisplay&&Y||!Y);AG.addClass(L);AH._focusItem(AG);if(AE&&!AH._movingToSubmenu){AH._hideAllSubmenus(AF);}},_onMenuItemMouseOut:function(Y,AE){Y.removeClass(L);},_onVerticalMenuKeyDown:function(Y){var AE=this,AI=AE._activeMenu,AM=AE._rootMenu,AF=Y.target,AH=y,AK,AG,AJ,AL;switch(Y.keyCode){case 37:AG=J(AI);if(AG&&AG.hasClass(a)){AE._hideMenu(AI);AJ=I(AI.get(O));AL=AJ.query(B);if(AL){if(AL.hasClass(x)){AK=AL.next();if(AK){AE._showMenu(AK);}}else{AE._focusItem(AL);}}}else{if(!AE._isRoot(AI)){AE._hideMenu(AI,h);}}AH=h;break;case 38:AE._hideActiveItemMenu();AE._focusPreviousItem();AH=h;break;case 39:if(AF.hasClass(x)){AK=AF.next();if(AK){AE._showMenu(AK);}}else{if(AM.hasClass(a)){AK=AE._getTopmostSubmenu(AI);AJ=c(AK.get(O));AL=AJ.query(B);AE._hideAllSubmenus(AM);if(AL){if(AL.hasClass(x)){AK=AL.next();if(AK){AE._showMenu(AK);}}else{AE._focusItem(AL);}}}}AH=h;break;case 40:AE._hideActiveItemMenu();AE._focusNextItem();AH=h;break;}if(AH){Y.preventDefault();}},_onHorizontalMenuKeyDown:function(AH){var AG=this,Y=AG._activeItem,AF=y,AE;switch(AH.keyCode){case 37:AG._hideActiveItemMenu();AG._focusPreviousItem();AF=h;break;case 39:AG._hideActiveItemMenu();AG._focusNextItem();AF=h;break;case 40:if(Y.hasClass(x)){AE=Y.next();if(AE){AG._showMenu(AE);}AF=h;}break;}if(AF){AH.preventDefault();}},_onMouseMove:function(Y){this._currentMouseX=Y.pageX;},_onMouseOver:function(AH){var AG=this,AE,Y,AJ,AF,AI;if(AG._blockMouseEvent){AG._blockMouseEvent=y;}else{AE=AH.target;Y=X(AE);AJ=l(AE);AI=u(AE);if(e(Y,AE)){AG._onMenuMouseOver(Y,AH);Y[m]=h;Y[C]=y;AF=J(Y);if(AF){AF[C]=h;AF[m]=y;}}if(e(AJ,AE)){AG._onMenuLabelMouseOver(AJ,AH);AJ[m]=h;AJ[C]=y;}if(e(AI,AE)){AG._onMenuItemMouseOver(AI,AH);AI[m]=h;AI[C]=y;}}},_onMouseOut:function(AE){var AF=this,AH=AF._activeMenu,AM=y,AG,AI,AK,Y,AJ,AL;AF._movingToSubmenu=(AH&&!AH.hasClass(a)&&((AE.pageX-5)>AF._currentMouseX));AG=AE.target;AI=AE.relatedTarget;AK=X(AG);Y=l(AG);AL=u(AG);if(F(Y,AI)){AF._onMenuLabelMouseOut(Y,AE);Y[C]=h;Y[m]=y;}if(F(AL,AI)){AF._onMenuItemMouseOut(AL,AE);AL[C]=h;AL[m]=y;}if(Y){AJ=Y.next();if(AJ&&(AI===AJ||AJ.contains(AI))){AM=h;}}if(F(AK,AI)||AM){AF._onMenuMouseOut(AK,AE);AK[C]=h;AK[m]=y;}},_toggleSubmenuDisplay:function(AF){var AG=this,AH=AF.target,AE=l(AH),Y=AF.type,AL,AK,AJ,AM,AN,AI;if(AE){AL=n(AH);if(AL){AJ=AL.getAttribute("href",2);AM=AJ.indexOf("#");AN=AJ.length;if(AM===0&&AN>1){AI=AJ.substr(1,AN);AK=AE.next();if(AK&&(AK.get(f)===AI)){if(Y===o||(Y===AC&&AF.keyCode===13)){if(k.webkit&&!AG._hasFocus){AG._hasFocus=h;}if(AE.hasClass(Z)){AG._hideMenu(AK);AG._focusItem(AE);}else{AG._hideAllSubmenus(AG._rootMenu);AG._showMenu(AK);}}if(Y===r){AF.preventDefault();}}}}}},_onKeyPress:function(Y){switch(Y.keyCode){case 37:case 38:case 39:case 40:Y.preventDefault();break;}},_onKeyDown:function(AG){var AF=this,Y=AF._activeItem,AE=J(AG.target);if(AE){AF._activeMenu=AE;if(AE.hasClass(a)){AF._onHorizontalMenuKeyDown(AG);}else{AF._onVerticalMenuKeyDown(AG);}if(AG.keyCode===27){if(!AF._isRoot(AE)){AF._hideMenu(AE,h);AG.stopPropagation();AF._blockMouseEvent=k.gecko?h:y;}else{if(Y){AF._blurItem(Y);}}}}},_onDocMouseDown:function(AG){var AF=this,AE=AF._rootMenu,Y=AG.target;if(!AE.compareTo(Y)&&!AE.contains(Y)){AF._hideAllSubmenus(AE);if(k.webkit){AF._hasFocus=y;}}},_onDocFocus:function(AI){var AH=this,AE=AH._useARIA,Y=AH._activeItem,AG=AI.target,AF;AH._hasFocus=AH._rootMenu.contains(AG);if(AE&&Y){AF=D(Y)?Y:Y.query(d);AF.set(t,-1);}if(AH._hasFocus){if(AE){AG.set(t,0);}AH._activeItem=u(AG)||l(AG);}else{if(AE){AH._firstItem.set(t,0);}AH._activeItem=j;}}};A.namespace("Plugin");A.Plugin.NodeMenuNav=R;A.Plugin.NodeMenuNav.NAME="nodemenunav";A.Plugin.NodeMenuNav.NS="nodemenunav";A.Plugin.NodeMenuNav.SHIM_TEMPLATE='<iframe role="presentation" class="'+T+'" title="Menu Stacking Shim" src="javascript:FALSE;"></iframe>';},"@VERSION@",{requires:["node","classnamemanager"]});