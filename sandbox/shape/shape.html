<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Node</title>
<script type="text/javascript" src="../../build/yui/yui.js"></script>
<script type="text/javascript" src="canvas.js"></script>
<script type="text/javascript" src="canvas-vml.js"></script>
<style>
v\:shape {
    behavior:url(#default#VML);
    display:inline-block;
    zoom:1;
}

canvas {
}

#demo, #demo2 {
    display: inline;
    zoom:1;
}

#demo2 {
}
</style>
</head>

<body>
<div id="demo">
</div>

<div id="demo2">
</div>
<script type="text/javascript">


YUI({filter:'raw'}).use('dd-drag', 'canvas-vml', function(Y) {
    var shape = new Y.Canvas({
        height: '200',
        width: '200',
        //path: 'm 1,1 l 1,200, 200,200, 200,1 x e',
        fillColor: 'blue',
        strokeWeight: 2,
        strokeColor: 'red'
    });

    shape.draw('#demo');

    shape.beginPath()
        .moveTo(2, 2)
        .lineTo([2, 198], [198, 2])
        .closePath()
        .fill()
        .stroke();

    var shape2 = new Y.Canvas({
        height: '200',
        width: '200',
        //path: 'm 1,1 l 1,200, 200,200, 200,1 x e',
        fillColor: 'blue',
        strokeWeight: 2,
        strokeColor: 'red'
    });

    shape2.draw('#demo2');

    shape2.beginPath()
        .moveTo(198, 2)
        .lineTo(198, 198)
        .lineTo(2, 198)
        .closePath()
        .fill()
        .stroke();

console.log(shape2._canvas);
    var handlers = {
        // TODO: find more efficient event that gives deltaXY (drag:start not preventable)
        drag: function(e) {
            var target = e.currentTarget,
                node = this.get('node')._node,
                context = node.getContext ? node.getContext('2d') : null,
                x = target.deltaXY[0],
                y = target.deltaXY[1];

            if (context && !context.isPointInPath(x, y)) {
                e.preventDefault();
            }
        }
    },

    dd = new Y.DD.Drag({
        node: shape._canvas,
        on: handlers
    }),

    dd2 = new Y.DD.Drag({
        node: shape2._canvas,
        on: handlers
    });
});


</script>


</body>
</html>

