YUI.add("gesture-simulate",function(a){(function(){var g={tap:1,doubletap:1,press:1,move:1,flick:1,pinch:1,rotate:1},e={touchstart:1,touchmove:1,touchend:1,touchcancel:1},k=a.config.doc,j,c={EVENT_INTERVAL:20,START_PAGEX:0,START_PAGEY:0,HOLD_TAP:10,DELAY_TAP:10,HOLD_PRESS:3000,MIN_HOLD_PRESS:1000,MAX_HOLD_PRESS:60000,DISTANCE_MOVE:200,DURATION_MOVE:1000,MAX_DURATION_MOVE:5000,MIN_VELOCITY_FLICK:1.3,DISTANCE_FLICK:200,DURATION_FLICK:1000,MAX_DURATION_FLICK:5000,DURATION_PINCH:1000},h="touchstart",n="touchmove",o="touchend",r="gesturestart",f="gesturechange",b="gestureend",s="mouseup",t="mousemove",p="mousedown",l="click",d="dblclick",m="x",q="y";function i(u){if(!u){a.error(NAME+": invalid target node");}this.node=u;this.target=a.Node.getDOMNode(u);c.START_PAGEX=this.node.getX()+this.target.getBoundingClientRect().width/2;c.START_PAGEY=this.node.getY()+this.target.getBoundingClientRect().height/2;}i.prototype={_toRadian:function(u){return u*(Math.PI/180);},_calculateDefaultPoint:function(u){if(!a.Lang.isArray(u)||u.length===0){u=[c.START_PAGEX,c.START_PAGEY];}else{if(u.length==1){u[1]=this.target.getBoundingClientRect().height/2;}u[0]=this.node.getX()+u[0];u[1]=this.node.getY()+u[1];}return u;},rotate:function(y,u,B,C,z,v,D){var A,x=B,w=C;if(!a.Lang.isNumber(x)||!a.Lang.isNumber(w)||x<0||w<0){A=(this.target.offsetWidth<this.target.offsetHeight)?this.target.offsetWidth/2:this.target.offsetHeight/2;x=A;w=A;}if(!a.Lang.isNumber(D)){a.error(NAME+"Invalid rotation detected.");}this.pinch(y,u,x,w,z,v,D);},pinch:function(G,T,J,z,v,A,I){var F,Q=c.EVENT_INTERVAL,E,H=0,M=J,K=z,S,D,B,R,P,U,y,O,u,C,x={start:[],end:[]},w={start:[],end:[]},N;T=this._calculateDefaultPoint(T);if(!a.Lang.isNumber(M)||!a.Lang.isNumber(K)||M<0||K<0){a.error(NAME+"Invalid startRadius and endRadius detected.");}if(!a.Lang.isNumber(v)||v<=0){v=c.DURATION_PINCH;}if(!a.Lang.isNumber(A)){A=0;}else{A=A%360;if(A<0){A+=360;}}if(!a.Lang.isNumber(I)){I=0;}a.AsyncQueue.defaults.timeout=Q;F=new a.AsyncQueue();D=T[0];B=T[1];y=A;O=A+I;x.start=[D+M*Math.sin(this._toRadian(y)),B-M*Math.cos(this._toRadian(y))];x.end=[D+K*Math.sin(this._toRadian(O-y)),B-K*Math.cos(this._toRadian(O-y))];w.start=[D-M*Math.sin(this._toRadian(y)),B+M*Math.cos(this._toRadian(y))];w.end=[D-K*Math.sin(this._toRadian(O-y)),B+K*Math.cos(this._toRadian(O-y))];R=1;P=z/J;F.add({fn:function(){var W,V,Y,X;W={pageX:x.start[0],pageY:x.start[1],clientX:x.start[0],clientY:x.start[1]};V={pageX:w.start[0],pageY:w.start[1],clientX:w.start[0],clientY:w.start[1]};X=this._createTouchList([a.merge({identifier:H++},W),a.merge({identifier:H++},V)]);Y={pageX:(x.start[0]+w.start[0])/2,pageY:(x.start[0]+w.start[1])/2,clientX:(x.start[0]+w.start[0])/2,clientY:(x.start[0]+w.start[1])/2};this._simulateEvent(this.target,h,a.merge({touches:X,targetTouches:X,changedTouches:X,scale:R,rotation:y},Y));if(a.UA.ios>=2){this._simulateEvent(this.target,r,a.merge({scale:R,rotation:y},Y));}},timeout:0,context:this});N=Math.floor(v/Q);S=(K-M)/N;U=(P-R)/N;u=(O-y)/N;C=this._toRadian(O-y)/N;for(var L=0;L<N;L++){F.add({fn:function(Y){var ac=M+(S)*Y,aa=D+ac*Math.sin(y+C*Y),W=B-ac*Math.cos(y+C*Y),X=D-ac*Math.sin(y+C*Y),V=B+ac*Math.cos(y+C*Y),ag=(aa+X)/2,af=(W+V)/2,ae,ad,ab,Z;ae={pageX:aa,pageY:W,clientX:aa,clientY:W};ad={pageX:X,pageY:V,clientX:X,clientY:V};Z=this._createTouchList([a.merge({identifier:H++},ae),a.merge({identifier:H++},ad)]);ab={pageX:ag,pageY:af,clientX:ag,clientY:af};this._simulateEvent(this.target,n,a.merge({touches:Z,targetTouches:Z,changedTouches:Z,scale:R+U*Y,rotation:y+u*Y},ab));if(a.UA.ios>=2){this._simulateEvent(this.target,f,a.merge({scale:R+U*Y,rotation:y+u*Y},ab));}},args:[L],context:this});}F.add({fn:function(){var Y=this._getEmptyTouchList(),W,V,Z,X;W={pageX:x.end[0],pageY:x.end[1],clientX:x.end[0],clientY:x.end[1]};V={pageX:w.end[0],pageY:w.end[1],clientX:w.end[0],clientY:w.end[1]};X=this._createTouchList([a.merge({identifier:H++},W),a.merge({identifier:H++},V)]);Z={pageX:(x.end[0]+w.end[0])/2,pageY:(x.end[0]+w.end[1])/2,clientX:(x.end[0]+w.end[0])/2,clientY:(x.end[0]+w.end[1])/2};if(a.UA.ios>=2){this._simulateEvent(this.target,b,a.merge({scale:P,rotation:O},Z));}this._simulateEvent(this.target,o,a.merge({touches:Y,targetTouches:Y,changedTouches:X,scale:P,rotation:O},Z));},context:this});if(G&&a.Lang.isFunction(G)){F.add({fn:G,context:this.node});}F.run();},tap:function(w,B,u,v,y){var D=new a.AsyncQueue(),C=this._getEmptyTouchList(),z,A,x;B=this._calculateDefaultPoint(B);if(!a.Lang.isNumber(u)||u<1){u=1;}if(!a.Lang.isNumber(v)){v=c.HOLD_TAP;}if(!a.Lang.isNumber(y)){y=c.DELAY_TAP;}A={pageX:B[0],pageY:B[1],clientX:B[0],clientY:B[1]};z=this._createTouchList([a.merge({identifier:0},A)]);for(x=0;x<u;x++){D.add({fn:function(){this._simulateEvent(this.target,h,a.merge({touches:z,targetTouches:z,changedTouches:z},A));},context:this,timeout:(x===0)?0:y});D.add({fn:function(){this._simulateEvent(this.target,o,a.merge({touches:C,targetTouches:C,changedTouches:z},A));},context:this,timeout:v});}if(u>1&&!((a.config.win&&("ontouchstart" in a.config.win))&&!(a.UA.chrome&&a.UA.chrome<6))){D.add({fn:function(){this._simulateEvent(this.target,d,A);},context:this});}if(w&&a.Lang.isFunction(w)){D.add({fn:w,context:this.node});}D.run();},flick:function(v,u,w,z,y){var x;u=this._calculateDefaultPoint(u);if(!a.Lang.isString(w)){w=m;}else{w=w.toLowerCase();if(w!==m&&w!==q){a.error(NAME+"(flick): Only x or y axis allowed");}}if(!a.Lang.isNumber(z)){z=c.DISTANCE_FLICK;}if(!a.Lang.isNumber(y)){y=c.DURATION_FLICK;}else{if(y>c.MAX_DURATION_FLICK){y=c.MAX_DURATION_FLICK;}}if(Math.abs(z)/y<c.MIN_VELOCITY_FLICK){y=Math.abs(z)/c.MIN_VELOCITY_FLICK;}x={start:a.clone(u),end:[(w===m)?u[0]+z:u[0],(w===q)?u[1]+z:u[1]]};this._move(v,x,y);},move:function(u,w,v){var x;if(!a.Lang.isObject(w)){w={point:this._calculateDefaultPoint([]),xdist:c.DISTANCE_MOVE,ydist:0};}else{if(!a.Lang.isArray(w.point)){w.point=this._calculateDefaultPoint([]);}else{w.point=this._calculateDefaultPoint(w.point);}if(!a.Lang.isNumber(w.xdist)){w.xdist=c.DISTANCE_MOVE;
}if(!a.Lang.isNumber(w.ydist)){w.ydist=0;}}if(!a.Lang.isNumber(v)){v=c.DURATION_MOVE;}else{if(v>c.MAX_DURATION_MOVE){v=c.MAX_DURATION_MOVE;}}x={start:a.clone(w.point),end:[w.point[0]+w.xdist,w.point[1]+w.ydist]};this._move(u,x,v);},_move:function(w,C,x){var D,v=c.EVENT_INTERVAL,z,B,A,u=0;if(!a.Lang.isNumber(x)){x=c.DURATION_MOVE;}else{if(x>c.MAX_DURATION_MOVE){x=c.MAX_DURATION_MOVE;}}if(!a.Lang.isObject(C)){C={start:[c.START_PAGEX,c.START_PAGEY],end:[c.START_PAGEX+c.DISTANCE_MOVE,c.START_PAGEY]};}else{if(!a.Lang.isArray(C.start)){C.start=[c.START_PAGEX,c.START_PAGEY];}if(!a.Lang.isArray(C.end)){C.end=[c.START_PAGEX+c.DISTANCE_MOVE,c.START_PAGEY];}}a.AsyncQueue.defaults.timeout=v;D=new a.AsyncQueue();D.add({fn:function(){var F={pageX:C.start[0],pageY:C.start[1],clientX:C.start[0],clientY:C.start[1]},E=this._createTouchList([a.merge({identifier:u++},F)]);this._simulateEvent(this.target,h,a.merge({touches:E,targetTouches:E,changedTouches:E},F));},timeout:0,context:this});z=Math.floor(x/v);B=(C.end[0]-C.start[0])/z;A=(C.end[1]-C.start[1])/z;for(var y=0;y<z;y++){D.add({fn:function(G){var F=C.start[0]+(B*G),E=C.start[1]+(A*G),I={pageX:F,pageY:E,clientX:F,clientY:E},H=this._createTouchList([a.merge({identifier:u++},I)]);this._simulateEvent(this.target,n,a.merge({touches:H,targetTouches:H,changedTouches:H},I));},args:[y],context:this});}D.add({fn:function(){var F={pageX:C.end[0],pageY:C.end[1],clientX:C.end[0],clientY:C.end[1]},E=this._createTouchList([a.merge({identifier:u},F)]);this._simulateEvent(this.target,n,a.merge({touches:E,targetTouches:E,changedTouches:E},F));},timeout:0,context:this});D.add({fn:function(){var G={pageX:C.end[0],pageY:C.end[1],clientX:C.end[0],clientY:C.end[1]},F=this._getEmptyTouchList(),E=this._createTouchList([a.merge({identifier:u},G)]);this._simulateEvent(this.target,o,a.merge({touches:F,targetTouches:F,changedTouches:E},G));},context:this});if(w&&a.Lang.isFunction(w)){D.add({fn:w,context:this.node});}D.run();},_getEmptyTouchList:function(){if(!j){j=this._createTouchList([]);}return j;},_createTouchList:function(w){var x=[],v,u=this;if(!!w&&a.Lang.isArray(w)){if(a.UA.android&&a.UA.android>=4||a.UA.ios&&a.UA.ios>=2){a.each(w,function(y){if(!y.identifier){y.identifier=0;}if(!y.pageX){y.pageX=0;}if(!y.pageY){y.pageY=0;}if(!y.screenX){y.screenX=0;}if(!y.screenY){y.screenY=0;}x.push(k.createTouch(a.config.win,u.target,y.identifier,y.pageX,y.pageY,y.screenX,y.screenY));});v=k.createTouchList.apply(k,x);}else{if(a.UA.ios&&a.UA.ios<2){a.error(NAME+": No touch event simulation framework present.");}else{v=[];a.each(w,function(y){if(!y.identifier){y.identifier=0;}if(!y.clientX){y.clientX=0;}if(!y.clientY){y.clientY=0;}if(!y.pageX){y.pageX=0;}if(!y.pageY){y.pageY=0;}if(!y.screenX){y.screenX=0;}if(!y.screenY){y.screenY=0;}v.push({target:u.target,identifier:y.identifier,clientX:y.clientX,clientY:y.clientY,pageX:y.pageX,pageY:y.pageY,screenX:y.screenX,screenY:y.screenY});});v.item=function(y){return v[y];};}}}else{a.error(NAME+": Invalid touchPoints passed");}return v;},_simulateEvent:function(w,v,u){if(e[v]){if((a.config.win&&("ontouchstart" in a.config.win))&&!(a.UA.chrome&&a.UA.chrome<6)){a.Event.simulate(w,v,u);}else{if(u.touches&&u.touches.length===1){v={touchstart:p,touchmove:t,touchend:s}[v];u.button=0;u.relatedTarget=null;u=a.mix(u,{screenX:u.touches.item(0).screenX,screenY:u.touches.item(0).screenY,clientX:u.touches.item(0).clientX,clientY:u.touches.item(0).clientY},true);a.Event.simulate(w,v,u);if(v==s){a.Event.simulate(w,l,u);}}else{a.error("_simulateEvent(): Event '"+v+"' has multi touch objects that can't be simulated in your platform.");}}}else{a.Event.simulate(w,v,u);}}};a.GestureSimulation=i;a.GestureSimulation.defaults=c;a.GestureSimulation.GESTURES=g;a.Event.simulateGesture=function(y,x,w,u){if(y instanceof HTMLElement){y=a.Node.one(y);}var v=new a.GestureSimulation(y);x=x.toLowerCase();if(!u){u=w;w={};}w=w||{};if(g[x]){switch(x){case"tap":v.tap(u,w.point,w.times,w.hold,w.delay);break;case"doubletap":v.tap(u,w.point,2);break;case"press":if(!a.Lang.isNumber(w.hold)){w.hold=c.HOLD_PRESS;}else{if(w.hold<c.MIN_HOLD_PRESS){w.hold=c.MIN_HOLD_PRESS;}else{if(w.hold>c.MAX_HOLD_PRESS){w.hold=c.MAX_HOLD_PRESS;}}}v.tap(u,w.point,1,w.hold);break;case"move":v.move(u,w.path,w.duration);break;case"flick":v.flick(u,w.point,w.axis,w.distance,w.duration);break;case"pinch":v.pinch(u,w.center,w.r1,w.r2,w.duration,w.start,w.rotation);break;case"rotate":v.rotate(u,w.center,w.r1,w.r2,w.duration,w.start,w.rotation);break;}}else{a.error(NAME+": Not a supported gesture simulation: "+x);}};})();},"@VERSION@",{requires:["event-simulate","async-queue","node-screen"]});