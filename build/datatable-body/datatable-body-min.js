YUI.add("datatable-body",function(a,k){var d=a.Lang,e=d.isArray,j=d.isNumber,b=d.isString,i=d.sub,h=a.Escape.html,c=a.Array,f=a.bind,g=a.Object;a.namespace("DataTable").BodyView=a.Base.create("tableBody",a.View,[],{CELL_TEMPLATE:'<td {headers} class="{className}">{content}</td>',ROW_TEMPLATE:'<tr id="{rowId}" data-yui3-record="{clientId}" class="{rowClass}">{content}</tr>',TBODY_TEMPLATE:'<tbody class="{className}"></tbody>',getCell:function(n,m){var p=this.tbodyNode,r,l,o,q;if(n&&p){if(e(n)){r=p.get("children").item(n[0]);l=r&&r.get("children").item(n[1]);}else{if(a.instanceOf(n,a.Node)){l=n.ancestor("."+this.getClassName("cell"),true);}}if(l&&m){q=p.get("firstChild.rowIndex");if(b(m)){switch(m){case"above":m=[-1,0];break;case"below":m=[1,0];break;case"next":m=[0,1];break;case"previous":m=[0,-1];break;}}if(e(m)){o=l.get("parentNode.rowIndex")+m[0]-q;r=p.get("children").item(o);o=l.get("cellIndex")+m[1];l=r&&r.get("children").item(o);}}}return l||null;},getClassName:function(){var m=this.host,l;if(m&&m.getClassName){return m.getClassName.apply(m,arguments);}else{l=c(arguments);l.unshift(this.constructor.NAME);return a.ClassNameManager.getClassName.apply(a.ClassNameManager,l);}},getRecord:function(m){var o=this.get("modelList"),n=this.tbodyNode,p=null,l;if(n){if(b(m)){m=n.one("#"+m);}if(a.instanceOf(m,a.Node)){p=m.ancestor(function(q){return q.get("parentNode").compareTo(n);},true);l=p&&o.getByClientId(p.getData("yui3-record"));}}return l||null;},getRow:function(n){var l=this.tbodyNode,m=null;if(l){if(n){n=this._idMap[n.get?n.get("clientId"):n]||n;}m=j(n)?l.get("children").item(n):l.one("#"+n);}return m;},render:function(){var n=this.get("container"),o=this.get("modelList"),m=this.get("columns"),l=this.tbodyNode||(this.tbodyNode=this._createTBodyNode());this._createRowTemplate(m);if(o){l.setHTML(this._createDataHTML(m));this._applyNodeFormatters(l,m);}if(l.get("parentNode")!==n){n.appendChild(l);}this.bindUI();return this;},_afterColumnsChange:function(l){this.render();},_afterDataChange:function(l){this.render();},_afterModelListChange:function(m){var l=this._eventHandles;if(l.dataChange){l.dataChange.detach();delete l.dataChange;this.bindUI();}if(this.tbodyNode){this.render();}},_applyNodeFormatters:function(q,l){var s=this.host,o=this.get("modelList"),n=[],m="."+this.getClassName("liner"),t,p,r;for(p=0,r=l.length;p<r;++p){if(l[p].nodeFormatter){n.push(p);}}if(o&&n.length){t=q.get("childNodes");o.each(function(y,z){var w={data:y.toJSON(),record:y,rowIndex:z},E=t.item(z),x,A,v,C,D,B,u;if(E){D=E.get("childNodes");for(x=0,A=n.length;x<A;++x){B=D.item(n[x]);if(B){v=w.column=l[n[x]];C=v.key||v.id;w.value=y.get(C);w.td=B;w.cell=B.one(m)||B;u=v.nodeFormatter.call(s,w);if(u===false){B.destroy(true);}}}}});}},bindUI:function(){var l=this._eventHandles,n=this.get("modelList"),m=n.model.NAME+":change";if(!l.columnsChange){l.columnsChange=this.after("columnsChange",f("_afterColumnsChange",this));}if(n&&!l.dataChange){l.dataChange=n.after(["add","remove","reset",m],f("_afterDataChange",this));}},_createDataHTML:function(m){var n=this.get("modelList"),l="";if(n){n.each(function(p,o){l+=this._createRowHTML(p,o,m);},this);}return l;},_createRowHTML:function(s,u,o){var q=s.toJSON(),l=s.get("clientId"),w={rowId:this._getRowId(l),clientId:l,rowClass:(u%2)?this.CLASS_ODD:this.CLASS_EVEN},x=this.host||this,r,t,m,n,v,p;for(r=0,t=o.length;r<t;++r){m=o[r];v=q[m.key];n=m._id||m.key;w[n+"-className"]="";if(m.formatter){p={value:v,data:q,column:m,record:s,className:"",rowClass:"",rowIndex:u};if(typeof m.formatter==="string"){if(v!==undefined){v=i(m.formatter,p);}}else{v=m.formatter.call(x,p);if(v===undefined){v=p.value;}w[n+"-className"]=p.className;w.rowClass+=" "+p.rowClass;}}if(v===undefined||v===null||v===""){v=m.emptyCellValue||"";}w[n]=m.allowHTML?v:h(v);w.rowClass=w.rowClass.replace(/\s+/g," ");}return i(this._rowTemplate,w);},_createRowTemplate:function(o){var r="",u=this.CELL_TEMPLATE,q,s,n,t,p,m,l;for(q=0,s=o.length;q<s;++q){n=o[q];t=n.key;p=n._id||t;m=(n._headers||[]).length>1?'headers="'+n._headers.join(" ")+'"':"";l={content:"{"+p+"}",headers:m,className:this.getClassName("col",p)+" "+(n.className||"")+" "+this.getClassName("cell")+" {"+p+"-className}"};if(n.nodeFormatter){l.content="";}r+=i(n.cellTemplate||u,l);}this._rowTemplate=i(this.ROW_TEMPLATE,{content:r});},_createTBodyNode:function(){return a.Node.create(i(this.TBODY_TEMPLATE,{className:this.getClassName("data")}));},destructor:function(){(new a.EventHandle(g.values(this._eventHandles))).detach();},_getRowId:function(l){return this._idMap[l]||(this._idMap[l]=a.guid());},initializer:function(l){this.host=l.host;this._eventHandles={modelListChange:this.after("modelListChange",f("_afterModelListChange",this))};this._idMap={};this.CLASS_ODD=this.getClassName("odd");this.CLASS_EVEN=this.getClassName("even");}});},"@VERSION@",{"requires":["datatable-core","view","classnamemanager"]});