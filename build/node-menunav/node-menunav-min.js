YUI.add("node-menunav",function(A){var k=A.UA,AF=A.Lang,b=AF.later,AC=A.ClassNameManager.getClassName,h=true,AA=false,j=null,U=j,N="menu",E="menuitem",x="hidden",t="tabIndex",O="parentNode",W="children",p="offsetHeight",s="offsetWidth",AD="px",f="id",G=".",C="handledMouseOut",m="handledMouseOver",V="hover",AB="label",d="a",o="mousedown",AE="keydown",r="click",M="",i=AC(N),w=AC(N,x),a=AC(N,"horizontal"),y=AC(N,AB),S=AC(N,AB,V),Z=AC(N,AB,(N+"visible")),H=AC(E),L=AC(E,V),T=AC("shim"),g=G+i,B=":first-child";var I=function(Y){var AH=Y.previous(),AG;if(!AH){AG=Y.get(O).get(W);AH=AG.item(AG.get("length")-1);}return AH;};var c=function(Y){var AH=Y.next(),AG;if(!AH){AG=Y.get(O).get(W);AH=AG.item(0);}return AH;};var P=function(Y,AG){Y.setAttribute("role",AG);};var Q=function(Y,AH,AG){Y.setAttribute(("aria-"+AH),AG);};var z=function(Y){P(Y,"presentation");};var u=function(Y){Y.set(t,-1);};var K=function(Y){Y.set(t,0);};var D=function(Y){var AG=AA;if(Y){AG=Y.get("nodeName").toLowerCase()===d;}return AG;};var n=function(Y){var AG;if(Y){AG=D(Y)?Y:Y.ancestor(D);}return AG;};var q=function(AG,Y){var AH;if(AG){AH=AG.hasClass(Y)?AG:AG.ancestor((G+Y));}return AH;};var J=function(Y){return Y.ancestor(g);};var X=function(Y){return q(Y,i);};var l=function(Y){return q(Y,y);};var v=function(Y){return q(Y,H);};var e=function(Y,AG){return Y&&!Y[m]&&(Y===AG||Y.contains(AG));};var F=function(AG,Y){return AG&&!AG[C]&&(AG!==Y&&!AG.contains(Y));};var R=function(AJ){var AG=this,AR=AJ.owner,AO,AH,AM,AI,AP,AQ,AL,AK,Y,AN;if(AR){AQ=AJ.useARIA;AL=AJ.autoSubmenuDisplay;AK=AJ.mouseOutHideDelay;AG._useARIA=AF.isBoolean(AQ)?AQ:((k.gecko&&k.gecko>=1.9)||(k.ie&&k.ie>=8));AG._autoSubmenuDisplay=AF.isBoolean(AL)?AL:h;AG._submenuShowDelay=AJ.submenuShowDelay||250;AG._submenuHideDelay=AJ.submenuHideDelay||250;AG._mouseOutHideDelay=AF.isNumber(AK)?AK:750;AR.queryAll(g).addClass(w);AR.on("mouseover",A.bind(AG._onMouseOver,AG));AR.on("mouseout",A.bind(AG._onMouseOut,AG));AR.on("mousemove",A.bind(AG._onMouseMove,AG));AR.on(o,A.bind(AG._toggleSubmenuDisplay,AG));AR.on(AE,A.bind(AG._toggleSubmenuDisplay,AG));AR.on(r,A.bind(AG._toggleSubmenuDisplay,AG));AR.on("keypress",A.bind(AG._onKeyPress,AG));AR.on(AE,A.bind(AG._onKeyDown,AG));AO=AR.get("ownerDocument");AO.on(o,A.bind(AG._onDocMouseDown,AG));A.on("focus",A.bind(AG._onDocFocus,AG),AO);AG._rootMenu=AR;if(AG._useARIA){P(AR,"menubar");AH=AR.queryAll("li").each(function(AS){z(AS);});AR.queryAll("ul").each(function(AS){z(AS);});AR.queryAll((G+AC(E,"content"))).each(function(AS){u(AS);P(AS,E);});AR.queryAll((G+y)).each(function(AS){Y=AS;AN=AS.query((G+AC(N,"toggle")));if(AN){z(AN);u(AN);Y=AN.previous();}P(Y,E);Q(Y,"haspopup",h);u(Y);AP=Y.get(f);if(!AP){AP=Y.get("_yuid");Y.set(f,AP);}AM=AS.next();P(AM,N);Q(AM,"labelledby",AP);Q(AM,x,h);});if(AH){AI=AH.item(0).query(d);K(AI);AG._firstItem=v(AI)||l(AI);}}}};R.prototype={_rootMenu:j,_activeItem:j,_activeMenu:j,_hasFocus:AA,_blockMouseEvent:AA,_currentMouseX:0,_movingToSubmenu:AA,_showSubmenuTimer:j,_hideSubmenuTimer:j,_hideAllSubmenusTimer:j,_firstItem:j,_autoSubmenuDisplay:h,_isRoot:function(Y){return this._rootMenu.compareTo(Y);},_getTopmostSubmenu:function(AI){var AH=this,Y=J(AI),AG;if(!Y){AG=AI;}else{if(AH._isRoot(Y)){AG=AI;}else{AG=AH._getTopmostSubmenu(Y);}}return AG;},_blurItem:function(AH){var AG=D(AH)?AH:AH.query(d);try{AG.blur();}catch(Y){}},_focusItem:function(AH){var AG;if(this._hasFocus){AG=D(AH)?AH:AH.query(d);try{AG.focus();}catch(Y){}}},_showMenu:function(AK){var AI=this,AG=J(AK),Y,AJ,AH;if(AG){AJ=AK.get(O);AH=AJ.getXY();if(AG.hasClass(a)){AH[1]=AH[1]+AJ.get(p);}else{AH[0]=AH[0]+AJ.get(s);}AK.setXY(AH);}if(k.ie===6){if(!U){U=A.Node.create(A.Plugin.NodeMenuNav.SHIM_TEMPLATE);}Y=AK.query(G+T);if(!Y){Y=U.cloneNode();AK.appendChild(Y);}AK.setStyles({height:(AK.get(p)+AD),width:(AK.get(s)+AD)});}AK.previous().addClass(Z);AK.removeClass(w);if(AI._useARIA){Q(AK,x,AA);}AI._focusItem(AK.query(d));},_hideMenu:function(Y,AH){var AG=Y.previous();AG.removeClass(Z);if(AH){this._focusItem(AG);}Y.queryAll((G+L)).removeClass(L);Y.setStyles({left:M,top:M});Y.addClass(w);Q(Y,x,h);},_hideActiveItemMenu:function(){var AH=this,Y=AH._activeItem,AG;if(Y&&Y.hasClass(Z)){AG=Y.next();if(AG){AH._hideMenu(AG,h);}}},_hideAllSubmenus:function(AH){var AG=this,Y=AH.queryAll(g);Y.each(A.bind(function(AI){AG._hideMenu(AI);},AG));},_cancelShowSubmenuTimer:function(){var AG=this,Y=AG._showSubmenuTimer;if(Y){Y.cancel();AG._showSubmenuTimer=j;}},_cancelHideSubmenuTimer:function(){var Y=this,AG=Y._hideSubmenuTimer;if(AG){AG.cancel();Y._hideSubmenuTimer=j;}},_focusNextItem:function(){var AH=this,Y=AH._activeItem,AJ,AI,AG;if(Y){AJ=Y.hasClass(H)?Y:Y.get(O);AI=c(AJ);AG=AI.query(d);if(AG){AH._focusItem(AG);}}},_focusPreviousItem:function(){var AH=this,AG=AH._activeItem,AJ,AI,Y;if(AG){AJ=AG.hasClass(H)?AG:AG.get(O);AI=I(AJ);Y=AI.query(d);if(Y){AH._focusItem(Y);}}},_onMenuMouseOver:function(AH,AG){var Y=this;Y._cancelHideSubmenuTimer();Y._activeMenu=AH;},_onMenuMouseOut:function(AM,AK){var AJ=this,AH=AJ._activeMenu,AL=AK.relatedTarget,Y=AJ._activeItem,AI,AG;if(AH&&!AH.contains(AL)){AI=J(AH);if(AI&&!AI.contains(AL)){if(AJ._mouseOutHideDelay>0){AJ._cancelShowSubmenuTimer();AJ._hideAllSubmenusTimer=b(AJ._mouseOutHideDelay,AJ,function(){var AN;AH=AJ._activeMenu;AJ._hideAllSubmenus(AJ._rootMenu);if(AH){AN=AJ._getTopmostSubmenu(AH);AJ._focusItem(AN.previous());}});}}else{if(Y){AG=J(Y);if(!AJ._isRoot(AG)){AJ._focusItem(AG.previous());}}}}},_onMenuLabelMouseOver:function(AJ,AM){var AL=this,AI=AL._activeMenu,Y=AL._isRoot(AI),AH=(AL._autoSubmenuDisplay&&Y||!Y),AK=AL._hideAllSubmenusTimer,AG;AL._focusItem(AJ);AJ.addClass(S);if(AH&&!AL._movingToSubmenu){if(AK){AK.cancel();AL._hideAllSubmenusTimer=j;}AL._cancelHideSubmenuTimer();AL._cancelShowSubmenuTimer();if(!AJ.hasClass(Z)){AG=AJ.next();if(AG){AL._hideAllSubmenus(AI);AL._showSubmenuTimer=b(AL._submenuShowDelay,AL,AL._showMenu,AG);}}}},_onMenuLabelMouseOut:function(AI,AK){var AJ=this,Y=AJ._isRoot(AJ._activeMenu),AH=(AJ._autoSubmenuDisplay&&Y||!Y),AL=AK.relatedTarget,AG=AI.next();
AI.removeClass(S);if(AH){if(AJ._movingToSubmenu&&!AJ._showSubmenuTimer&&AG){AJ._hideSubmenuTimer=b(AJ._submenuHideDelay,AJ,AJ._hideMenu,AG);}else{if(!AJ._movingToSubmenu&&AG&&!AG.contains(AL)&&AL!==AG){AJ._cancelShowSubmenuTimer();AJ._hideMenu(AG);}}}},_onMenuItemMouseOver:function(AI,AK){var AJ=this,AH=AJ._activeMenu,Y=AJ._isRoot(AH),AG=(AJ._autoSubmenuDisplay&&Y||!Y);AI.addClass(L);AJ._focusItem(AI);if(AG&&!AJ._movingToSubmenu){AJ._hideAllSubmenus(AH);}},_onMenuItemMouseOut:function(Y,AG){Y.removeClass(L);},_onVerticalMenuKeyDown:function(Y){var AG=this,AK=AG._activeMenu,AO=AG._rootMenu,AH=Y.target,AJ=AA,AM,AI,AL,AN;switch(Y.keyCode){case 37:AI=J(AK);if(AI&&AI.hasClass(a)){AG._hideMenu(AK);AL=I(AK.get(O));AN=AL.query(B);if(AN){if(AN.hasClass(y)){AM=AN.next();if(AM){AG._showMenu(AM);}}else{AG._focusItem(AN);}}}else{if(!AG._isRoot(AK)){AG._hideMenu(AK,h);}}AJ=h;break;case 38:AG._hideActiveItemMenu();AG._focusPreviousItem();AJ=h;break;case 39:if(AH.hasClass(y)){AM=AH.next();if(AM){AG._showMenu(AM);}}else{if(AO.hasClass(a)){AM=AG._getTopmostSubmenu(AK);AL=c(AM.get(O));AN=AL.query(B);AG._hideAllSubmenus(AO);if(AN){if(AN.hasClass(y)){AM=AN.next();if(AM){AG._showMenu(AM);}}else{AG._focusItem(AN);}}}}AJ=h;break;case 40:AG._hideActiveItemMenu();AG._focusNextItem();AJ=h;break;}if(AJ){Y.preventDefault();}},_onHorizontalMenuKeyDown:function(AJ){var AI=this,Y=AI._activeItem,AH=AA,AG;switch(AJ.keyCode){case 37:AI._hideActiveItemMenu();AI._focusPreviousItem();AH=h;break;case 39:AI._hideActiveItemMenu();AI._focusNextItem();AH=h;break;case 40:if(Y.hasClass(y)){AG=Y.next();if(AG){AI._showMenu(AG);}AH=h;}break;}if(AH){AJ.preventDefault();}},_onMouseMove:function(Y){this._currentMouseX=Y.pageX;},_onMouseOver:function(AJ){var AI=this,AG,Y,AL,AH,AK;if(AI._blockMouseEvent){AI._blockMouseEvent=AA;}else{AG=AJ.target;Y=X(AG);AL=l(AG);AK=v(AG);if(e(Y,AG)){AI._onMenuMouseOver(Y,AJ);Y[m]=h;Y[C]=AA;AH=J(Y);if(AH){AH[C]=h;AH[m]=AA;}}if(e(AL,AG)){AI._onMenuLabelMouseOver(AL,AJ);AL[m]=h;AL[C]=AA;}if(e(AK,AG)){AI._onMenuItemMouseOver(AK,AJ);AK[m]=h;AK[C]=AA;}}},_onMouseOut:function(AG){var AH=this,AJ=AH._activeMenu,AO=AA,AI,AK,AM,Y,AL,AN;AH._movingToSubmenu=(AJ&&!AJ.hasClass(a)&&((AG.pageX-5)>AH._currentMouseX));AI=AG.target;AK=AG.relatedTarget;AM=X(AI);Y=l(AI);AN=v(AI);if(F(Y,AK)){AH._onMenuLabelMouseOut(Y,AG);Y[C]=h;Y[m]=AA;}if(F(AN,AK)){AH._onMenuItemMouseOut(AN,AG);AN[C]=h;AN[m]=AA;}if(Y){AL=Y.next();if(AL&&(AK===AL||AL.contains(AK))){AO=h;}}if(F(AM,AK)||AO){AH._onMenuMouseOut(AM,AG);AM[C]=h;AM[m]=AA;}},_toggleSubmenuDisplay:function(AH){var AI=this,AJ=AH.target,AG=l(AJ),Y=AH.type,AN,AM,AL,AO,AP,AK;if(AG){AN=n(AJ);if(AN){AL=AN.getAttribute("href",2);AO=AL.indexOf("#");AP=AL.length;if(AO===0&&AP>1){AK=AL.substr(1,AP);AM=AG.next();if(AM&&(AM.get(f)===AK)){if(Y===o||(Y===AE&&AH.keyCode===13)){if(k.webkit&&!AI._hasFocus){AI._hasFocus=h;}if(AG.hasClass(Z)){AI._hideMenu(AM);AI._focusItem(AG);}else{AI._hideAllSubmenus(AI._rootMenu);AI._showMenu(AM);}}if(Y===r){AH.preventDefault();}}}}}},_onKeyPress:function(Y){switch(Y.keyCode){case 37:case 38:case 39:case 40:Y.preventDefault();break;}},_onKeyDown:function(AI){var AH=this,Y=AH._activeItem,AG=J(AI.target);if(AG){AH._activeMenu=AG;if(AG.hasClass(a)){AH._onHorizontalMenuKeyDown(AI);}else{AH._onVerticalMenuKeyDown(AI);}if(AI.keyCode===27){if(!AH._isRoot(AG)){AH._hideMenu(AG,h);AI.stopPropagation();AH._blockMouseEvent=k.gecko?h:AA;}else{if(Y){AH._blurItem(Y);}}}}},_onDocMouseDown:function(AI){var AH=this,AG=AH._rootMenu,Y=AI.target;if(!AG.compareTo(Y)&&!AG.contains(Y)){AH._hideAllSubmenus(AG);if(k.webkit){AH._hasFocus=AA;}}},_onDocFocus:function(AL){var AK=this,AG=AK._useARIA,AM=AK._firstItem,Y=AK._activeItem,AI=AL.target,AJ,AH;AK._hasFocus=AK._rootMenu.contains(AI);if(AK._hasFocus){if(AG){if(Y){AH=D(Y)?Y:Y.query(d);u(AH);}K(AI);}AK._activeItem=v(AI)||l(AI);}else{if(AG&&AM){AJ=D(AM)?AM:AM.query(d);K(AJ);}AK._activeItem=j;}}};A.namespace("Plugin");A.Plugin.NodeMenuNav=R;A.Plugin.NodeMenuNav.NAME="nodeMenuNav";A.Plugin.NodeMenuNav.NS="nodeMenuNav";A.Plugin.NodeMenuNav.SHIM_TEMPLATE='<iframe role="presentation" class="'+T+'" title="Menu Stacking Shim" src="javascript:FALSE;"></iframe>';},"@VERSION@",{requires:["node","classnamemanager"]});