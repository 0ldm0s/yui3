YUI.add("scrollview-scrollbars",function(Y,NAME){var getClassName=Y.ClassNameManager.getClassName,_classNames,Transition=Y.Transition,NATIVE_TRANSITIONS=Transition.useNative,SCROLLBAR="scrollbar",SCROLLVIEW="scrollview",VERTICAL_NODE="verticalNode",HORIZONTAL_NODE="horizontalNode",CHILD_CACHE="childCache",TOP="top",LEFT="left",WIDTH="width",HEIGHT="height",SCROLL_WIDTH="scrollWidth",SCROLL_HEIGHT="scrollHeight",HORIZ_CACHE="_sbh",VERT_CACHE="_sbv",TRANSITION_PROPERTY=Transition._VENDOR_PREFIX+"TransitionProperty",TRANSFORM="transform",TRANSLATE_X="translateX(",TRANSLATE_Y="translateY(",SCALE_X="scaleX(",SCALE_Y="scaleY(",SCROLL_X="scrollX",SCROLL_Y="scrollY",PX="px",CLOSE=")",PX_CLOSE=PX+CLOSE;function ScrollbarsPlugin(){ScrollbarsPlugin.superclass.constructor.apply(this,arguments)}ScrollbarsPlugin.CLASS_NAMES={showing:getClassName(SCROLLVIEW,SCROLLBAR,"showing"),scrollbar:getClassName(SCROLLVIEW,SCROLLBAR),scrollbarV:getClassName(SCROLLVIEW,SCROLLBAR,"vert"),scrollbarH:getClassName(SCROLLVIEW,SCROLLBAR,"horiz"),scrollbarVB:getClassName(SCROLLVIEW,SCROLLBAR,"vert","basic"),scrollbarHB:getClassName(SCROLLVIEW,SCROLLBAR,"horiz","basic"),child:getClassName(SCROLLVIEW,"child"),first:getClassName(SCROLLVIEW,"first"),middle:getClassName(SCROLLVIEW,"middle"),last:getClassName(SCROLLVIEW,"last")},_classNames=ScrollbarsPlugin.CLASS_NAMES,ScrollbarsPlugin.NAME="pluginScrollViewScrollbars",ScrollbarsPlugin.NS="scrollbars",ScrollbarsPlugin.SCROLLBAR_TEMPLATE=["<div>",'<span class="'+_classNames.child+" "+_classNames.first+'"></span>','<span class="'+_classNames.child+" "+_classNames.middle+'"></span>','<span class="'+_classNames.child+" "+_classNames.last+'"></span>',"</div>"].join(""),ScrollbarsPlugin.ATTRS={verticalNode:{setter:"_setNode",valueFn:"_defaultNode"},horizontalNode:{setter:"_setNode",valueFn:"_defaultNode"}},Y.namespace("Plugin").ScrollViewScrollbars=Y.extend(ScrollbarsPlugin,Y.Plugin.Base,{initializer:function(){this._host=this.get("host"),this.afterHostEvent("scrollEnd",this._hostScrollEnd),this.afterHostMethod("scrollTo",this._update),this.afterHostMethod("_uiDimensionsChange",this._hostDimensionsChange)},_hostDimensionsChange:function(){var host=this._host,axis=host.axis;this._renderBar(this.get(VERTICAL_NODE),axis.y,"vert"),this._renderBar(this.get(HORIZONTAL_NODE),axis.x,"horiz"),this._update(),Y.later(500,this,"flash",!0)},_hostScrollEnd:function(e){this._host._flicking||this.flash()},_renderBar:function(bar,add){var inDoc=bar.inDoc(),bb=this._host._bb,className=bar.getData("isHoriz")?_classNames.scrollbarHB:_classNames.scrollbarVB;add&&!inDoc?(bb.append(bar),bar.toggleClass(className,this._basic),this._setChildCache(bar)):!add&&inDoc&&(bar.remove(),this._clearChildCache(bar))},_setChildCache:function(node){var c=node.get("children"),fc=c.item(0),mc=c.item(1),lc=c.item(2),size=node.getData("isHoriz")?"offsetWidth":"offsetHeight";node.setStyle(TRANSITION_PROPERTY,TRANSFORM),mc.setStyle(TRANSITION_PROPERTY,TRANSFORM),lc.setStyle(TRANSITION_PROPERTY,TRANSFORM),node.setData(CHILD_CACHE,{fc:fc,lc:lc,mc:mc,fcSize:fc&&fc.get(size),lcSize:lc&&lc.get(size)})},_clearChildCache:function(node){node.clearData(CHILD_CACHE)},_updateBar:function(scrollbar,current,duration,horiz){var host=this._host,basic=this._basic,cb=host._cb,scrollbarSize=0,scrollbarPos=1,childCache=scrollbar.getData(CHILD_CACHE),lastChild=childCache.lc,middleChild=childCache.mc,firstChildSize=childCache.fcSize,lastChildSize=childCache.lcSize,middleChildSize,lastChildPosition,transition,translate,scale,dim,dimOffset,dimCache,widgetSize,contentSize;horiz?(dim=WIDTH,dimOffset=LEFT,dimCache=HORIZ_CACHE,widgetSize=host.get("width"),contentSize=host._scrollWidth,translate=TRANSLATE_X,scale=SCALE_X,current=current!==undefined?current:host.get(SCROLL_X)):(dim=HEIGHT,dimOffset=TOP,dimCache=VERT_CACHE,widgetSize=host.get("height"),contentSize=host._scrollHeight,translate=TRANSLATE_Y,scale=SCALE_Y,current=current!==undefined?current:host.get(SCROLL_Y)),scrollbarSize=Math.floor(widgetSize*(widgetSize/contentSize)),scrollbarPos=Math.floor(current/(contentSize-widgetSize)*(widgetSize-scrollbarSize)),scrollbarSize>widgetSize&&(scrollbarSize=1),scrollbarPos>widgetSize-scrollbarSize?scrollbarSize-=scrollbarPos-(widgetSize-scrollbarSize):scrollbarPos<0&&(scrollbarSize=scrollbarPos+scrollbarSize,scrollbarPos=0),middleChildSize=scrollbarSize-(firstChildSize+lastChildSize),middleChildSize<0&&(middleChildSize=0),middleChildSize===0&&scrollbarPos!==0&&(scrollbarPos=widgetSize-(firstChildSize+lastChildSize)-1),duration!==0?(transition={duration:duration},NATIVE_TRANSITIONS?transition.transform=translate+scrollbarPos+PX_CLOSE:transition[dimOffset]=scrollbarPos+PX,scrollbar.transition(transition)):NATIVE_TRANSITIONS?scrollbar.setStyle(TRANSFORM,translate+scrollbarPos+PX_CLOSE):scrollbar.setStyle(dimOffset,scrollbarPos+PX);if(this[dimCache]!==middleChildSize){this[dimCache]=middleChildSize;if(middleChildSize>0){duration!==0?(transition={duration:duration},NATIVE_TRANSITIONS?transition.transform=scale+middleChildSize+CLOSE:transition[dim]=middleChildSize+PX,middleChild.transition(transition)):NATIVE_TRANSITIONS?middleChild.setStyle(TRANSFORM,scale+middleChildSize+CLOSE):middleChild.setStyle(dim,middleChildSize+PX);if(!horiz||!basic)lastChildPosition=scrollbarSize-lastChildSize,duration!==0?(transition={duration:duration},NATIVE_TRANSITIONS?transition.transform=translate+lastChildPosition+PX_CLOSE:transition[dimOffset]=lastChildPosition,lastChild.transition(transition)):NATIVE_TRANSITIONS?lastChild.setStyle(TRANSFORM,translate+lastChildPosition+PX_CLOSE):lastChild.setStyle(dimOffset,lastChildPosition+PX)}}},_update:function(x,y,duration,easing){var vNode=this.get(VERTICAL_NODE),hNode=this.get(HORIZONTAL_NODE),host=this._host,axis=host.axis;duration=(duration||0)/1e3,this._showing||this.show(),axis.y&&vNode&&this._updateBar(vNode,y,duration,!1),axis.x&&hNode&&this._updateBar(hNode,x,duration,!0)},show:function(animated){this._show(!0,animated)},hide:function(animated){this._show(!1,animated)},_show:function(show,animated){var verticalNode=this.get(VERTICAL_NODE),horizontalNode=this.get(HORIZONTAL_NODE),duration=animated?.6:0,opacity=show?1:0,transition;this._showing=show,this._flashTimer&&this._flashTimer.cancel(),transition={duration:duration,opacity:opacity},verticalNode&&verticalNode.transition(transition),horizontalNode&&horizontalNode.transition(transition)},flash:function(){var host=this._host;this.show(!0),this._flashTimer=Y.later(800,this,"hide",!0)},_setNode:function(node,name){var horiz=name===HORIZONTAL_NODE;return node=Y.one(node),node&&(node.addClass(_classNames.scrollbar),node.addClass(horiz?_classNames.scrollbarH:_classNames.scrollbarV),node.setData("isHoriz",horiz)),node},_defaultNode:function(){return Y.Node.create(ScrollbarsPlugin.SCROLLBAR_TEMPLATE)},_basic:Y.UA.ie&&Y.UA.ie<=8})},"@VERSION@",{requires:["classnamemanager","transition","plugin"],skinnable:!0})