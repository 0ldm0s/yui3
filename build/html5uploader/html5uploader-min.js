YUI.add("html5uploader",function(c){var a=c.substitute;function b(d){b.superclass.constructor.apply(this,arguments);}c.Html5Uploader=c.extend(b,c.Widget,{_foo:null,_fileInputField:null,_uploadQueue:null,initializer:function(){},_uploadEventHandler:function(d){switch(d.type){case"file:uploadprogress":this.fire("uploadprogress",d);break;case"uploadqueue:totaluploadprogress":this.fire("totaluploadprogress",d);break;case"file:uploadcomplete":this.fire("uploadcomplete",d);break;case"uploadqueue:alluploadscomplete":this.fire("alluploadscomplete",d);break;case"uploadqueue:uploaderror":this.fire("uploaderror",d);}},_setMultipleFiles:function(){if(this.get("multipleFiles")===true){this._fileInputField.set("multiple","multiple");}else{this._fileInputField.set("multiple","");}},_bindSelectButton:function(){this.get("selectFilesButton").on("click",this.openFileSelectDialog,this);},_updateFileList:function(f){var e=f.target.getDOMNode().files,d=[];c.each(e,function(h){d.push(new c.File(h));});this.fire("fileselect",{fileList:d});var g=this.get("fileList");this.set("fileList",this.get("appendNewFiles")?g.concat(d):d);},openFileSelectDialog:function(){var d=this._fileInputField.getDOMNode();if(d.click){d.click();}},renderUI:function(){var d=this.get("contentBox");d.append(this.get("selectFilesButton"));this._fileInputField=c.Node.create(b.HTML5FILE_FIELD);d.append(this._fileInputField);},bindUI:function(){this._bindSelectButton();this._setMultipleFiles();this.after("multipleFilesChange",this._setMultipleFiles,this);this.after("selectFilesButtonChange",this._bindSelectButton,this);this._fileInputField.on("change",this._updateFileList,this);},syncUI:function(){},upload:function(g,e,h){var f=e||this.get("uploadURL"),d=h||this.get("postVarsPerFile");if(g instanceof c.File){this._uploadQueue=new c.Uploader.UploadQueue({simUploads:this.get("simLimit"),errorAction:"restart",fileList:[g],uploadURL:f,perFileParameters:d});this._uploadQueue.on("uploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("totaluploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("uploadcomplete",this._uploadEventHandler,this);this._uploadQueue.on("alluploadscomplete",this._uploadEventHandler,this);this._uploadQueue.startUpload();}},uploadAll:function(e,g){var f=e||this.get("uploadURL"),d=g||this.get("postVarsPerFile");this._uploadQueue=new c.Uploader.UploadQueue({simUploads:this.get("simLimit"),errorAction:"restart",fileList:this.get("fileList"),uploadURL:f,perFileParameters:d});this._uploadQueue.on("uploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("totaluploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("uploadcomplete",this._uploadEventHandler,this);this._uploadQueue.on("alluploadscomplete",this._uploadEventHandler,this);this._uploadQueue.startUpload();},uploadThese:function(h,e,g){var f=e||this.get("uploadURL"),d=g||this.get("postVarsPerFile");this._uploadQueue=new c.Uploader.UploadQueue({simUploads:this.get("simLimit"),errorAction:"restart",fileList:h,uploadURL:f,perFileParameters:d});this._uploadQueue.on("uploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("totaluploadprogress",this._uploadEventHandler,this);this._uploadQueue.on("uploadcomplete",this._uploadEventHandler,this);this._uploadQueue.on("alluploadscomplete",this._uploadEventHandler,this);this._uploadQueue.startUpload();}},{HTML5FILE_FIELD:"<input type='file' style='visibility:hidden; width:0px; height: 0px;'>",NAME:"html5uploader",ATTRS:{selectFilesButton:{value:c.Node.create("<button type='button' style='height:100%;width:100%'>Select Files</button>")},dragAndDropArea:{value:null},multipleFiles:{value:false},appendNewFiles:{value:true},simLimit:{value:2,validator:function(e,d){return(e>=2&&e<=5);}},fileList:{value:[]},postVarsPerFile:{value:[]},uploadURL:{value:""}}});},"@VERSION@",{requires:["widget","substitute","node-event-simulate","file","uploadqueue"]});