YUI.add("scrollview-base",function(C){var D=C.ClassNameManager.getClassName,M="scrollview",H=10,B=150,I={scrollbar:D(M,"scrollbar"),vertical:D(M,"vertical"),horizontal:D(M,"horizontal"),child:D(M,"child"),b:D(M,"b"),middle:D(M,"middle"),showing:D(M,"showing")},A="scrollStart",F="scrollChange",Q="scrollEnd",L="flick",E="ui",J="scrollY",K="scrollX",O="bounce",N="boundingBox",P="contentBox";C.Node.DOM_EVENTS.DOMSubtreeModified=true;function G(){G.superclass.constructor.apply(this,arguments);}C.ScrollView=C.extend(G,C.Widget,{initializer:function(){this._createEvents();},_createEvents:function(){this.publish(A);this.publish(F);this.publish(Q);this.publish(L);},_uiSizeCB:function(){},_transitionEnded:function(){this.fire(Q);},bindUI:function(){this.get(N).on("gesturemovestart",C.bind(this._onGestureMoveStart,this));var R=this.get(P);R.on("transitionend",C.bind(this._transitionEnded,this),false);R.on("DOMSubtreeModified",C.bind(this._uiDimensionsChange,this));R.on("flick",C.bind(this._flick,this),{minDistance:0});this.after({"scrollYChange":this._afterScrollYChange,"scrollXChange":this._afterScrollXChange,"heightChange":this._afterHeightChange,"widthChange":this._afterWidthChange,"renderedChange":function(){C.later(0,this,"_uiDimensionsChange");}});},syncUI:function(){this.scrollTo(this.get(K),this.get(J));},scrollTo:function(S,Y,U,X){var R=this.get(P),T=S*-1,W=Y*-1,V;if(S!==this.get(K)){this.set(K,S,{src:E});}if(Y!==this.get(J)){this.set(J,Y,{src:E});}V={easing:X||"cubic-bezier(0, 0.1, 0, 1.0)",duration:U/1000};if(C.TransitionNative.supported){V.transform="translate("+T+"px,"+W+"px)";}else{V.easing="ease-out";V.left=T+"px";V.top=W+"px";}R.transition(V);},_onGestureMoveStart:function(R){this._killTimer();var S=this.get(N);this._moveEvt=S.on("gesturemove",C.bind(this._onGestureMove,this));this._moveEndEvt=S.on("gesturemoveend",C.bind(this._onGestureMoveEnd,this));this._moveStartY=R.clientY+this.get(J);this._moveStartX=R.clientX+this.get(K);this._moveStartTime=(new Date()).getTime();this._moveStartClientY=R.clientY;this._moveStartClientX=R.clientX;this._isDragging=false;this._snapToEdge=false;},_onGestureMove:function(R){this._isDragging=true;this._moveEndClientY=R.clientY;this._moveEndClientX=R.clientX;this._lastMoved=(new Date()).getTime();if(this._scrollsVertical){this.set(J,-(R.clientY-this._moveStartY));}if(this._scrollsHorizontal){this.set(K,-(R.clientX-this._moveStartX));}},_onGestureMoveEnd:function(W){var Y=this._minScrollY,U=this._maxScrollY,R=this._minScrollX,V=this._maxScrollX,T=this._scrollsVertical?this._moveStartClientY:this._moveStartClientX,S=this._scrollsVertical?this._moveEndClientY:this._moveEndClientX,X=T-S;this._moveEvt.detach();this._moveEndEvt.detach();this._scrolledHalfway=false;this._snapToEdge=false;this._isDragging=false;if(this._scrollsHorizontal&&Math.abs(X)>(this.get("width")/2)){this._scrolledHalfway=true;this._scrolledForward=X>0;}if(this._scrollsVertical&&Math.abs(X)>(this.get("height")/2)){this._scrolledHalfway=true;this._scrolledForward=X>0;}if(this._scrollsVertical&&this.get(J)<Y){this._snapToEdge=true;this.set(J,Y);}if(this._scrollsHorizontal&&this.get(K)<R){this._snapToEdge=true;this.set(K,R);}if(this.get(J)>U){this._snapToEdge=true;this.set(J,U);}if(this.get(K)>V){this._snapToEdge=true;this.set(K,V);}if(this._snapToEdge){return;}if(+(new Date())-this._moveStartTime>100){this.fire(Q,{staleScroll:true});return;}},_afterScrollYChange:function(R){if(R.src!==E){this._uiScrollY(R.newVal,R.duration,R.easing);}},_uiScrollY:function(S,R,T){R=R||this._snapToEdge?400:0;T=T||this._snapToEdge?"ease-out":null;this.scrollTo(this.get(K),S,R,T);},_afterScrollXChange:function(R){if(R.src!==E){this._uiScrollX(R.newVal,R.duration,R.easing);}},_uiScrollX:function(S,R,T){R=R||this._snapToEdge?400:0;T=T||this._snapToEdge?"ease-out":null;this.scrollTo(S,this.get(J),R,T);},_afterHeightChange:function(){this._uiDimensionsChange();},_afterWidthChange:function(){this._uiDimensionsChange();},_uiDimensionsChange:function(){var S=this.get(P),W=this.get(N),R=this.get("height"),V=this.get("width"),U=S.get("scrollHeight"),T=S.get("scrollWidth");if(R&&U>R){this._scrollsVertical=true;this._maxScrollY=U-R;this._minScrollY=0;W.setStyle("overflow-y","auto");}if(V&&T>V){this._scrollsHorizontal=true;this._maxScrollX=T-V;this._minScrollX=0;W.setStyle("overflow-x","auto");}},_flick:function(S){var R=S.flick;this._currentVelocity=R.velocity*R.direction;this._flicking=true;this._flickFrame();this.fire(L);},_flickFrame:function(){var V=this.get(J),T=this._maxScrollY,X=this._minScrollY,W=this.get(K),U=this._maxScrollX,R=this._minScrollX,S=G.FRAME_STEP;this._currentVelocity=(this._currentVelocity*this.get("deceleration"));if(this._scrollsVertical){V=this.get(J)-(this._currentVelocity*S);}if(this._scrollsHorizontal){W=this.get(K)-(this._currentVelocity*S);}if(Math.abs(this._currentVelocity).toFixed(4)<=0.015){this._flicking=false;this._killTimer(!(this._exceededYBoundary||this._exceededXBoundary));if(this._scrollsVertical){if(V<X){this._snapToEdge=true;this.set(J,X);}else{if(V>T){this._snapToEdge=true;this.set(J,T);}}}if(this._scrollsHorizontal){if(W<R){this._snapToEdge=true;this.set(K,R);}else{if(W>U){this._snapToEdge=true;this.set(K,U);}}}return;}if(this._scrollsVertical&&(V<X||V>T)){this._exceededYBoundary=true;this._currentVelocity*=this.get(O);}if(this._scrollsHorizontal&&(W<R||W>U)){this._exceededXBoundary=true;this._currentVelocity*=this.get(O);}if(this._scrollsVertical){this.set(J,V);}if(this._scrollsHorizontal){this.set(K,W);}this._flickTimer=C.later(H,this,"_flickFrame");},_killTimer:function(R){if(this._flickTimer){this._flickTimer.cancel();}if(R){this.fire(Q);}},_setScrollX:function(V){var T=this.get(O),S=G.BOUNCE_RANGE,U=T?-S:0,R=T?this._maxScrollX+S:this._maxScrollX;if(!T||!this._isDragging){if(V<U){V=U;}else{if(V>R){V=R;}}}return V;},_setScrollY:function(V){var T=this.get(O),S=G.BOUNCE_RANGE,U=T?-S:0,R=T?this._maxScrollY+S:this._maxScrollY;if(!T||!this._isDragging){if(V<U){V=U;}else{if(V>R){V=R;
}}}return V;}},{NAME:"scrollview",ATTRS:{scrollY:{value:0,setter:"_setScrollY"},scrollX:{value:0,setter:"_setScrollX"},deceleration:{value:0.98},bounce:{value:0.7}},CLASS_NAMES:I,UI_SRC:E,BOUNCE_RANGE:B,FRAME_STEP:H});},"@VERSION@",{skinnable:true,requires:["widget","event-gestures","transition"]});