YUI.add("scrollview-base",function(B){var C=B.ClassNameManager.getClassName,J="scrollview",G={scrollbar:C(J,"scrollbar"),vertical:C(J,"vertical"),horizontal:C(J,"horizontal"),child:C(J,"child"),b:C(J,"b"),middle:C(J,"middle"),showing:C(J,"showing")},A="scrollStart",E="scrollChange",O="scrollEnd",K="flick",D="ui",H="scrollY",I="scrollX",M="bounce",L="boundingBox",N="contentBox";B.Node.DOM_EVENTS.DOMSubtreeModified=true;function F(){F.superclass.constructor.apply(this,arguments);}B.ScrollView=B.extend(F,B.Widget,{initializer:function(){this._createEvents();},_createEvents:function(){this.publish(A);this.publish(E);this.publish(O);this.publish(K);},_uiSizeCB:function(){},_transitionEnded:function(){this.fire(O);},bindUI:function(){this.get(L).on("gesturemovestart",B.bind(this._onGestureMoveStart,this));var P=this.get(N);P.on("transitionend",B.bind(this._transitionEnded,this),false);P.on("DOMSubtreeModified",B.bind(this._uiDimensionsChange,this));P.on("flick",B.bind(this._flick,this),{minDistance:0});this.after({"scrollYChange":this._afterScrollYChange,"scrollXChange":this._afterScrollXChange,"heightChange":this._afterHeightChange,"widthChange":this._afterWidthChange,"renderedChange":function(){B.later(0,this,"_uiDimensionsChange");}});},syncUI:function(){this.scrollTo(this.get(I),this.get(H));},scrollTo:function(Q,W,S,V){var P=this.get(N),R=Q*-1,U=W*-1,T;if(Q!==this.get(I)){this.set(I,Q,{src:D});}if(W!==this.get(H)){this.set(H,W,{src:D});}T={easing:V||F.EASING,duration:S/1000};if(B.TransitionNative.supported){T.transform="translate("+R+"px,"+U+"px)";}else{T.easing="ease-out";T.left=R+"px";T.top=U+"px";}P.transition(T);},_onGestureMoveStart:function(P){this._killTimer();var Q=this.get(L);this._moveEvt=Q.on("gesturemove",B.bind(this._onGestureMove,this));this._moveEndEvt=Q.on("gesturemoveend",B.bind(this._onGestureMoveEnd,this));this._moveStartY=P.clientY+this.get(H);this._moveStartX=P.clientX+this.get(I);this._moveStartTime=(new Date()).getTime();this._moveStartClientY=P.clientY;this._moveStartClientX=P.clientX;this._isDragging=false;this._snapToEdge=false;},_onGestureMove:function(P){this._isDragging=true;this._moveEndClientY=P.clientY;this._moveEndClientX=P.clientX;this._lastMoved=(new Date()).getTime();if(this._scrollsVertical){this.set(H,-(P.clientY-this._moveStartY));}if(this._scrollsHorizontal){this.set(I,-(P.clientX-this._moveStartX));}},_onGestureMoveEnd:function(U){var W=this._minScrollY,S=this._maxScrollY,P=this._minScrollX,T=this._maxScrollX,R=this._scrollsVertical?this._moveStartClientY:this._moveStartClientX,Q=this._scrollsVertical?this._moveEndClientY:this._moveEndClientX,V=R-Q;this._moveEvt.detach();this._moveEndEvt.detach();this._scrolledHalfway=false;this._snapToEdge=false;this._isDragging=false;if(this._scrollsHorizontal&&Math.abs(V)>(this.get("width")/2)){this._scrolledHalfway=true;this._scrolledForward=V>0;}if(this._scrollsVertical&&Math.abs(V)>(this.get("height")/2)){this._scrolledHalfway=true;this._scrolledForward=V>0;}if(this._scrollsVertical&&this.get(H)<W){this._snapToEdge=true;this.set(H,W);}if(this._scrollsHorizontal&&this.get(I)<P){this._snapToEdge=true;this.set(I,P);}if(this.get(H)>S){this._snapToEdge=true;this.set(H,S);}if(this.get(I)>T){this._snapToEdge=true;this.set(I,T);}if(this._snapToEdge){return;}if(+(new Date())-this._moveStartTime>100){this.fire(O,{staleScroll:true});return;}},_afterScrollYChange:function(P){if(P.src!==D){this._uiScrollY(P.newVal,P.duration,P.easing);}},_uiScrollY:function(Q,P,R){P=P||this._snapToEdge?400:0;R=R||this._snapToEdge?F.SNAP_EASING:null;this.scrollTo(this.get(I),Q,P,R);},_afterScrollXChange:function(P){if(P.src!==D){this._uiScrollX(P.newVal,P.duration,P.easing);}},_uiScrollX:function(Q,P,R){P=P||this._snapToEdge?400:0;R=R||this._snapToEdge?F.SNAP_EASING:null;this.scrollTo(Q,this.get(H),P,R);},_afterHeightChange:function(){this._uiDimensionsChange();},_afterWidthChange:function(){this._uiDimensionsChange();},_uiDimensionsChange:function(){var Q=this.get(N),U=this.get(L),P=this.get("height"),T=this.get("width"),S=Q.get("scrollHeight"),R=Q.get("scrollWidth");if(P&&S>P){this._scrollsVertical=true;this._maxScrollY=S-P;this._minScrollY=0;U.addClass(C("scroll-v"));}if(T&&R>T){this._scrollsHorizontal=true;this._maxScrollX=R-T;this._minScrollX=0;U.addClass(this.getClassName("scroll-h"));}},_flick:function(Q){var P=Q.flick;this._currentVelocity=P.velocity*P.direction;this._flicking=true;this._flickFrame();this.fire(K);},_flickFrame:function(){var T=this.get(H),R=this._maxScrollY,V=this._minScrollY,U=this.get(I),S=this._maxScrollX,P=this._minScrollX,Q=F.FRAME_STEP;this._currentVelocity=(this._currentVelocity*this.get("deceleration"));if(this._scrollsVertical){T=this.get(H)-(this._currentVelocity*Q);}if(this._scrollsHorizontal){U=this.get(I)-(this._currentVelocity*Q);}if(Math.abs(this._currentVelocity).toFixed(4)<=0.015){this._flicking=false;this._killTimer(!(this._exceededYBoundary||this._exceededXBoundary));if(this._scrollsVertical){if(T<V){this._snapToEdge=true;this.set(H,V);}else{if(T>R){this._snapToEdge=true;this.set(H,R);}}}if(this._scrollsHorizontal){if(U<P){this._snapToEdge=true;this.set(I,P);}else{if(U>S){this._snapToEdge=true;this.set(I,S);}}}return;}if(this._scrollsVertical&&(T<V||T>R)){this._exceededYBoundary=true;this._currentVelocity*=this.get(M);}if(this._scrollsHorizontal&&(U<P||U>S)){this._exceededXBoundary=true;this._currentVelocity*=this.get(M);}if(this._scrollsVertical){this.set(H,T);}if(this._scrollsHorizontal){this.set(I,U);}this._flickTimer=B.later(F.FRAME_STEP,this,"_flickFrame");},_killTimer:function(P){if(this._flickTimer){this._flickTimer.cancel();}if(P){this.fire(O);}},_setScrollX:function(T){var R=this.get(M),Q=F.BOUNCE_RANGE,S=R?-Q:0,P=R?this._maxScrollX+Q:this._maxScrollX;if(!R||!this._isDragging){if(T<S){T=S;}else{if(T>P){T=P;}}}return T;},_setScrollY:function(T){var R=this.get(M),Q=F.BOUNCE_RANGE,S=R?-Q:0,P=R?this._maxScrollY+Q:this._maxScrollY;if(!R||!this._isDragging){if(T<S){T=S;}else{if(T>P){T=P;}}}return T;
}},{NAME:"scrollview",ATTRS:{scrollY:{value:0,setter:"_setScrollY"},scrollX:{value:0,setter:"_setScrollX"},deceleration:{value:0.98},bounce:{value:0.7}},CLASS_NAMES:G,UI_SRC:D,BOUNCE_RANGE:150,FRAME_STEP:10,EASING:"cubic-bezier(0, 0.1, 0, 1.0)",SNAP_EASING:"ease-out"});},"@VERSION@",{skinnable:true,requires:["widget","event-gestures","transition"]});