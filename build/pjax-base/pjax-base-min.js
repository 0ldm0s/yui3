YUI.add("pjax-base",function(e){var c=e.config.win,d=e.ClassNameManager.getClassName("pjax"),a="navigate";function b(){}b.prototype={_regexURL:/^((?:[^\/#?:]+:\/\/|\/\/)[^\/]*)?([^?#]*)(\?[^#]*)?(#.*)?$/,initializer:function(){this.publish(a,{defaultFn:this._defNavigateFn});if(this.get("html5")){this._pjaxBindUI();}},destructor:function(){this._pjaxEvents&&this._pjaxEvents.detach();},navigate:function(g,f){g=this._resolveURL(g);if(this._navigate(g,f)){return true;}if(!this._hasSameOrigin(g)){e.error("Security error: The new URL must be of the same origin as the current URL.");}return false;},_getRoot:function(){var g="/",h=e.getLocation().pathname,f;if(h.charAt(h.length-1)===g){return h;}f=h.split(g);f.pop();return f.join(g)+g;},_navigate:function(h,g){if(!this.hasRoute(h)){return false;}g||(g={});g.url=h;var j=this._getURL(),i,f;f=h.replace(/(#.*)$/,function(k,m,l){i=m;return k.substring(l);});if(i&&f===j.replace(/#.*$/,"")){if(!this.get("navigateOnHash")){return false;}g.hash=i;}"replace" in g||(g.replace=h===j);if(this.get("html5")||g.force){this.fire(a,g);}else{if(g.replace){c&&c.location.replace(h);}else{c&&(c.location=h);}}return true;},_normalizePath:function(o){var l="..",f="/",g,k,n,h,j,m;if(!o||o===f){return f;}h=o.split(f);m=[];for(g=0,k=h.length;g<k;++g){j=h[g];if(j===l){m.pop();}else{if(j){m.push(j);}}}n=f+m.join(f);if(n!==f&&o.charAt(o.length-1)===f){n+=f;}return n;},_pjaxBindUI:function(){if(!this._pjaxEvents){this._pjaxEvents=e.one("body").delegate("click",this._onLinkClick,this.get("linkSelector"),this);}},_resolvePath:function(f){if(!f){return this._getPath();}if(f.charAt(0)==="/"){return this._normalizePath(f);}return this._normalizePath(this._getRoot()+f);},_resolveURL:function(h){var l=h&&h.match(this._regexURL),g,k,i,j,f;if(!l){return this._getURL();}g=l[1];k=l[2];i=l[3];j=l[4];if(g){if(g.indexOf("//")===0){g=e.getLocation().protocol+g;}return g+(k||"/")+(i||"")+(j||"");}f=this._getOrigin()+this._resolvePath(k);if(k||i){return f+(i||"")+(j||"");}i=this._getQuery();return f+(i?("?"+i):"")+(j||"");},_defNavigateFn:function(f){this[f.replace?"replace":"save"](f.url);if(c&&this.get("scrollToTop")){setTimeout(function(){c.scroll(0,0);},1);}},_onLinkClick:function(i){var f,h,g;if(i.button!==1||i.ctrlKey||i.metaKey){return;}f=e.getLocation(),h=i.currentTarget;if(h.get("tagName").toUpperCase()!=="A"){return;}if(h.get("protocol")!==f.protocol||h.get("host")!==f.host){return;}g=i.currentTarget.get("href");g&&this._navigate(g,{originEvent:i})&&i.preventDefault();}};b.ATTRS={linkSelector:{value:"a."+d,writeOnce:"initOnly"},navigateOnHash:{value:false},scrollToTop:{value:true}};e.PjaxBase=b;},"@VERSION@",{requires:["classnamemanager","node-event-delegate","router"]});