YUI.add("datatable-base",function(B){var A=B.Lang,C=B.Node,D=B.ClassNameManager.getClassName,I=B.bind,O="datatable",G=D(O,"data"),M=D(O,"msg"),E=D(O,"first"),K=D(O,"last"),F='<th id="{id}" rowspan="{rowspan}" colspan="{colspan}">{value}</th>',N='<tr id="{id}"></tr>',H='<td headers="{headers}">{value}</td>',J="{value}";function L(P){L.superclass.constructor.apply(this,arguments);}L.NAME="baseDataTable";L.ATTRS={columnset:{setter:"_setColumnset"},recordset:{setter:"_setRecordset"},state:{value:new B.State(),readOnly:true},strings:{valueFn:function(){return B.Intl.get("datatable-base");}},thValueTemplate:{value:J},tdValueTemplate:{value:J},trTemplate:{value:N}};L.HTML_PARSER={attrA:function(P){}};B.extend(L,B.Widget,{thTemplate:F,tdTemplate:H,_theadNode:null,_tbodyNode:null,_msgNode:null,_setColumnset:function(P){return A.isArray(P)?new B.Columnset({columns:P}):P;},_setRecordset:function(P){if(A.isArray(P)){P=new B.Recordset({records:P});}P.addTarget(this);return P;},initializer:function(){this.publish("addTr",{defaultFn:I("_defAddTrFn",this),queuable:true});this.publish("theadCellClick",{emitFacade:false,defaultFn:I("_defTheadCellClickFn",this),queuable:true});this.publish("theadRowClick",{emitFacade:false,defaultFn:I("_defTheadRowClickFn",this),queuable:true});this.publish("theadClick",{emitFacade:false,defaultFn:I("_defTheadClickFn",this),queuable:true});},destructor:function(){this.get("recordset").removeTarget(this);},renderUI:function(){var P=this._createTableNode();P=P?this._createColgroupNode(this._tableNode):false;P=P?this._createTheadNode(this._tableNode):false;P=P?this._createTbodyNode(this._tableNode):false;P=P?this._createMessageNode(this._tableNode):false;P=P?this._createCaptionNode(this._tableNode):false;return P;},_createTableNode:function(){if(!this._tableNode){this._tableNode=this.get("contentBox").appendChild(C.create("<table></table>"));}return this._tableNode;},_createColgroupNode:function(S){var R=this.get("columnset").get("keys"),Q=0,P=R.length,T=["<colgroup>"];for(;Q<P;++Q){T.push("<col></col>");}T.push("</colgroup>");this._colgroupNode=S.insertBefore(C.create(T.join("")),S.get("firstChild"));return this._colgroupNode;},_createTheadNode:function(P){if(P){this._theadNode=P.insertBefore(C.create("<thead class='"+G+"'></thead>"),this._colgroupNode.next());return this._theadNode;}},_createTbodyNode:function(P){this._tbodyNode=P.appendChild(C.create("<tbody class='"+G+"'></tbody>"));return this._tbodyNode;},_createMessageNode:function(P){this._msgNode=P.insertBefore(C.create("<tbody class='"+M+"'></tbody>"),this._tbodyNode);return this._msgNode;},_createCaptionNode:function(P){this._captionNode=P.invoke("createCaption");return this._captionNode;},bindUI:function(){var R=this._theadNode,S=this._tbodyNode,Q=this._msgNode,P=this.get("contentBox");this._tableNode.delegate("click",I(this._onTheadClick,this),"thead."+G+">tr>th");this._tableNode.delegate("click",I(this._onTbodyClick,this),"tbody."+G+">tr>td");this._tableNode.delegate("click",I(this._onMsgClick,this),"tbody."+M+">tr>td");},_onTheadFocus:function(){},_onTheadKeydown:function(){},_onTheadClick:function(R,Q,P){this.fire("theadCellClick",R);this.fire("theadRowClick",R);this.fire("theadClick",R);},_onTbodyFocus:function(){},_onTbodyKeydown:function(){},_onTbodyClick:function(){},_onTableMouseover:function(){},_onTableMouseout:function(){},_onTableMousedown:function(){},_onTableMouseup:function(){},_onTableKeypress:function(){},_onTableFocus:function(){},_onTableDblclick:function(){},_defTheadCellClickFn:function(){},syncUI:function(){this._uiSetStrings(this.get("strings"));this._uiSetColumnset(this.get("columnset"));this._uiSetRecordset(this.get("recordset"));},_afterStringsChange:function(P){this._uiSetStrings(P.newVal);},_uiSetStrings:function(P){this._uiSetSummary(P.summary);this._uiSetCaption(P.caption);},_uiSetSummary:function(P){this._tableNode.set("summary",P);},_uiSetCaption:function(P){this._captionNode.set("innerHTML",P);},_afterColumnsetChange:function(P){this._uiSetColumnset(P.newVal);},_uiSetColumnset:function(T){var Q=T.get("tree"),R=this._theadNode,U,S=0,P=Q.length;for(;S<P;++S){U=this._createHeaderTr(Q[S]);if(S===0){U.addClass(E);}if(S===(P-1)){U.addClass(K);}R.appendChild(U);}},_createHeaderTr:function(P){var Q=C.create(this._getHeaderTrMarkup(P));this._createThNodes(P,Q);this.fire("addHeaderTr",{record:P,tr:Q});return Q;},_getHeaderTrMarkup:function(P){return B.substitute(this.get("trTemplate"),{});},_createThNodes:function(U,T){var R=0,P=U.length,Q=[],S,V;for(;R<P;++R){S=U[R];Q.push(this._getThNodeMarkup({value:S.get("label")},S));}T.appendChild(C.create(Q.join("")));},_getThNodeMarkup:function(Q,P){Q.column=P;Q.id=P.get("id");Q.value=B.substitute(this.get("thValueTemplate"),Q);Q.colspan=P.get("colspan");Q.rowspan=P.get("rowspan");return B.substitute(this.thTemplate,Q);},_afterRecordsetChange:function(P){this._uiSetRecordset(P.newVal);},_uiSetRecordset:function(R){var T=this._tbodyNode,S=0,P=3,Q,V,U;for(;S<P;++S){Q=R.getRecord(S);V=T.one("#"+Q.get("id"))||this._createBodyTr(Q);U=T.get("children").item(S)||null;T.insertBefore(V,U);}},_createBodyTr:function(P){var Q=C.create(this._getDataTrMarkup(P));this._createTdNodes(P,Q);this.fire("addDataTr",{record:P,tr:Q});return Q;},_getDataTrMarkup:function(P){return B.substitute(this.get("trTemplate"),{id:P.get("id")});},_createTdNodes:function(Q,U){var R=0,T=this.get("columnset").get("keys"),P=T.length,S=[];for(;R<P;++R){S.push(this._getTdNodeMarkup(Q,T[R]));}U.appendChild(C.create(S.join("")));},_getTdNodeMarkup:function(P,Q){var R={};R.headers=Q.get("headers");R.value=this.formatDataCell(P,Q);return B.substitute(this.tdTemplate,R);},formatDataCell:function(P,Q){var R={};R.data=P.get("data");R.value=P.getValue(Q.get("key"));return B.substitute(this.get("tdValueTemplate"),R);}});B.namespace("DataTable").Base=L;},"@VERSION@",{lang:["en"],requires:["intl","substitute","widget"]});