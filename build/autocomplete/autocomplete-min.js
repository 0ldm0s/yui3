YUI.add("autocomplete-base",function(D){var F=D.Get,G=D.Lang,K=D.Array,L=G.isArray,B=G.isFunction,N=G.isNumber,P=G.trim,E="inputNode",R="query",C="queryDelimiter",H="results",I="value",M="valueChange",A="clear",O=R,J=H;function Q(){this.publish(A,{defaultFn:this._defClearFn,queueable:true});this.publish(O,{defaultFn:this._defQueryFn,queueable:true});this.publish(J,{defaultFn:this._defResultsFn,queueable:true});}Q.ATTRS={allowBrowserAutocomplete:{value:false,writeOnce:"initOnly"},inputNode:{setter:D.one,writeOnce:"initOnly"},maxResults:{validator:N,value:0},minQueryLength:{validator:N,value:1},query:{readOnly:true,value:null},queryDelay:{validator:function(S){return N(S)&&S>=0;},value:100},queryDelimiter:{value:null},requestTemplate:{setter:function(S){if(S===null||B(S)){return S;}S=S.toString();return function(T){return G.sub(S,{query:encodeURIComponent(T)});};},value:null},resultFilters:{validator:L,value:[]},resultFormatter:{validator:"_functionValidator"},resultHighlighter:{validator:"_functionValidator"},resultListLocator:{setter:"_setLocator"},results:{readOnly:true,value:[]},resultTextLocator:{setter:"_setLocator"},source:{setter:"_setSource"},value:{value:""}};Q.CSS_PREFIX="ac";Q.UI_SRC=(D.Widget&&D.Widget.UI_SRC)||"ui";Q.prototype={bindInput:function(){var S=this.get(E);if(!S){D.error("No inputNode specified.");}this.unbindInput();this._inputEvents=[S.on(M,this._onInputValueChange,this),this.after(M,this._afterValueChange,this)];},syncInput:function(){var S=this.get(E);if(S.get("nodeName").toLowerCase()==="input"){S.setAttribute("autocomplete",this.get("allowBrowserAutocomplete")?"on":"off");}this.set(I,S.get(I));},unbindInput:function(){while(this._inputEvents&&this._inputEvents.length){this._inputEvents.pop().detach();}},_createArraySource:function(S){return{sendRequest:function(T){var U=S.concat();T.callback.success({data:U,response:{results:U}});}};},_createJSONPSource:function(W){var T={},U=YUI.namespace("Env.AC"),V=this,S;return{sendRequest:function(Z){var Y,a=Z.request,X;if(T[a]){Z.callback.success(T[a]);return;}Y=D.guid();X=G.sub(W,{callback:"YUI.Env.AC."+Y,query:V.get("requestTemplate")?a:encodeURIComponent(a)});U[Y]=function(b){delete U[Y];S=null;T[a]={data:b,response:{results:b}};Z.callback.success(T[a]);};if(S){F.abort(S);}S=F.script(X,{autopurge:true});}};},_createObjectSource:function(S){return{sendRequest:function(T){var V=T.request,U=D.Object.owns(S,V)?S[V]:[];T.callback.success({data:U,response:{results:U}});}};},_functionValidator:function(S){return B(S)||S===null;},_getObjectValue:function(V,U){if(!V){return;}for(var T=0,S=U.length;V&&T<S;T++){V=V[U[T]];}return V;},_parseResponse:function(U,S,k){var Z={data:k,query:U,results:[]},T,X,g,Y=S&&S.results,a=[],V,c,j,d,e,b=this.get("resultListLocator"),f,h,W;if(Y&&b){Y=b(Y);}if(Y){V=this.get("resultFilters");c=this.get("resultFormatter");j=this.get("resultHighlighter");f=this.get("maxResults");h=this.get("resultTextLocator");if(h){X=K.map(Y,h);W=K.hash(X,Y);}else{X=Y;}for(d=0,e=V.length;d<e;++d){X=V[d](U,X);if(!X||!X.length){break;}}if(h){g=X;X=[];for(d=0,e=g.length;d<e;++d){X.push(W[g[d]]);}}else{g=[].concat(X);}T=j?j(U,g):[].concat(g);if(c){T=c(U,X,T,g);}e=f>0?Math.min(f,T.length):T.length;for(d=0;d<e;++d){a.push({display:T[d],raw:X[d],text:g[d]});}Z.results=a;}this.fire(J,Z);},_parseValue:function(S){var T=this.get(C);if(T){S=S.split(T);S=S[S.length-1];}return this._trimLeft(S);},_setSource:function(S){if((S&&B(S.sendRequest))||S===null){return S;}else{if(typeof S==="string"){return this._createJSONPSource(S);}else{if(L(S)){return this._createArraySource(S);}else{if(G.isObject(S)){return this._createObjectSource(S);}}}}return D.Attribute.INVALID_VALUE;},_setLocator:function(S){if(S===null||B(S)){return S;}S=S.toString().split(".");return D.bind(function(T){return T&&this._getObjectValue(T,S);},this);},_trimLeft:String.prototype.trimLeft?function(S){return S.trimLeft();}:function(S){return S.replace(/^\s+/,"");},_updateValue:function(T){var V=this.get(C),U,S,W;T=this._trimLeft(T);if(V){U=P(V);W=K.map(P(this.get(I)).split(V),P);S=W.length;if(S>1){W[S-1]=T;T=W.join(U+" ");}T=T+U+" ";}this.set(I,T);},_afterValueChange:function(X){var T,U,S=X.newVal,W,V;if(X.src!==Q.UI_SRC){this._inputNode.set(I,S);return;}W=this._parseValue(S);if(W&&W.length>=this.get("minQueryLength")){T=this.get("queryDelay");V=this;U=function(){V.fire(O,{inputValue:S,query:W});};if(T){clearTimeout(this._delay);this._delay=setTimeout(U,T);}else{U();}}else{clearTimeout(this._delay);this.fire(A);}},_onInputValueChange:function(T){var S=T.newVal;if(S===this.get(I)){return;}this.set(I,S,{src:Q.UI_SRC});},_onResponse:function(S,T){if(S&&S===this.get(R)){this._parseResponse(S,T.response,T.data);}},_defClearFn:function(){this._set(R,null);this._set(H,[]);},_defQueryFn:function(W){var U=W.query,S,V,T=this.get("source");this._set(R,U);if(U&&T){V=this.get("requestTemplate");S=V?V(U):U;T.sendRequest({request:S,callback:{success:D.bind(this._onResponse,this,U)}});}},_defResultsFn:function(S){this._set(H,S[H]);}};D.AutoCompleteBase=Q;},"@VERSION@",{requires:["array-extras","event-valuechange","node-base"]});YUI.add("autocomplete-list",function(B){var X=B.Node,L=B.Array,H=40,J=13,N=27,R=9,Q=38,U="_CLASS_ITEM",V="_CLASS_ITEM_ACTIVE",D="_CLASS_ITEM_HOVER",W="_SELECTOR_ITEM",F="activeItem",K="alwaysShowList",P="circular",T="hoveredItem",M="id",E="item",C="list",Z="result",I="results",S="visible",G="width",O="select",A=B.Base.create("autocompleteList",B.Widget,[B.AutoCompleteBase,B.WidgetPosition,B.WidgetPositionAlign,B.WidgetStack],{ITEM_TEMPLATE:"<li/>",LIST_TEMPLATE:"<ul/>",initializer:function(){this.publish(O,{defaultFn:this._defSelectFn});this._events=[];this._inputNode=this.get("inputNode");this[U]=this.getClassName(E);this[V]=this.getClassName(E,"active");this[D]=this.getClassName(E,"hover");this[W]="."+this[U];if(!this._inputNode){B.error("No inputNode specified.");}if(!this.get("align.node")){this.set("align.node",this._inputNode);}if(!this.get(G)){this.set(G,this._inputNode.get("offsetWidth"));
}},destructor:function(){this.unbindInput();while(this._events.length){this._events.pop().detach();}},bindUI:function(){this._bindInput();this._bindList();},renderUI:function(){var Y=this.get("contentBox"),a=this.get("listNode");if(!a){a=X.create(this.LIST_TEMPLATE);a.addClass(this.getClassName(C)).setAttrs({id:B.stamp(a),role:"listbox"});Y.append(a);}this._inputNode.addClass(this.getClassName("input")).setAttrs({"aria-autocomplete":C,"aria-live":"polite","aria-owns":a.get(M),role:"combobox"});if(this.get(K)){this.set(S,true);}this._contentBox=Y;this._listNode=a;},syncUI:function(){this.syncInput();this._syncResults();this._syncVisibility();},hide:function(){return this.get(K)?this:this.set(S,false);},selectItem:function(Y){if(Y){if(!Y.hasClass(this[U])){return;}}else{Y=this.get(F);if(!Y){return;}}this.fire(O,{itemNode:Y,result:Y.getData(Z)});return this;},show:function(){return this.set(S,true);},_activateNextItem:function(){var a=this.get(F),Y;Y=(a&&a.next(this[W]))||this.get(P)&&this._getFirstItemNode();if(Y){this._set(F,Y);}return this;},_activatePrevItem:function(){var a=this.get(F),Y;Y=(a&&a.previous(this[W]))||this.get(P)&&this._getLastItemNode();if(Y){this._set(F,Y);}return this;},_add:function(Y){var a=[];L.each(B.Lang.isArray(Y)?Y:[Y],function(b){a.push(this._createItemNode(b).setData(Z,b));},this);a=B.all(a);this._listNode.append(a.toFrag());return a;},_bindInput:function(){var Y=this._inputNode;this.bindInput();this._events.concat([Y.on("blur",this._onInputBlur,this),Y.on(B.UA.gecko?"keypress":"keydown",this._onInputKey,this)]);},_bindList:function(){this._events.concat([this.after("mouseover",this._afterMouseOver),this.after("mouseout",this._afterMouseOut),this.after("activeItemChange",this._afterActiveItemChange),this.after("alwaysShowListChange",this._afterAlwaysShowListChange),this.after("hoveredItemChange",this._afterHoveredItemChange),this.after("resultsChange",this._afterResultsChange),this.after("visibleChange",this._afterVisibleChange),this._listNode.delegate("click",this._onItemClick,this[W],this)]);},_clear:function(){this._set(F,null);this._set(T,null);this._listNode.get("children").remove(true);},_createItemNode:function(Y){var a=X.create(this.ITEM_TEMPLATE);return a.addClass(this[U]).setAttrs({id:B.stamp(a),role:"option"}).append(Y.display);},_getLastItemNode:function(){return this._listNode.one(this[W]+":last-child");},_getFirstItemNode:function(){return this._listNode.one(this[W]);},_syncResults:function(a){var Y;if(!a){a=this.get(I);}this._clear();if(a.length){Y=this._add(a);}if(this.get("activateFirstItem")&&!this.get(F)){this._set(F,this._getFirstItemNode());}},_syncVisibility:function(Y){if(typeof Y==="undefined"){Y=this.get(S);}this._contentBox.set("aria-hidden",!Y);if(!Y){this._set(F,null);this._set(T,null);}},_afterActiveItemChange:function(a){var Y=a.newVal,b=a.prevVal;if(b){b.removeClass(this[V]);}if(Y){Y.addClass(this[V]);this._inputNode.set("aria-activedescendant",Y.get(M));}},_afterAlwaysShowListChange:function(Y){this.set(S,Y.newVal||this.get(I).length>0);},_afterHoveredItemChange:function(a){var Y=a.newVal,b=a.prevVal;if(b){b.removeClass(this[D]);}if(Y){Y.addClass(this[D]);}},_afterMouseOver:function(Y){var a=Y.domEvent.target.ancestor(this[W],true);this._mouseOverList=true;if(a){this._set(T,a);}},_afterMouseOut:function(){this._mouseOverList=false;this._set(T,null);},_afterResultsChange:function(Y){this._syncResults(Y.newVal);if(!this.get(K)){this.set(S,!!Y.newVal.length);}},_afterVisibleChange:function(Y){this._syncVisibility(!!Y.newVal);},_onInputBlur:function(Y){if(this._mouseOverList&&this._lastInputKey!==R){this._inputNode.focus();}else{this.hide();}},_onInputKey:function(b){var Y,a=b.keyCode,c;this._lastInputKey=a;if(!this.get(I).length){return;}c=this.get(S);if(a===H){Y=1;if(!c){this.show();}this._activateNextItem();}if(c){switch(a){case J:Y=1;this.selectItem();break;case N:Y=1;this.hide();break;case R:if(this.get("tabSelect")){Y=1;this.selectItem();}break;case Q:Y=1;this._activatePrevItem();break;}}if(Y){b.preventDefault();}},_onItemClick:function(Y){var a=Y.currentTarget;Y.preventDefault();this._set(F,a);this.selectItem(a);},_defSelectFn:function(Y){this._inputNode.focus();this._updateValue(Y.result.text);this.hide();}},{ATTRS:{activateFirstItem:{value:false},activeItem:{readOnly:true,value:null},align:{value:{points:["tl","bl"]}},alwaysShowList:{value:false},circular:{value:true},hoveredItem:{readOnly:true,value:null},tabSelect:{value:true},visible:{value:false}},CSS_PREFIX:B.ClassNameManager.getClassName("aclist"),HTML_PARSER:{listNode:function(){return this.getClassName(C);}}});B.AutoCompleteList=A;B.AutoComplete=A;},"@VERSION@",{requires:["autocomplete-base","widget","widget-position","widget-position-align","widget-stack"],skinnable:true});YUI.add("autocomplete",function(A){},"@VERSION@",{use:["autocomplete-base","autocomplete-list"]});