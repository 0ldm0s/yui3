YUI.add("autocomplete-base",function(B){var L=B.Lang,C=L.isFunction,O=L.isNumber,G="allowBrowserAutocomplete",Q="dataSource",K="minQueryLength",F="query",D="queryDelay",J="requestTemplate",A="resultFilters",P="resultHighlighter",N="valueChange",I=F,H="results",M=N;function E(){this.publish(I,{defaultFn:this._defQueryFn,queueable:true});this.publish(H,{queueable:true});this.publish(M,{preventable:false});}E.ATTRS={allowBrowserAutocomplete:{validator:L.isBoolean,value:false,writeOnce:"initOnly"},dataSource:{validator:function(R){return(R&&C(R.sendRequest))||R===null;}},inputNode:{setter:B.one,writeOnce:"initOnly"},minQueryLength:{validator:O,value:1},query:{readOnly:true,value:null},queryDelay:{validator:function(R){return O(R)&&R>=0;},value:150},requestTemplate:{setter:function(R){if(C(R)){return R;}R=R.toString();return function(S){return R.replace(/(^|[^\\])((\\{2})*)\{query\}/,"$1$2"+encodeURIComponent(S)).replace(/(^|[^\\])((\\{2})*)\\(\{query\})/,"$1$2$4");};},value:encodeURIComponent},resultFilters:{validator:L.isArray,value:[]},resultHighlighter:{validator:function(R){return C(R)||R===null;}}};E.prototype={_bindInput:function(R){if(!R){B.error("No input node specified.");}if(R.get("nodeName").toLowerCase()==="input"){R.setAttribute("autocomplete",this.get(G)?"on":"off");}this._inputEvents=[R.on(N,this._onValueChange,this)];},_parseValue:function(R){return R;},_unbindInput:function(R){while(this._inputEvents.length){this._inputEvents.pop().detach();}},_onResponse:function(X){var V,S,U,R,W,T=X&&X.response&&X.response.results;if(T){W=X.callback.query;if(W===this.get(F)){V=this.get(A)||[];S=this.get(P);if(S){V=V.concat([S]);}for(U=0,R=V.length;U<R;++U){T=V[U](W,T);}this.fire(H,{data:X.data,query:W,results:T});}}},_onValueChange:function(W){var R,S,V=W.newVal,U=this._parseValue(V),T;this.fire(M,{newVal:V,prevVal:W.prevVal});if(U.length>=this.get(K)){R=this.get(D);T=this;S=function(){T.fire(I,{inputValue:V,query:U});};if(R){clearTimeout(this._delay);this._delay=setTimeout(S,R);}else{S();}}},_defQueryFn:function(S){var T=this.get(Q),R=S.query;this._set(F,R);if(T){T.sendRequest({request:this.get(J)(R),callback:{query:R,success:B.bind(this._onResponse,this)}});}}};B.AutoCompleteBase=E;},"@VERSION@",{requires:["base-base","event-valuechange","node-base"]});YUI.add("autocomplete",function(A){},"@VERSION@",{use:["autocomplete-base"]});