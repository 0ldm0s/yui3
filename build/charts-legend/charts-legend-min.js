YUI.add("charts-legend",function(a){var d=a.config.doc,o="top",h="right",f="bottom",j="left",q="external",s="horizontal",p="vertical",c="width",m="height",l="position",i="x",g="y",e="px",k={setter:function(u){var t=this.get("legend");if(t){t.destroy(true);}if(u instanceof a.ChartLegend){t=u;t.set("chart",this);}else{u.chart=this;if(!u.hasOwnProperty("render")){u.render=this.get("contentBox");u.includeInChartLayout=true;}t=new a.ChartLegend(u);t.after("legendRendered",a.bind(this._itemRendered,this));}return t;}},r={_positionLegendItems:function(I,R,L,u,V,F,C,y,O,E){var P=0,J=0,T,M,w,N,Q,K=this.get("width"),D,B,x,A,H,t=F.top-y,S=K-(F.left+F.right),v,G,U,z;r._setRowArrays(I,S,C);D=r.rowArray;A=r.totalWidthArray;B=D.length;for(;J<B;++J){t+=y;x=D[J];Q=x.length;H=r.getStartPoint(K,A[J],O,F);for(P=0;P<Q;++P){T=x[P];M=T.node;w=T.width;N=T.height;T.x=H;T.y=0;v=!isNaN(v)?Math.min(v,H):H;G=!isNaN(G)?Math.min(G,t):t;U=!isNaN(U)?Math.max(H+w,U):H+w;z=!isNaN(z)?Math.max(t+N,z):t+N;M.setStyle("left",H+e);M.setStyle("top",t+e);H+=w+C;}t+=T.height;}this._contentRect={left:v,top:G,right:U,bottom:z};if(this.get("includeInChartLayout")){this.set("height",t+F.bottom);}},_setRowArrays:function(z,t,B){var D=z[0],A=[[D]],v=1,u=0,x=z.length,w=D.width,y,C=[[w]];for(;v<x;++v){D=z[v];y=D.width;if((w+B+y)<=t){w+=B+y;A[u].push(D);}else{w=B+y;if(A[u]){u+=1;}A[u]=[D];}C[u]=w;}r.rowArray=A;r.totalWidthArray=C;},getStartPoint:function(u,t,y,x){var v;switch(y){case j:v=x.left;break;case"center":v=(u-t)*0.5;break;case h:v=u-t-x.right;break;}return v;}},n={_positionLegendItems:function(K,R,L,v,V,G,C,A,O,E){var P=0,D=0,T,M,N,z,Q,J=this.get("height"),t,w,u,F,y,W=G.left-C,I,S=J-(G.top+G.bottom),x,H,U,B;n._setColumnArrays(K,S,A);t=n.columnArray;F=n.totalHeightArray;w=t.length;for(;D<w;++D){W+=C;u=t[D];Q=u.length;y=n.getStartPoint(J,F[D],E,G);I=0;for(P=0;P<Q;++P){T=u[P];M=T.node;N=T.height;z=T.width;T.y=y;T.x=W;x=!isNaN(x)?Math.min(x,W):W;H=!isNaN(H)?Math.min(H,y):y;U=!isNaN(U)?Math.max(W+z,U):W+z;B=!isNaN(B)?Math.max(y+N,B):y+N;M.setStyle("left",W+e);M.setStyle("top",y+e);y+=N+A;I=Math.max(I,T.width);}W+=I;}this._contentRect={left:x,top:H,right:U,bottom:B};if(this.get("includeInChartLayout")){this.set("width",W+G.right);}},_setColumnArrays:function(A,v,x){var D=A[0],B=[[D]],w=1,t=0,y=A.length,z=D.height,u,C=[[z]];for(;w<y;++w){D=A[w];u=D.height;if((z+x+u)<=v){z+=x+u;B[t].push(D);}else{z=x+u;if(B[t]){t+=1;}B[t]=[D];}C[t]=z;}n.columnArray=B;n.totalHeightArray=C;},getStartPoint:function(u,t,x,w){var v;switch(x){case o:v=w.top;break;case"middle":v=(u-t)*0.5;break;case f:v=u-t-w.bottom;break;}return v;}};a.CartesianChartLegend=a.Base.create("cartesianChartLegend",a.CartesianChart,[],{_redraw:function(){if(this._drawing){this._callLater=true;return;}this._drawing=true;this._callLater=false;var J=this.get("width"),T=this.get("height"),B=this._getLayoutBoxDimensions(),R=B.left,A=B.right,X=B.top,u=B.bottom,t=this.get("leftAxesCollection"),H=this.get("rightAxesCollection"),I=this.get("topAxesCollection"),W=this.get("bottomAxesCollection"),S=0,P,C,y="visible",z=this.get("graph"),E,K,Q,O,F,G,V,U,N=this.get("allowContentOverflow"),L,v,Z,M,D,x=this.get("legend"),Y={};if(t){Z=[];P=t.length;for(S=P-1;S>-1;--S){Z.unshift(R);R+=t[S].get("width");}}if(H){v=[];P=H.length;S=0;for(S=P-1;S>-1;--S){A+=H[S].get("width");v.unshift(J-A);}}if(I){M=[];P=I.length;for(S=P-1;S>-1;--S){M.unshift(X);X+=I[S].get("height");}}if(W){D=[];P=W.length;for(S=P-1;S>-1;--S){u+=W[S].get("height");D.unshift(T-u);}}F=J-(R+A);G=T-(u+X);Y.left=R;Y.top=X;Y.bottom=T-u;Y.right=J-A;if(!N){E=this._getTopOverflow(t,H);K=this._getBottomOverflow(t,H);Q=this._getLeftOverflow(W,I);O=this._getRightOverflow(W,I);L=E-X;if(L>0){Y.top=E;if(M){S=0;P=M.length;for(;S<P;++S){M[S]+=L;}}}L=K-u;if(L>0){Y.bottom=T-K;if(D){S=0;P=D.length;for(;S<P;++S){D[S]-=L;}}}L=Q-R;if(L>0){Y.left=Q;if(Z){S=0;P=Z.length;for(;S<P;++S){Z[S]+=L;}}}L=O-A;if(L>0){Y.right=J-O;if(v){S=0;P=v.length;for(;S<P;++S){v[S]-=L;}}}}F=Y.right-Y.left;G=Y.bottom-Y.top;V=Y.left;U=Y.top;if(x){if(x.get("includeInChartLayout")){switch(x.get("position")){case"left":x.set("y",U);x.set("height",G);break;case"top":x.set("x",V);x.set("width",F);break;case"bottom":x.set("x",V);x.set("width",F);break;case"right":x.set("y",U);x.set("height",G);break;}}}if(I){P=I.length;S=0;for(;S<P;S++){C=I[S];if(C.get("width")!==F){C.set("width",F);}C.get("boundingBox").setStyle("left",V+e);C.get("boundingBox").setStyle("top",M[S]+e);}if(C._hasDataOverflow()){y="hidden";}}if(W){P=W.length;S=0;for(;S<P;S++){C=W[S];if(C.get("width")!==F){C.set("width",F);}C.get("boundingBox").setStyle("left",V+e);C.get("boundingBox").setStyle("top",D[S]+e);}if(C._hasDataOverflow()){y="hidden";}}if(t){P=t.length;S=0;for(;S<P;++S){C=t[S];C.get("boundingBox").setStyle("top",U+e);C.get("boundingBox").setStyle("left",Z[S]+e);if(C.get("height")!==G){C.set("height",G);}}if(C._hasDataOverflow()){y="hidden";}}if(H){P=H.length;S=0;for(;S<P;++S){C=H[S];C.get("boundingBox").setStyle("top",U+e);C.get("boundingBox").setStyle("left",v[S]+e);if(C.get("height")!==G){C.set("height",G);}}if(C._hasDataOverflow()){y="hidden";}}this._drawing=false;if(this._callLater){this._redraw();return;}if(z){z.get("boundingBox").setStyle("left",V+e);z.get("boundingBox").setStyle("top",U+e);z.set("width",F);z.set("height",G);z.get("boundingBox").setStyle("overflow",y);}if(this._overlay){this._overlay.setStyle("left",V+e);this._overlay.setStyle("top",U+e);this._overlay.setStyle("width",F+e);this._overlay.setStyle("height",G+e);}},_getLayoutBoxDimensions:function(){var u={top:0,right:0,bottom:0,left:0},A=this.get("legend"),x,z,t,C,B=this.get(c),v=this.get(m),y=A.get("styles").gap;if(A&&A.get("includeInChartLayout")){x=A.get(l);if(x!=q){z=A.get("direction");t=z==s?m:c;C=A.get(t);u[x]=C+y;switch(x){case o:A.set(g,0);break;case f:A.set(g,v-C);break;case h:A.set(i,B-C);break;case j:A.set(i,0);break;}}}return u;}},{ATTRS:{legend:k}});a.PieChartLegend=a.Base.create("pieChartLegend",a.PieChart,[],{_redraw:function(){if(this._drawing){this._callLater=true;
return;}this._drawing=true;this._callLater=false;var H=this.get("graph"),F=this.get("width"),u=this.get("height"),E=this.get("legend"),C=0,A=0,z=0,v=0,G,D,t,B;if(H){if(E){G=E.get("width");D=E.get("height");B=E.get("styles").gap;switch(E.get("position")){case j:G+=B;t=Math.min(F-G,u);D=t;C=G;break;case o:D+=B;t=Math.min(u-D,F);G=t;A=D;break;case h:G+=B;t=Math.min(F-G,u);D=t;z=t+B;break;case f:D+=B;t=Math.min(u-D,F);G=t;v=t+B;break;}}else{H.set(i,0);H.set(g,0);H.set(c,F);H.set(m,u);}}this._drawing=false;if(this._callLater){this._redraw();return;}if(H){H.set(i,C);H.set(g,A);H.set(c,t);H.set(m,t);E.set(i,z);E.set(g,v);E.set(c,G);E.set(m,D);}}},{ATTRS:{legend:k}});a.ChartLegend=a.Base.create("chartlegend",a.Widget,[a.Renderer],{initializer:function(){this._items=[];},renderUI:function(){var w=this.get("boundingBox"),t=this.get("contentBox"),v=this.get("styles").background,u=new a.Rect({graphic:t,fill:v.fill,stroke:v.stroke});w.setStyle("display","block");w.setStyle("position","absolute");this.set("background",u);},bindUI:function(){this.get("chart").after("seriesCollectionChange",this._updateHandler);this.after("stylesChange",this._updateHandler);this.after("positionChange",this._updateHandler);this.after("widthChange",this._handleSizeChange);this.after("heightChange",this._handleSizeChange);},syncUI:function(){var t=this.get("width"),u=this.get("height");if(isFinite(t)&&isFinite(u)&&t>0&&u>0){this._drawLegend();}},_updateHandler:function(t){if(this.get("rendered")){this._drawLegend();}},_handleSizeChange:function(v){var u=v.attrName,x=this.get(l),t=x==j||x==h,w=x==f||x==o;if((w&&u==c)||(t&&u==m)){this._drawLegend();}},_drawLegend:function(){if(this._drawing){this._callLater=true;return;}this._drawing=true;this._callLater=false;if(this.get("includeInChartLayout")){this.get("chart")._itemRenderQueue.unshift(this);}var L=this.get("chart"),P=this.get("contentBox"),C=L.get("seriesCollection"),H,F=this.get("styles"),K=F.padding,v,G=F.horizontalGap,A=F.verticalGap,S=F.hAlign,J=F.vAlign,B=F.marker,z=F.label,y,aa=this._layout[this.get("direction")],V,W,I,u,E,Z,U,D,t,R,X,M=[],T=B.width,O=B.height,w=0-G,ab=0-A,Y=0,N=0,x,Q;if(B&&B.shape){u=B.shape;}this._destroyLegendItems();if(L instanceof a.PieChart){H=C[0];y=H.get("categoryAxis").getDataByKey(H.get("categoryKey"));v=H.get("styles").marker;t=v.fill.colors;R=v.border.colors;X=v.border.weight;V=0;W=y.length;u=u||a.Circle;I=a.Lang.isArray(u);for(;V<W;++V){u=I?u[V]:u;U={color:t[V]};D={colors:R[V],weight:X};y=L.getSeriesItems(H,V).category.value;Z=this.getLegendItem(P,this._getShapeClass(u),U,D,z,T,O,y);x=Z.width;Q=Z.height;Y=Math.max(Y,x);N=Math.max(N,Q);w+=x+G;ab+=Q+A;M.push(Z);}}else{V=0;W=C.length;for(;V<W;++V){H=C[V];v=this._getStylesBySeriesType(H,u);if(!u){u=v.shape;if(!u){u=a.Circle;}}E=a.Lang.isArray(u)?u[V]:u;Z=this.getLegendItem(P,this._getShapeClass(u),v.fill,v.stroke,z,T,O,H.get("valueDisplayName"));x=Z.width;Q=Z.height;Y=Math.max(Y,x);N=Math.max(N,Q);w+=x+G;ab+=Q+A;M.push(Z);}}this.set("items",M);this._drawing=false;if(this._callLater){this._drawLegend();}else{aa._positionLegendItems.apply(this,[M,Y,N,w,ab,K,G,A,S,J]);this._updateBackground(F);this.fire("legendRendered");}},_updateBackground:function(A){var B=A.background,u=this._contentRect,C=A.padding,t=u.left-C.left,D=u.top-C.top,v=u.right-t+C.right,z=u.bottom-D+C.bottom;this.get("background").set({fill:B.fill,stroke:B.stroke,width:v,height:z,x:t,y:D});},_getStylesBySeriesType:function(t){var u=t.get("styles");if(t instanceof a.LineSeries||t instanceof a.StackedLineSeries){u=t.get("styles").line;return{stroke:{weight:1,color:u.color},fill:{color:u.color}};}else{if(t instanceof a.AreaSeries||t instanceof a.StackedAreaSeries){t=t.get("styles").fill;return{stroke:{weight:1,color:u.color},fill:{color:u.color}};}else{u=t.get("styles").marker;return{fill:u.fill,stroke:{weight:u.border.weight,color:u.border.color,shape:u.shape},shape:u.shape};}}},getLegendItem:function(u,B,H,I,C,E,z,F){var x=a.one(d.createElement("div")),v=a.one(d.createElement("span")),A,y,D,t,G;x.setStyle(l,"absolute");v.setStyle(l,"absolute");v.setStyles(C);v.appendChild(d.createTextNode(F));x.appendChild(v);u.appendChild(x);y=v.get("offsetHeight");D=y-z;t=E+D;v.setStyle("left",t+e);x.setStyle("height",y+e);x.setStyle("width",(t+v.get("offsetWidth"))+e);A=new B({fill:H,stroke:I,width:E,height:z,x:D*0.5,y:D*0.5,w:E,h:z,graphic:x});v.setStyle("left",y+e);G={node:x,width:x.get("offsetWidth"),height:x.get("offsetHeight"),shape:A,textNode:v,text:F};this._items.push(G);return G;},_getShapeClass:function(){var t=this.get("background").get("graphic");return t._getShapeClass.apply(t,arguments);},_getDefaultStyles:function(){var t={padding:{top:5,right:5,bottom:5,left:5},gap:5,horizontalGap:4,verticalGap:4,hAlign:"center",vAlign:"middle",marker:this._getPlotDefaults(),label:{color:"#808080",alpha:1,fontSize:"85%"},background:{shape:"rect",fill:{color:"#faf9f2"},stroke:{color:"#dad8c9",weight:1}}};return t;},_getPlotDefaults:function(){var t={width:10,height:10};return t;},_destroyLegendItems:function(){var t;if(this._items){while(this._items.length>0){t=this._items.shift();t.shape.get("graphic").destroy();t.node.empty();t.node.remove(true);t=null;}}this._items=[];},_layout:{vertical:n,horizontal:r},destructor:function(){var t=this.get("graphic");this._destroyLegendItems();if(t){t.destroy();}}},{ATTRS:{includeInChartLayout:{value:false},chart:{},seriesCollection:{},direction:{value:"vertical"},position:{lazyAdd:false,value:"right",setter:function(t){if(t==o||t==f){this.set("direction",s);}else{if(t==j||t==h){this.set("direction",p);}}return t;}},width:{getter:function(){var u=this.get("chart"),t=this._parentNode;if(t&&((u&&this.get("includeInChartLayout"))||this._width)){if(!this._width){this._width=0;}return this._width;}else{return t.get("offsetWidth");}},setter:function(t){this._width=t;return t;}},height:{getter:function(){var u=this.get("chart"),t=this._parentNode;if(t&&((u&&this.get("includeInChartLayout"))||this._height)){if(!this._height){this._height=0;
}return this._height;}else{return t.get("offsetHeight");}},setter:function(t){this._height=t;return t;}},x:{lazyAdd:false,value:0,setter:function(u){var t=this.get("boundingBox");if(t){t.setStyle(j,u+e);}return u;}},y:{lazyAdd:false,value:0,setter:function(u){var t=this.get("boundingBox");if(t){t.setStyle(o,u+e);}return u;}},background:{}}});function b(t){if(t.type!="pie"){return new a.CartesianChartLegend(t);}else{return new a.PieChartLegend(t);}}a.Chart=b;},"@VERSION@",{requires:["charts-base"]});