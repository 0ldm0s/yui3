YUI.add("console",function(D){var G=D.ClassNameManager.getClassName,B="checked",r="clear",q="click",T="collapsed",AD="console",d="contentBox",h="disabled",n="entry",H="entryTemplate",k="error",P="info",x="innerHTML",N="lastTime",F="pause",f="paused",w="reset",u="startTime",o="title",i="warn",Z=".",X=G(AD,"button"),b=G(AD,"checkbox"),AC=G(AD,r),v=G(AD,"collapse"),S=G(AD,T),E=G(AD,"controls"),e=G(AD,"hd"),c=G(AD,"bd"),C=G(AD,"ft"),j=G(AD,o),y=G(AD,n),s=G(AD,n,"cat"),a=G(AD,n,"content"),U=G(AD,n,"meta"),g=G(AD,n,"src"),A=G(AD,n,"time"),Q=G(AD,F),W=G(AD,F,"label"),m=/^(\S+)\s/,z=/&/g,t=/>/g,K=/</g,I="&#38;",R="&#62;",l="&#60;",J=D.Lang,M=D.Node.create,AB=J.isNumber,O=J.isString,p=D.merge,AA=D.substitute;function V(){V.superclass.constructor.apply(this,arguments);}D.mix(V,{NAME:AD,LOG_LEVEL_INFO:30,LOG_LEVEL_WARN:20,LOG_LEVEL_ERROR:10,ENTRY_CLASSES:{entry_class:y,entry_meta_class:U,entry_cat_class:s,entry_src_class:g,entry_time_class:A,entry_content_class:a},CHROME_CLASSES:{console_hd_class:e,console_bd_class:c,console_ft_class:C,console_controls_class:E,console_checkbox_class:b,console_pause_class:Q,console_pause_label_class:W,console_button_class:X,console_clear_class:AC,console_collapse_class:v,console_title_class:j},HEADER_TEMPLATE:'<div class="{console_hd_class}">'+'<h4 class="{console_title_class}">{str_title}</h4>'+'<div class="{console_controls_class}">'+'<button type="button" class="'+'{console_button_class} {console_collapse_class}">{str_collapse}'+"</button>"+"</div>"+"</div>",BODY_TEMPLATE:'<div class="{console_bd_class}"></div>',FOOTER_TEMPLATE:'<div class="{console_ft_class}">'+'<div class="{console_controls_class}">'+'<input type="checkbox" class="{console_checkbox_class} '+'{console_pause_class}" value="1" id="{id_guid}"> '+'<label for="{id_guid}" class="{console_pause_label_class}">'+"{str_pause}</label>"+'<button type="button" class="'+'{console_button_class} {console_clear_class}">{str_clear}'+"</button>"+"</div>"+"</div>",ENTRY_TEMPLATE:'<pre class="{entry_class} {cat_class} {src_class}">'+'<div class="{entry_meta_class}">'+"<p>"+'<span class="{entry_cat_class}">'+"{label}</span>"+'<span class="{entry_time_class}">'+" {totalTime}ms (+{elapsedTime}) {localTime}:"+"</span>"+"</p>"+'<p class="{entry_src_class}">'+"{sourceAndDetail}"+"</p>"+"</div>"+'<p class="{entry_content_class}">{message}</p>'+"</pre>",ATTRS:{logEvent:{value:"yui:log",writeOnce:true,validator:O},strings:{value:{title:"Log Console",pause:"Pause",clear:"Clear",collapse:"Collapse",expand:"Expand"}},paused:{value:false,validator:J.isBoolean},defaultCategory:{value:P,validator:O},defaultSource:{value:"global",validator:O},entryTemplate:{value:"",validator:O},logLevel:{value:D.config.logLevel||30,validator:function(L){return this._validateNewLogLevel(L);},setter:function(L){return this._setLogLevel(L);}},printTimeout:{value:100,validator:AB},consoleLimit:{value:500,validator:AB},newestOnTop:{value:true},scrollIntoView:{value:true},startTime:{value:new Date()},lastTime:{value:new Date(),readOnly:true},collapsed:{value:false}},_logLevels:{}});V._logLevels[P]=V.LOG_LEVEL_INFO;V._logLevels[i]=V.LOG_LEVEL_WARN;V._logLevels[k]=V.LOG_LEVEL_ERROR;V._logLevels[V.LOG_LEVEL_INFO]=V.LOG_LEVEL_INFO;V._logLevels[V.LOG_LEVEL_WARN]=V.LOG_LEVEL_WARN;V._logLevels[V.LOG_LEVEL_ERROR]=V.LOG_LEVEL_ERROR;D.extend(V,D.Widget,{_head:null,_body:null,_foot:null,_timeout:null,buffer:null,log:function(){return D.log.apply(D,arguments);},clearConsole:function(){this._body.set(x,"");this._clearTimeout();this.buffer=[];return this;},reset:function(){this.fire(w);return this;},collapse:function(){this.set(T,true);},expand:function(){this.set(T,false);},printBuffer:function(){var AF=this.buffer,Y=D.config.debug,AE,L;D.config.debug=false;if(!this.get(f)&&this.get("rendered")){this._clearTimeout();this.buffer=[];for(AE=0,L=AF.length;AE<L;++AE){this.printLogEntry(AF[AE]);}if(this.get("scrollIntoView")){this.scrollToLatest();}this._trimOldEntries();}D.config.debug=Y;return this;},printLogEntry:function(L){L=p(this._htmlEscapeMessage(L),V.ENTRY_CLASSES,{cat_class:this.getClassName(n,L.category),src_class:this.getClassName(n,L.source)});var Y=M(AA(this.get("entryTemplate"),L));this._addToConsole(Y);return this;},initializer:function(){this.buffer=[];if(!this.get(H)){this.set(H,V.ENTRY_TEMPLATE);}D.on(this.get("logEvent"),D.bind(this._onLogEvent,this));this.publish(n,{defaultFn:this._defEntryFn});this.publish(w,{defaultFn:this._defResetFn});},renderUI:function(){this._initHead();this._initConsole();this._initFoot();},syncUI:function(){this.set(f,this.get(f));this.set(T,this.get(T));},bindUI:function(){this.get(d).query("button."+v).on(q,this._onCollapseClick,this);this.get(d).query("input[type=checkbox]."+Q).on(q,this._onPauseClick,this);this.get(d).query("button."+AC).on(q,this._onClearClick,this);this.after("stringsChange",this._afterStringsChange);this.after("pausedChange",this._afterPausedChange);this.after("consoleLimitChange",this._afterConsoleLimitChange);this.after("collapsedChange",this._afterCollapsedChange);},_initHead:function(){var L=this.get(d),Y=p(V.CHROME_CLASSES,{str_collapse:this.get("strings.collapse"),str_title:this.get("strings.title")});this._head=M(AA(V.HEADER_TEMPLATE,Y));L.insertBefore(this._head,L.get("firstChild"));},_initConsole:function(){this._body=M(AA(V.BODY_TEMPLATE,V.CHROME_CLASSES));this.get(d).appendChild(this._body);},_initFoot:function(){var L=p(V.CHROME_CLASSES,{id_guid:D.guid(),str_pause:this.get("strings.pause"),str_clear:this.get("strings.clear")});this._foot=M(AA(V.FOOTER_TEMPLATE,L));this.get(d).appendChild(this._foot);},_isInLogLevel:function(AF,L){var Y=this.get("logLevel"),AE=L===k?V.LOG_LEVEL_ERROR:L===i?V.LOG_LEVEL_WARN:V.LOG_LEVEL_INFO;return Y>=AE;},_normalizeMessage:function(AF,Y,AE){var L={time:new Date(),message:AF,category:Y||this.get("defaultCategory"),sourceAndDetail:AE||this.get("defaultSource"),source:null,label:null,localTime:null,elapsedTime:null,totalTime:null};L.source=m.test(L.sourceAndDetail)?RegExp.$1:L.sourceAndDetail;
L.label=L.category;L.localTime=L.time.toLocaleTimeString?L.time.toLocaleTimeString():(L.time+"");L.elapsedTime=L.time-this.get(N);L.totalTime=L.time-this.get(u);this._set(N,L.time);return L;},_schedulePrint:function(){if(!this.get(f)&&!this._timeout){this._timeout=D.later(this.get("printTimeout"),this,this.printBuffer);}},_addToConsole:function(Y){var L=this.get("newestOnTop")?this._body.get("firstChild"):null;this._body.insertBefore(Y,L);},scrollToLatest:function(){var L=this.get("newestOnTop")?0:this._body.get("scrollHeight");this._body.set("scrollTop",L);},_htmlEscapeMessage:function(L){L=D.clone(L);L.message=this._encodeHTML(L.message);L.label=this._encodeHTML(L.label);L.source=this._encodeHTML(L.source);L.sourceAndDetail=this._encodeHTML(L.sourceAndDetail);L.category=this._encodeHTML(L.category);return L;},_trimOldEntries:function(){var AH=this._body,AE=this.get("consoleLimit"),AF=D.config.debug,L,AI,AG,Y;if(AH){D.config.debug=false;L=AH.queryAll(Z+y);Y=L?L.size()-AE:0;if(Y){if(this.get("newestOnTop")){AG=AE;Y=L.size();}else{AG=0;}for(;AG<Y;++AG){AI=L.item(AG);if(AI){AI.get("parentNode").removeChild(AI);}}}D.config.debug=AF;}},_encodeHTML:function(L){return O(L)?L.replace(z,I).replace(K,l).replace(t,R):L;},_clearTimeout:function(){if(this._timeout){this._timeout.cancel();this._timeout=null;}},_onPauseClick:function(L){this.set(f,L.target.get(B));},_onClearClick:function(L){this.clearConsole();},_onCollapseClick:function(L){this.set(T,!this.get(T));},_setLogLevel:function(L){return V._logLevels[(L+"").toLowerCase()];},_validateNewLogLevel:function(L){return(L+"").toLowerCase() in V._logLevels;},_afterStringsChange:function(AF){var AH=AF.subAttrName?AF.subAttrName.split(Z)[1]:null,L=this.get(d),AE=AF.prevVal,AG=AF.newVal,Y;if((!AH||AH===o)&&AE.title!==AG.title){Y=L.query(Z+j);if(Y){Y.set(x,AG.title);}}if((!AH||AH===F)&&AE.pause!==AG.pause){Y=L.query(Z+W);if(Y){Y.set(x,AG.pause);}}if((!AH||AH===r)&&AE.clear!==AG.clear){Y=L.query(Z+AC);if(Y){Y.set("value",AG.clear);}}},_afterPausedChange:function(AE){var L=AE.newVal,Y;if(AE.src!==D.Widget.SRC_UI){Y=this._foot.queryAll("input[type=checkbox]."+Q);if(Y){Y.set(B,L);}}if(!L){this._schedulePrint();}else{if(this._timeout){this._clearTimeout();}}},_afterConsoleLimitChange:function(){this._trimOldEntries();},_afterCollapsedChange:function(AE){var L=this.get(d),Y=L.queryAll("button."+v),AG=AE.newVal?"addClass":"removeClass",AF=this.get("strings."+(AE.newVal?"expand":"collapse"));L[AG](S);if(Y){Y.set("innerHTML",AF);}},_onLogEvent:function(AF,L,AE){if(!this.get(h)&&this._isInLogLevel(AF,L,AE)){var Y=D.config.debug;D.config.debug=false;this.fire(n,{message:this._normalizeMessage.apply(this,arguments)});D.config.debug=Y;}},_defResetFn:function(){this.clearConsole();this.set(u,new Date());this.set(h,false);this.set(f,false);},_defEntryFn:function(L){if(L.message){this.buffer.push(L.message);this._schedulePrint();}}});D.Console=V;},"@VERSION@",{requires:["substitute","widget"]});