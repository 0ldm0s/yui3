YUI.add("datatable-core",function(a,l){var d=a.Attribute.INVALID_VALUE,f=a.Lang,c=f.isFunction,k=f.isObject,g=f.isArray,b=f.isString,j=f.isNumber,e=a.Array,i=a.Object.keys,h;h=a.namespace("DataTable").Core=function(){};h.ATTRS={columns:{validator:g,setter:"_setColumns",getter:"_getColumns"},recordType:{getter:"_getRecordType",setter:"_setRecordType"},data:{valueFn:"_initData",setter:"_setData",lazyAdd:false},recordset:{setter:"_setRecordset",getter:"_getRecordset",lazyAdd:false},columnset:{setter:"_setColumnset",getter:"_getColumnset",lazyAdd:false}};a.mix(h.prototype,{getColumn:function(o){var n,q,p,m,r;if(k(o)&&!g(o)){n=o;}else{n=this.get("columns."+o);}if(n){return n;}q=this.get("columns");if(j(o)||g(o)){o=e(o);r=q;for(p=0,m=o.length-1;r&&p<m;++p){r=r[o[p]]&&r[o[p]].children;}return(r&&r[o[p]])||null;}return null;},getRecord:function(n){var m=this.data.getById(n)||this.data.getByClientId(n);if(!m){if(j(n)){m=this.data.item(n);}if(!m&&this.view&&this.view.getRecord){m=this.view.getRecord.apply(this.view,arguments);}}return m||null;},_allowAdHocAttrs:true,_afterColumnsChange:function(m){this._setColumnMap(m.newVal);},_afterDataChange:function(n){var m=n.newVal;this.data=n.newVal;if(!this.get("columns")&&m.size()){this._initColumns();}},_afterRecordTypeChange:function(n){var m=this.data.toJSON();this.data.model=n.newVal;this.data.reset(m);if(!this.get("columns")&&m){if(m.length){this._initColumns();}else{this.set("columns",i(n.newVal.ATTRS));}}},_createRecordClass:function(o){var n,p,m;if(g(o)){n={};for(p=0,m=o.length;p<m;++p){n[o[p]]={};}}else{if(k(o)){n=o;}}return a.Base.create("record",a.Model,[],null,{ATTRS:n});},destructor:function(){new a.EventHandle(a.Object.values(this._eventHandles)).detach();},_getColumns:function(n,m){return m.length>8?this._columnMap:n;},_getColumnset:function(n,m){return this.get(m.replace(/^columnset/,"columns"));},_getRecordType:function(m){return m||(this.data&&this.data.model);},_initColumns:function(){var m=this.get("columns")||[],n;if(!m.length&&this.data.size()){n=this.data.item(0);if(n.toJSON){n=n.toJSON();}this.set("columns",i(n));}this._setColumnMap(m);},_initCoreEvents:function(){this._eventHandles.coreAttrChanges=this.after({columnsChange:a.bind("_afterColumnsChange",this),recordTypeChange:a.bind("_afterRecordTypeChange",this),dataChange:a.bind("_afterDataChange",this)});},_initData:function(){var n=this.get("recordType"),m=new a.ModelList();if(n){m.model=n;}return m;},_initDataProperty:function(m){var n;if(!this.data){n=this.get("recordType");if(m&&m.each&&m.toJSON){this.data=m;if(n){this.data.model=n;}}else{this.data=new a.ModelList();if(n){this.data.model=n;}}this.data.addTarget(this);}},initializer:function(m){var o=m.data,n=m.columns,p;this._initDataProperty(o);if(!n){p=(m.recordType||m.data===this.data)&&this.get("recordType");if(p){n=i(p.ATTRS);}else{if(g(o)&&o.length){n=i(o[0]);}}if(n){this.set("columns",n);}}this._initColumns();this._eventHandles={};this._initCoreEvents();},_setColumnMap:function(m){var o={};function n(t){var s,p,q,r;for(s=0,p=t.length;s<p;++s){q=t[s];r=q.key;if(r&&!o[r]){o[r]=q;}o[q._id]=q;if(q.children){n(q.children);}}}n(m);this._columnMap=o;},_setColumns:function(t){var q={},p=[],o=[],n=a.Array.indexOf;function m(x){var y={},v,w,u;p.push(x);o.push(y);for(v in x){if(x.hasOwnProperty(v)){w=x[v];if(g(w)){y[v]=w.slice();}else{if(k(w,true)){u=n(w,p);y[v]=u===-1?m(w):o[u];}else{y[v]=x[v];}}}}return y;}function s(u){u=u.replace(/\s+/,"-");if(q[u]){u+=(q[u]++);}else{q[u]=1;}return u;}function r(A,z){var y=[],x,u,v,w;for(x=0,u=A.length;x<u;++x){y[x]=v=b(A[x])?{key:A[x]}:m(A[x]);w=a.stamp(v);if(!v.id){v.id=w;}if(v.field){v.name=v.field;}if(z){v._parent=z;}else{delete v._parent;}v._id=s(v.name||v.key||v.id);if(g(v.children)){v.children=r(v.children,v);}}return y;}return t&&r(t);},_setColumnset:function(m){this.set("columns",m);return g(m)?m:d;},_setData:function(m){if(m===null){m=[];}if(g(m)){this._initDataProperty();this.data.reset(m,{silent:true});m=this.data;}else{if(!m||!m.each||!m.toJSON){m=d;}}return m;},_setRecordset:function(n){var m;if(n&&a.Recordset&&n instanceof a.Recordset){m=[];n.each(function(o){m.push(o.get("data"));});n=m;}this.set("data",n);return n;},_setRecordType:function(n){var m;if(c(n)&&n.prototype.toJSON&&n.prototype.setAttrs){m=n;}else{if(k(n)){m=this._createRecordClass(n);}}return m||d;}});},"@VERSION@",{"requires":["escape","model-list","node-event-delegate"]});