YUI.add("dd-ddm-drop",function(A){A.mix(A.DD.DDM,{_activeShims:[],_hasActiveShim:function(){return((this._activeShims.length)?true:false);},_addActiveShim:function(C){var B=true;A.each(this._activeShims,function(E,D){if(E._yuid===C._yuid){B=false;}});if(B){this._activeShims[this._activeShims.length]=C;}},_removeActiveShim:function(C){var B=[];A.each(this._activeShims,function(E,D){if(E._yuid!==C._yuid){B[B.length]=E;}});this._activeShims=B;},syncActiveShims:function(){var B=this._lookup();A.each(B,function(D,C){D.sizeShim.call(D);},this);return B;},_oldMode:0,mode:0,POINT:0,INTERSECT:1,STRICT:2,useHash:true,activeDrop:null,validDrops:[],otherDrops:{},tars:[],addValid:function(B){this.validDrops[this.validDrops.length]=B;return this;},isOverTarget:function(B){if(A.Lang.isObject(this.activeDrag)&&B){var C=this.activeDrag.mouseXY;if(C){if(this.mode==this.STRICT){return this.activeDrag.get("dragNode").inRegion(B.region,true,this.activeDrag.region);}else{return B.shim.intersect({top:C[1],bottom:C[1],left:C[0],right:C[0]},B.region).inRegion;}}else{return false;}}else{return false;}},clearCache:function(){this.validDrops=[];this.otherDrops={};this._activeShims=[];},_setMode:function(){this._oldMode=this.mode;if(this.activeDrag&&(this.activeDrag.get("dragMode")!==-1)){this.mode=this.activeDrag.get("dragMode");}},_resetMode:function(){this.mode=this._oldMode;},_activateTargets:function(){this._setMode();this.clearCache();A.each(this.tars,function(C,B){C._activateShim.apply(C,[]);},this);this._handleTargetOver();},getBestMatch:function(F,D){var C=null,E=0;A.each(F,function(I,H){var G=this.activeDrag.get("dragNode").intersect(I.get("node"));I.region.area=G.area;if(G.inRegion){if(G.area>E){E=G.area;C=I;}}},this);if(D){var B=[];A.each(F,function(H,G){if(H!==C){B[B.length]=H;}},this);return[C,B];}else{return C;}},_deactivateTargets:function(){var B=[];if(this.activeDrag&&!A.Lang.isNull(this.activeDrop)&&this.otherDrops[this.activeDrop]){if(!this.mode){B=this.otherDrops;delete B[this.activeDrop];}else{var C=this.getBestMatch(this.otherDrops,true);this.activeDrop=C[0];B=C[1];}this.activeDrop.fire("drop:hit",{drag:this.activeDrag,drop:this.activeDrop,others:B});this.activeDrag.fire("drag:drophit",{drag:this.activeDrag,drop:this.activeDrop,others:B});}else{if(this.activeDrag){this.activeDrag.fire("drag:dropmiss");}else{}}this.activeDrop=null;A.each(this.tars,function(E,D){E._deactivateShim.apply(E,[]);},this);this._resetMode();},_dropMove:function(B){if(this._hasActiveShim()){this._handleTargetOver();}else{A.each(this.otherDrops,function(D,C){D._handleOut.apply(D,[]);});}},_lookup:function(){if(!this.useHash){return this.validDrops;}var B=[];A.each(this.validDrops,function(D,C){if(D.shim.inViewportRegion(false,D.region)){B[B.length]=D;}});return B;},_handleTargetOver:function(){var B=this._lookup();A.each(B,function(D,C){D._handleTargetOver.call(D);},this);},regTarget:function(B){this.tars[this.tars.length]=B;},unregTarget:function(C){var B=[];A.each(this.tars,function(E,D){if(E!=C){B[B.length]=E;}},this);this.tars=B;},rnd:function(B){return(Math.round(B/100)*100);},getDrop:function(C){var B=false,D=A.Node.get(C);if(D instanceof A.Node){A.each(this.tars,function(F,E){if(D.compareTo(F.get("node"))){B=F;}});}return B;}},true);},"@VERSION@",{requires:["dd-ddm"],skinnable:false});YUI.add("dd-drop",function(A){var B="node",G=A.DD.DDM,F="offsetHeight",C="offsetWidth",I="drop:over",H="drop:enter",D="drop:exit";var E=function(){E.superclass.constructor.apply(this,arguments);this._createShim();G.regTarget(this);};E.NAME="drop";E.ATTRS={node:{set:function(J){return A.Node.get(J);}},groups:{value:["default"],set:function(J){this._groups={};A.each(J,function(L,K){this._groups[L]=true;},this);}},padding:{value:"0",set:function(J){return G.cssSizestoObject(J);}},lock:{value:false,set:function(J){if(J){this.get(B).addClass("yui-dd-drop-locked");}else{this.get(B).removeClass("yui-dd-drop-locked");}}}};A.extend(E,A.Base,{_createEvents:function(){var J=[I,H,D,"drop:hit"];A.each(J,function(L,K){this.publish(L,{emitFacade:true,preventable:false,bubbles:true});},this);this.addTarget(G);},_active:null,_valid:null,_groups:null,shim:null,region:null,overTarget:null,inGroup:function(J){this._valid=false;var K=false;A.each(J,function(M,L){if(this._groups[M]){K=true;this._valid=true;}},this);return K;},initializer:function(){this._createEvents();},_deactivateShim:function(){this.get(B).removeClass("dd-drop-active-valid");this.get(B).removeClass("dd-drop-active-invalid");this.get(B).removeClass("dd-drop-over");this.shim.setXY([-999,-999]);this._active=false;this.overTarget=false;},_activateShim:function(){if(this.get(B)===G.activeDrag.get(B)){return false;}if(this.get("lock")){return false;}if(this.inGroup(G.activeDrag.get("groups"))){this.get(B).addClass("dd-drop-active-valid");G.addValid(this);this._active=false;this.overTarget=false;this.sizeShim();}else{this.get(B).addClass("dd-drop-active-invalid");}},sizeShim:function(){var M=this.get(B).get(F),K=this.get(B).get(C),P=this.get(B).getXY(),O=this.get("padding");K=K+O.left+O.right;M=M+O.top+O.bottom;P[0]=P[0]-O.left;P[1]=P[1]-O.top;if(G.mode===G.INTERSECT){var J=G.activeDrag,N=J.get(B).get(F),L=J.get(B).get(C);M=(M+N);K=(K+L);P[0]=P[0]-(N-J.deltaXY[0]);P[1]=P[1]-(L-J.deltaXY[1]);}this.shim.setStyles({height:M+"px",width:K+"px",top:P[1]+"px",left:P[0]+"px"});this.region={"0":P[0],"1":P[1],area:0,top:P[1],right:P[0]+K,bottom:P[1]+M,left:P[0]};},_createShim:function(){var J=A.Node.create(["div",{id:this.get(B).get("id")+"_shim"}]);J.setStyles({height:this.get(B).get(F)+"px",width:this.get(B).get(C)+"px",backgroundColor:"yellow",opacity:".5",zIndex:10,position:"absolute"});G._pg.appendChild(J);J.setXY([-900,-900]);this.shim=J;J.on("mouseover",this._handleOverEvent,this,true);J.on("mouseout",this._handleOutEvent,this,true);},_handleTargetOver:function(J){if(G.isOverTarget(this)){this.get(B).addClass("dd-drop-over");G.activeDrop=this;G.otherDrops[this]=this;if(this.overTarget){this.fire(I,{drop:this,drag:G.activeDrag});
G.activeDrag.fire("drag:over",{drop:this,drag:G.activeDrag});}else{this.overTarget=true;this.fire(H,{drop:this,drag:G.activeDrag});G.activeDrag.fire("drag:enter",{drop:this,drag:G.activeDrag});G._handleTargetOver(this,J);}}else{this._handleOut();}},_handleOverEvent:function(){G._addActiveShim(this);},_handleOutEvent:function(){G._removeActiveShim(this);},_handleOut:function(){if(!G.isOverTarget(this)){if(this.overTarget){this.overTarget=false;G._removeActiveShim(this);if(G.activeDrag){this.get(B).removeClass("dd-drop-over");this.fire(D);G.activeDrag.fire("drag:exit",{drop:this});delete G.otherDrops[this];}}}}});A.DD.Drop=E;},"@VERSION@",{requires:["dd-ddm-drop"],skinnable:false});YUI.add("dd-drop-core",function(A){},"@VERSION@",{skinnable:false,use:["dd-ddm-drop","dd-drop"]});