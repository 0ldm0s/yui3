YUI.add("slider",function(C){var E="slider",Q="rail",P="thumb",G="value",f="min",h="max",D="thumbImage",j="railSize",H="slideStart",J="slideEnd",X="thumbDrag",c="sync",Z="valueSet",A="rendered",g="disabled",I="disabledChange",b=".",N="px",F="width",a="height",l="image-error",O=C.Lang,S=O.isArray,R=O.isBoolean,T=O.isString,U=O.isNumber,k=C.ClassNameManager,K=Math,d=K.max,i=K.round,e=K.floor,B=K.ceil,V=K.abs;function W(){W.superclass.constructor.apply(this,arguments);}C.mix(W,{NAME:E,AXIS_KEYS:{x:{offsetEdge:"left",dim:F,offAxisDim:a,eventPageAxis:"pageX",ddStick:"stickX",xyIndex:0},y:{offsetEdge:"top",dim:a,offAxisDim:F,eventPageAxis:"pageY",ddStick:"stickY",xyIndex:1}},HTML_PARSER:{rail:b+k.getClassName(E,Q),thumb:b+k.getClassName(E,P),thumbImage:b+k.getClassName(E,"thumb-image")},ATTRS:{axis:{value:"x",writeOnce:true,validator:function(L){return this._validateNewAxis(L);},set:function(L){return this._setAxisFn(L);}},min:{value:0,validator:function(L){return this._validateNewMin(L);}},max:{value:100,validator:function(L){return this._validateNewMax(L);}},value:{value:null,validator:function(L){return this._validateNewValue(L);},set:function(L){return this._setValueFn(L);}},rail:{value:null,validator:function(L){return this._validateNewRail(L);},set:function(L){return this._setRailFn(L);}},thumb:{value:null,validator:function(L){return this._validateNewThumb(L);},set:function(L){return this._setThumbFn(L);}},thumbImage:{value:null,validator:function(L){return this._validateNewThumbImage(L);},set:function(L){return this._setThumbImageFn(L);}},railSize:{value:"0",validator:function(L){return this._validateNewRailSize(L);}},railEnabled:{value:true,validator:R}}});C.extend(W,C.Widget,{_key:null,_factor:1,_railSize:null,_thumbSize:null,_stall:false,_disabled:false,initializer:function(){this._key=W.AXIS_KEYS[this.get("axis")];this.after("minChange",this._afterMinChange);this.after("maxChange",this._afterMaxChange);this.after("railSizeChange",this._afterRailSizeChange);this.publish(H);this.publish(J);this.publish(c,{defaultFn:this._defSyncUI});this.publish(Z,{defaultFn:this._defSetThumbPosition});},renderUI:function(){this._initRail();this._initThumb();},_initRail:function(){var L=this.get("contentBox"),M=this.get(Q);if(!M){M=L.appendChild(C.Node.create('<div class="'+this.getClassName(Q)+'"></div>'));this.set(Q,M);}else{if(!L.contains(M)){L.appendChild(M);}}M.addClass(this.getClassName(Q));M.addClass(this.getClassName(Q,this.get("axis")));},_initThumb:function(){var M=this.get(Q),L=this.get(P);if(L&&!this.get(D)&&L.get("nodeName").toLowerCase()==="img"){this.set(D,L);this.set(P,null);L=null;}if(!L){L=C.Node.create('<div class="'+this.getClassName(P)+'"></div>');this.set(P,L);}L.addClass(this.getClassName(P));if(!M.contains(L)){M.appendChild(L);}if(this.get(D)){this._initThumbImage();}},_initThumbImage:function(){var M=this.get(P),L=this.get(D);if(L){if(!M.contains(L)){M.appendChild(L);}}},bindUI:function(){this.publish(X,{defaultFn:this._defUpdateValueFromDD});this._bindThumbDD();this.after("valueChange",this._afterValueChange);this.after("thumbImageChange",this._afterThumbImageChange);this.after(I,this._afterDisabledChange);},_bindThumbDD:function(){var M={node:this.get(P),constrain2node:this.get(Q)},L;M[this._key.ddStick]=true;this._dd=L=new C.DD.Drag(M);L.on("drag:start",C.bind(this._onDDStartDrag,this));L.on("drag:drag",C.bind(this._onDDDrag,this));L.on("drag:end",C.bind(this._onDDEndDrag,this));this._initRailDD();},_initRailDD:function(){this.get(Q).on("mousedown",C.bind(this._handleRailMouseDown,this));},_handleRailMouseDown:function(Y){if(this.get("railEnabled")&&!this.get(g)){var L=this._dd,m=this._key.xyIndex,M;if(L.get("primaryButtonOnly")&&Y.button>1){return false;}L._dragThreshMet=true;L._fixIEMouseDown();Y.halt();C.DD.DDM.activeDrag=L;M=L.get("dragNode").getXY();M[m]+=e(this._thumbSize/2);L._setStartPosition(M);L.start();L._moveNode([Y.pageX,Y.pageY]);}},syncUI:function(){if(this._isImageLoaded(this.get(D))){this.fire(c);}else{this._scheduleSync();}},_scheduleSync:function(){var L,M;if(!this._stall){this._disabled=this.get(g);this.set(g,true);this._stall=this.on(I,this._stallDisabledChange);L=this.get(D);M=C.bind(this._imageLoaded,this,L);L.on("load",M);L.on("error",M);}},_stallDisabledChange:function(L){this._disabled=L.newVal;L.preventDefault();},_imageLoaded:function(M,L){var Y=this._isImageLoaded(L)?"removeClass":"addClass";this._stall.detach();this._stall=false;this.get(P)[Y](this.getClassName(l));this.fire(c);this.set(g,this._disabled);},_defSyncUI:function(L){this._uiSetThumbSize();this._uiSetRailSize();this._setRailOffsetXY();this._setDDGutter();this._setFactor();this.set(G,this.get(G),{ddEvent:null});},_uiSetThumbSize:function(){var M=this.get(P),m=this._key.dim,L=this.get(D),Y;Y=parseInt(M.getComputedStyle(m),10);if(this._isImageLoaded(L)){Y=d(L.get(m),Y);}this._thumbSize=Y;},_uiSetRailSize:function(){var o=this.get(Q),M=this.get(P),L=this.get(D),n=this._key.dim,Y=this.get(j),m=false;if(parseInt(Y,10)){o.setStyle(n,Y);Y=parseInt(o.getComputedStyle(n),10);}else{Y=this.get(n);if(parseInt(Y,10)){m=true;o.setStyle(n,Y);Y=parseInt(o.getComputedStyle(n),10);}Y=d(Y|0,parseInt(M.getComputedStyle(n),10),parseInt(o.getComputedStyle(n),10));if(this._isImageLoaded(L)){Y=d(L.get(n),Y);}}o.setStyle(n,Y+N);this._railSize=Y;if(m){n=this._key.offAxisDim;Y=this.get(n);if(Y){o.set(n,Y);}}},_setRailOffsetXY:function(){this._offsetXY=this.get(Q).getXY()[this._key.xyIndex]-e(this._thumbSize/2);},_setDDGutter:function(){var m=[0,0,0,0],M=this._key.xyIndex,Y=this._thumbSize/2,n=-1*e(Y),L=-1*B(Y);if(M){m[0]=n;m[2]=L;}else{m[3]=n;m[1]=L;}this._dd.set("gutter",m.join(" "));},_setFactor:function(){this._factor=this._railSize?(this.get(h)-this.get(f))/this._railSize:1;},getValue:function(){return this.get(G);},setValue:function(L){this.set(G,L);},_validateNewAxis:function(L){return T(L)&&L.length===1&&"xy".indexOf(L.toLowerCase())>-1;},_validateNewMin:function(L){return U(L);},_validateNewMax:function(L){return U(L);
},_validateNewValue:function(M){var Y=this.get(f),L=this.get(h);return U(M)&&(Y<L?(M>=Y&&M<=L):(M>=L&&M<=Y));},_validateNewRail:function(L){return !this.get(A)||L;},_validateNewThumb:function(L){return !this.get(A)||L;},_validateNewThumbImage:function(L){return !this.get(A)||L;},_validateNewRailSize:function(L){return T(L)&&(L==="0"||/^\d+(?:p[xtc]|%|e[mx]|in|[mc]m)$/.test(L));},_setAxisFn:function(L){return L.toLowerCase();},_setValueFn:function(L){if(!U(L)){L=this.get(f);}return i(L);},_setRailFn:function(L){return L?C.get(L):null;},_setThumbFn:function(L){return L?C.get(L):null;},_setThumbImageFn:function(L){return L?C.get(L)||C.Node.create('<img src="'+L+'" alt="Slider thumb">'):null;},_onDDStartDrag:function(L){this._setRailOffsetXY();this.fire(H,{ddEvent:L});},_onDDDrag:function(L){this.fire(X,{ddEvent:L});},_defUpdateValueFromDD:function(M){var L=this.get(G),Y=M.ddEvent[this._key.eventPageAxis]-this._offsetXY;Y=i(this.get(f)+(Y*this._factor));if(L!==Y){this.set(G,Y,{ddEvent:M.ddEvent});}},_onDDEndDrag:function(L){this.fire(J,{ddEvent:L});},_defSetThumbPosition:function(m){var Y=this.get(f),L=this.get(h),M=m.changeEv.newVal;M=i(((M-Y)/(L-Y))*this._railSize)+this._offsetXY;this._uiPositionThumb(M);},_uiPositionThumb:function(M){var L=this._dd;L._setStartPosition(L.get("dragNode").getXY());L._moveNode([M,M]);},_afterValueChange:function(L){if(!L.ddEvent){this.fire(Z,{changeEv:L});}L.ddEvent=null;},_afterThumbChange:function(M){var L;if(this.get(A)){if(M.prevValue){M.prevValue.get("parentNode").removeChild(M.prevValue);}this._initThumb();L=this.get(P);this._dd.set("node",L);this._dd.set("dragNode",L);this.syncUI();}},_afterThumbImageChange:function(L){if(this.get(A)){if(L.prevValue){L.prevValue.get("parentNode").removeChild(L.prevValue);}this._initThumbImage();this.syncUI();}},_afterMinChange:function(L){this._refresh(L);},_afterMaxChange:function(L){this._refresh(L);},_afterRailSizeChange:function(L){this._refresh(L);},_afterDisabledChange:function(L){if(this._dd){this._dd.set("locked",L.newVal);}},_refresh:function(L){if(L.newVal!==L.prevVal&&this.get(A)){this.syncUI();}},_isImageLoaded:function(M){var Y=(!M||!M.get("complete")),L;if(!Y){L=M.get("naturalWidth");Y=L===undefined?!M.get(F):!L;}return !Y;}});C.Slider=W;},"@VERSION@",{requires:["widget","dd-constrain"]});