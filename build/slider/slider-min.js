YUI.add("slider",function(C){var P="rail",O="thumb",I="value",Z="min",a="max",D="thumbImage",G="railWidth",E="railHeight",J="slideStart",K="slideEnd",A="rendered",X=".",M="px",H="width",W="height",Q="offsetWidth",B="offsetHeight",V="position",F=/^\d+(?:p[xtc]|%|e[mx]|in|[mc]m)$/,N=C.Lang,R=N.isArray,S=N.isString,T=N.isNumber;function U(){this.constructor.superclass.constructor.apply(this,arguments);}C.mix(U,{NAME:"slider",AXIS_KEYS:{x:{offsetEdge:"left",dim:H,offAxisDim:W,axisDim:G,offsetDim:Q,posMethod:"getX",eventPageAxis:"pageX",ddStick:"stickX",ticks:"tickX",xyIndex:0},y:{offsetEdge:"top",dim:W,offAxisDim:H,axisDim:E,offsetDim:B,posMethod:"getY",eventPageAxis:"pageY",ddStick:"stickY",ticks:"tickY",xyIndex:1}},HTML_PARSER:{rail:function(L){return L.query(X+this.getClassName(P));},thumb:function(L){return L.quer(X+this.getClassName(O));},thumbImage:function(L){return L.query(X+this.getClassName(O)+" img");}},ATTRS:{axis:{value:"x",writeOnce:true,validator:function(L){return this._validateNewAxis(L);},set:function(L){return this._setAxisFn(L);}},values:{value:null,validator:function(L){return this._validateNewValues(L);}},min:{value:0,validator:function(L){return this._validateNewMin(L);}},max:{value:100,validator:function(L){return this._validateNewMax(L);}},value:{value:0,validator:function(L){return this._validateNewValue(L);},set:function(L){return this._setValueFn(L);}},rail:{value:null,set:function(L){return this._setRailFn(L);}},thumb:{value:null,set:function(L){return this._setThumbFn(L);}},thumbImage:{value:null,set:function(L){return this._setThumbImageFn(L);}},railHeight:{value:"0",validator:function(L){return this._validateNewRailHeight(L);}},railWidth:{value:"0",validator:function(L){return this._validateNewRailWidth(L);}},backgroundEnabled:{value:true,validator:N.isBoolean}}});C.extend(U,C.Widget,{_key:null,_factor:0.5,_tickSize:false,_values:null,_railDims:null,_thumbDims:null,_thumbCenterOffset:10,initializer:function(){this._key=U.AXIS_KEYS[this.get("axis")];this.after("minChange",this._afterMinChange);this.after("maxChange",this._afterMaxChange);this.after("valuesChange",this._afterValuesChange);this.after(this._key.axisDim+"Change",this._afterRailDimChange);this.publish(J);this.publish(K);},renderUI:function(){var L;this.initRail();this.initThumb();},initRail:function(){var L=this.get("contentBox"),Y=this.get(P);if(!Y){Y=L.appendChild(C.Node.create('<div class="'+this.getClassName(P)+'"></div>'));this.set(P,Y);}else{if(!L.contains(Y)){L.appendChild(Y);}}if("absolute|relative".indexOf(Y.getStyle(V))===-1){Y.setStyle(V,"relative");}},initThumb:function(){var Y=this.get(P),L=this.get(O);if(!L){L=C.Node.create('<div class="'+this.getClassName(O)+'"></div>');this.set(O,L);}if(!Y.contains(L)){Y.appendChild(L);}L.setStyle(V,"absolute");if(this.get(D)){this.initThumbImage();}},initThumbImage:function(){var Y=this.get(O),L=this.get(D);if(L){if(!Y.contains(L)){Y.appendChild(L);}}},bindUI:function(){this.initThumbDD();this.after("valueChange",this._afterValueChange);},initThumbDD:function(){this._dd=new C.DD.Drag({node:this.get(O),constrain2node:this.get(P)});this._dd.on("drag:start",C.bind(this._onDDStartDrag,this));this._dd.on("drag:drag",C.bind(this._onDDDrag,this));this._dd.on("drag:end",C.bind(this._onDDEndDrag,this));this._dd.set(this._key.ddStick,true);this._initBackgroundDD();},_initBackgroundDD:function(){var b=this._key.eventPageAxis,Y=this._key.xyIndex,L=this;C.on("mousedown",C.bind(function(c){if(L.get("backgroundEnabled")){var d;if(this.get("primaryButtonOnly")&&c.button>1){return false;}this._dragThreshMet=true;this._fixIEMouseDown();c.halt();C.DD.DDM.activeDrag=this;d=this.get("dragNode").getXY();d[Y]+=L._thumbCenterOffset;this._setStartPosition(d);this.start();this._moveNode([c.pageX,c.pageY]);}},this._dd),this.get(P));},syncUI:function(){this._scheduleSync();},_scheduleSync:function(){var L=this.get(D),Y;if(!L||L.get("complete")){this._doSyncUI();}else{Y=C.bind(this._doSyncUI,this);L.on("load",Y);L.on("error",Y);}},_doSyncUI:function(){this._setRailDims();this._setThumbDims();this._setRailOffsetXY();this._calcThumbCenterOffset();this._updateValues();this._setValueStops();this._setConvFactor();this.set(I,this.get(I));},_setRailDims:function(){var d=this.get(P),b=this.get(O),Y=this.get(D),L=this.get(G),c=this.get(E);if(parseInt(c,10)){d.setStyle(W,c);c=d.getComputedStyle(W);}else{c=((this._isImageLoaded(Y)&&Y.get(W))||parseInt(b.getComputedStyle(W),10)||b.get(B))+M;}d.setStyle(W,c);if(parseInt(L,10)){d.setStyle(H,L);L=d.getComputedStyle(H);}else{L=((this._isImageLoaded(Y)&&Y.get(H))||parseInt(b.getComputedStyle(H),10)||b.get(Q))+M;}d.setStyle(H,L);this._railDims=[parseInt(L,10),parseInt(c,10)];},_setRailOffsetXY:function(){this._offsetXY=this.get(P).getXY()[this._key.xyIndex];},_setThumbDims:function(){var e=this.get(P),b=this.get(O),Y=this.get(D),d=parseInt(e.getComputedStyle(this._key.offAxisDim),10),L,c;if(this._isImageLoaded(Y)){c=Y.get(W);L=Y.get(H);}else{c=parseInt(b.getComputedStyle(W),10)||b.get(B)||d;L=parseInt(b.getComputedStyle(H),10)||b.get(Q)||d;}b.setStyle(W,c+M);b.setStyle(H,L+M);this._thumbDims=[L,c];},_calcThumbCenterOffset:function(){this._thumbCenterOffset=Math.round(this._thumbDims[this._key.xyIndex]/2);},_setValueStops:function(){var L=false,Y;if(this._values){Y=this._railDims[this._key.xyIndex]-this._thumbDims[this._key.xyIndex];L=Math.floor(Y/(this._values.length-1));}this._tickSize=L;this._dd.set(this._key.ticks,L);},_updateValues:function(){var d=this.get(Z),Y=this.get(a),b=this.get("values"),f=(Y-d)/(b-1),e=null,c,L;if(b){if(R(b)){e=b;}else{e=[d];for(c=1,L=b-1;c<L;++c){e[c]=Math.round(d+(c*f));}e[c]=Y;}e={arr:e,min:e[0],max:e[e.length-1],length:e.length};for(c=e.length-1;c>=0;--c){e[e.arr[c]]=c;}}this._values=e;},_setConvFactor:function(){var L=this.get(a)-this.get(Z),Y=this._railDims[this._key.xyIndex]-this._thumbDims[this._key.xyIndex];this._factor=Y?L/Y:1;},getValue:function(){return this.get(I);},setValue:function(Y,L){this.set(I,Y,{omitEvents:L});
},_validateNewAxis:function(L){return S(L)&&L.length===1&&"xy".indexOf(L.toLowerCase())>-1;},_validateNewMin:function(L){return T(L);},_validateNewMax:function(L){return T(L);},_validateNewValue:function(Y){var c=T(Y),b=this.get(Z),L=this.get(a);if(c){if(this._values){c=T(this._values[Y]);}else{c=b<L?(Y>=b&&Y<=L):(Y>=L&&Y<=b);}}return c;},_validateNewValues:function(Y){var L=this.get(a);if(Y===null||R(Y)||(T(Y)&&Y>1&&L===undefined)){return true;}if(T(Y)){return Y>1&&Y<=Math.abs(L-this.get(Z));}return false;},_validateNewRailHeight:function(L){return S(L)&&(L==="0"||F.test(L));},_validateNewRailWidth:function(L){return S(L)&&(L==="0"||F.test(L));},_setAxisFn:function(L){return L.toLowerCase();},_setValueFn:function(b){var Y=this.get("values"),L,c;if(Y){if(!this._values){this._updateValues();}Y=this._values;if(!T(+b)){b=Y.min;}else{if(!Y[b]){Y=Y.arr;if(Y[0]>Y[Y.length-1]){Y=C.Array(Y);Y.reverse();}L=Y[Y.length-1];for(c=Y.length-1;c>=0;--c){if(Y[c]>b){L=Y[c];}else{b=Math.abs(L-b)<Math.abs(Y[c]-b)?L:Y[c];break;}}}}}else{if(!T(+b)){b=this.get("min");}}return Math.round(b);},_setRailFn:function(L){return L?C.get(L):null;},_setThumbFn:function(L){return L?C.get(L):null;},_setThumbImageFn:function(L){return L?C.get(L)||C.Node.create('<img src="'+L+'" alt="Slider thumb">'):null;},_onDDStartDrag:function(L){this.fire(J,{ddEvent:L});this._offsetXY=this.get(P).getXY()[this._key.xyIndex];},_onDDDrag:function(c){var d=c[this._key.eventPageAxis]-this._offsetXY,b=this.get(I),Y,L;if(this._values){d=this._values.arr[Math.round(d/this._tickSize)];}else{d=Math.round(this.get(Z)+(d*this._factor));}if(b!==d){this.set(I,d,{ddEvent:c});}},_onDDEndDrag:function(L){this.fire(K,{ddEvent:L});},_uiSetThumbPosition:function(b){var d,Y,c,L;if(this._values){b=Math.round(this._values[b]*this._tickSize);}else{d=this.get(Z);Y=this.get(a);b=Math.round(((b-d)/(Y-d))*(this._railDims[this._key.xyIndex]-this._thumbDims[this._key.xyIndex]));}this.get(O).setStyle(this._key.offsetEdge,b+M);},_afterValueChange:function(L){if(!L.ddEvent){this._uiSetThumbPosition(L.newVal);}},_afterMinChange:function(L){this._refreshValues(L);},_afterMaxChange:function(L){this._refreshValues(L);},_afterValuesChange:function(L){this._refreshValues(L);if(this._values){this.set("min",this._values[0]);this.set("max",this._values[this._values.length-1]);}},_afterRailDimChange:function(L){if(L.newVal!==L.prevVal){this._setRailDims();if(this.get(A)){this._setValueStops();}}},_refreshValues:function(L){if(L.newVal!==L.prevVal){if(this.get(A)){this.syncUI();}}},_isImageLoaded:function(Y){var b=(!Y||!Y.get("complete")),L;if(!b){L=Y.get("naturalWidth");b=L===undefined?!Y.get(H):!L;}return !b;}});C.Slider=U;},"@VERSION@",{requires:["widget","dd"]});