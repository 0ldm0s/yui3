YUI.add("slider",function(A){var b="slider",Q="rail",h="thumb",g="value",J="min",j="max",I="thumbImage",i="railSize",H="slideStart",R="slideEnd",O="thumbDrag",U="sync",f="valueSet",d="rendered",F="ready",N=".",l="px",B="width",V="height",c="offsetWidth",a="offsetHeight",Z="position",E=A.Lang,P=E.isArray,W=E.isBoolean,G=E.isString,k=E.isNumber,m=A.ClassNameManager,D=Math,K=D.max,e=D.round,C=D.floor,S=D.ceil,T=D.abs;function X(){X.superclass.constructor.apply(this,arguments);}A.mix(X,{NAME:b,AXIS_KEYS:{x:{offsetEdge:"left",dim:B,offAxisDim:V,offsetDim:c,posMethod:"getX",eventPageAxis:"pageX",ddStick:"stickX",xyIndex:0},y:{offsetEdge:"top",dim:V,offAxisDim:B,offsetDim:a,posMethod:"getY",eventPageAxis:"pageY",ddStick:"stickY",xyIndex:1}},HTML_PARSER:{rail:m.getClassName(b,Q),thumb:m.getClassName(b,h),thumbImage:m.getClassName(b,I)},ATTRS:{axis:{value:"x",writeOnce:true,validator:function(L){return this._validateNewAxis(L);},set:function(L){return this._setAxisFn(L);}},min:{value:0,validator:function(L){return this._validateNewMin(L);}},max:{value:100,validator:function(L){return this._validateNewMax(L);}},value:{value:null,validator:function(L){return this._validateNewValue(L);},set:function(L){return this._setValueFn(L);}},rail:{value:null,validator:function(L){return this._validateNewRail(L);},set:function(L){return this._setRailFn(L);}},thumb:{value:null,validator:function(L){return this._validateNewThumb(L);},set:function(L){return this._setThumbFn(L);}},thumbImage:{value:null,validator:function(L){return this._validateNewThumbImage(L);},set:function(L){return this._setThumbImageFn(L);}},railSize:{value:"0",validator:function(L){return this._validateNewRailSize(L);}},railEnabled:{value:true,validator:W},ready:{value:false,readOnly:true,validator:W}}});A.extend(X,A.Widget,{_key:null,_factor:1,_railSize:null,_thumbSize:null,_loading:false,initializer:function(){this._key=X.AXIS_KEYS[this.get("axis")];this.after("minChange",this._afterMinChange);this.after("maxChange",this._afterMaxChange);this.after("railSizeChange",this._afterRailSizeChange);this.publish(H);this.publish(R);this.publish(U,{defaultFn:this._defSyncUI});this.publish(f,{defaultFn:this._defSetThumbPosition});this.publish(F);},renderUI:function(){this._initRail();this._initThumb();},_initRail:function(){var L=this.get("contentBox"),M=this.get(Q);if(!M){M=L.appendChild(A.Node.create('<div class="'+this.getClassName(Q)+'"></div>'));this.set(Q,M);}else{if(!L.contains(M)){L.appendChild(M);}}M.addClass(this.getClassName(Q));M.addClass(this.getClassName(Q,this.get("axis")));},_initThumb:function(){var M=this.get(Q),L=this.get(h);if(L&&!this.get(I)&&L.get("nodeName").toLowerCase()==="img"){this.set(I,L);this.set(h,null);L=null;}if(!L){L=A.Node.create('<div class="'+this.getClassName(h)+'"></div>');this.set(h,L);}L.addClass(this.getClassName(h));if(!M.contains(L)){M.appendChild(L);}if(this.get(I)){this._initThumbImage();}},_initThumbImage:function(){var M=this.get(h),L=this.get(I);if(L){if(!M.contains(L)){M.appendChild(L);}}},bindUI:function(){this.publish(O,{defaultFn:this._defUpdateValueFromDD});this._bindThumbDD();this.after("valueChange",this._afterValueChange);this.after("thumbImageChange",this._afterThumbImageChange);},_bindThumbDD:function(){var M={node:this.get(h),constrain2node:this.get(Q)},L;M[this._key.ddStick]=true;this._dd=L=new A.DD.Drag(M);L.on("drag:start",A.bind(this._onDDStartDrag,this));L.on("drag:drag",A.bind(this._onDDDrag,this));L.on("drag:end",A.bind(this._onDDEndDrag,this));this._initRailDD();},_initRailDD:function(){this.get(Q).on("mousedown",A.bind(this._handleRailMouseDown,this));},_handleRailMouseDown:function(Y){if(this.get("railEnabled")){var L=this._dd,n=this._key.xyIndex,M;if(L.get("primaryButtonOnly")&&Y.button>1){return false;}L._dragThreshMet=true;L._fixIEMouseDown();Y.halt();A.DD.DDM.activeDrag=L;M=L.get("dragNode").getXY();M[n]+=C(this._thumbSize/2);L._setStartPosition(M);L.start();L._moveNode([Y.pageX,Y.pageY]);}},syncUI:function(){var L=this.get(I);if(!L||L.get("complete")){this._ready();}else{this._scheduleSync();}},_scheduleSync:function(){var L=this.get(I),M;if(!this._loading){this._loading=true;M=A.bind(this._ready,this);L.on("load",M);L.on("error",M);}},_ready:function(){this.fire(U);this._loading=false;if(!this.get(F)){this.fire(F);this._set(F,true);}},_defSyncUI:function(L){this._setThumbSize();this._setRailSize();this._setRailOffsetXY();this._setDDGutter();this._setFactor();this.set(g,this.get(g),{ddEvent:null});},_setRailSize:function(){var o=this.get(Q),M=this.get(h),L=this.get(I),n=this._key.dim,Y=this.get(i);if(parseInt(Y,10)){o.setStyle(n,Y);Y=parseInt(o.getComputedStyle(n),10);}else{Y=K(parseInt(M.getComputedStyle(n),10),parseInt(o.getComputedStyle(n),10));if(this._isImageLoaded(L)){Y=K(L.get(n),Y);}}o.setStyle(n,Y+l);this._railSize=Y;},_setRailOffsetXY:function(){this._offsetXY=this.get(Q).getXY()[this._key.xyIndex]-C(this._thumbSize/2);},_setThumbSize:function(){var M=this.get(h),n=this._key.dim,L=this.get(I),Y;Y=parseInt(M.getComputedStyle(n),10);if(this._isImageLoaded(L)){Y=K(L.get(n),Y);}this._thumbSize=Y;},_setDDGutter:function(){var n=[0,0,0,0],M=this._key.xyIndex,Y=this._thumbSize/2,o=-1*C(Y),L=-1*S(Y);if(M){n[0]=o;n[2]=L;}else{n[3]=o;n[1]=L;}this._dd.set("gutter",n.join(" "));},_setFactor:function(){this._factor=this._railSize?(this.get(j)-this.get(J))/this._railSize:1;},getValue:function(){return this.get(g);},setValue:function(M,L){this.set(g,M,{omitEvents:L});},_validateNewAxis:function(L){return G(L)&&L.length===1&&"xy".indexOf(L.toLowerCase())>-1;},_validateNewMin:function(L){return k(L);},_validateNewMax:function(L){return k(L);},_validateNewValue:function(M){var Y=this.get(J),L=this.get(j);return k(M)&&(Y<L?(M>=Y&&M<=L):(M>=L&&M<=Y));},_validateNewRail:function(L){return !this.get(d)||L;},_validateNewThumb:function(L){return !this.get(d)||L;},_validateNewThumbImage:function(L){return !this.get(d)||L;},_validateNewRailSize:function(L){return G(L)&&(L==="0"||/^\d+(?:p[xtc]|%|e[mx]|in|[mc]m)$/.test(L));
},_setAxisFn:function(L){return L.toLowerCase();},_setValueFn:function(L){if(!k(L)){L=this.get(J);}return e(L);},_setRailFn:function(L){return L?A.get(L):null;},_setThumbFn:function(L){return L?A.get(L):null;},_setThumbImageFn:function(L){return L?A.get(L)||A.Node.create('<img src="'+L+'" alt="Slider thumb">'):null;},_onDDStartDrag:function(L){this._setRailOffsetXY();this.fire(H,{ddEvent:L});},_onDDDrag:function(L){this.fire(O,{ddEvent:L});},_defUpdateValueFromDD:function(M){var L=this.get(g),Y=M.ddEvent[this._key.eventPageAxis]-this._offsetXY;Y=e(this.get(J)+(Y*this._factor));if(L!==Y){this.set(g,Y,{ddEvent:M.ddEvent});}},_onDDEndDrag:function(L){this.fire(R,{ddEvent:L});},_defSetThumbPosition:function(n){var Y=this.get(J),L=this.get(j),M;M=e(((n.changeEv.newVal-Y)/(L-Y))*this._railSize)-C(this._thumbSize/2);this.get(h).setStyle(this._key.offsetEdge,M+l);},_afterValueChange:function(L){if(!L.ddEvent){this.fire(f,{changeEv:L});}L.ddEvent=L.omitEvents=null;},_afterThumbChange:function(M){var L;if(this.get(d)){if(M.prevValue){M.prevValue.get("parentNode").removeChild(M.prevValue);}this._initThumb();L=this.get(h);this._dd.set("node",L);this._dd.set("dragNode",L);this.syncUI();}},_afterThumbImageChange:function(L){if(this.get(d)){if(L.prevValue){L.prevValue.get("parentNode").removeChild(L.prevValue);}this._initThumbImage();this.syncUI();}},_afterMinChange:function(L){this._refresh(L);},_afterMaxChange:function(L){this._refresh(L);},_afterRailSizeChange:function(L){this._refresh(L);},_refresh:function(L){if(L.newVal!==L.prevVal&&this.get(d)){this.syncUI();}},_isImageLoaded:function(M){var Y=(!M||!M.get("complete")),L;if(!Y){L=M.get("naturalWidth");Y=L===undefined?!M.get(B):!L;}return !Y;}});A.Slider=X;},"@VERSION@",{requires:["widget","dd-constrain"]});