YUI.add("graphics-canvas",function(c,j){var s="canvasShape",f=c.config.doc,u=c.Lang,m=c.AttributeLite,n,p,w,q,k,g,v=c.DOM,i=c.Color,r=parseInt,h=parseFloat,o=u.isNumber,l=RegExp,t=i.toRGB,a=i.toHex,e=c.ClassNameManager.getClassName;function b(){}b.prototype={_currentX:0,_currentY:0,_toRGBA:function(y,x){x=(x!==undefined)?x:1;if(!i.re_RGB.test(y)){y=a(y);}if(i.re_hex.exec(y)){y="rgba("+[r(l.$1,16),r(l.$2,16),r(l.$3,16)].join(",")+","+x+")";}return y;},_toRGB:function(x){return t(x);},setSize:function(x,y){if(this.get("autoSize")){if(x>this.node.getAttribute("width")){this.node.style.width=x+"px";this.node.setAttribute("width",x);}if(y>this.node.getAttribute("height")){this.node.style.height=y+"px";this.node.setAttribute("height",y);}}},_updateCoords:function(z,A){this._xcoords.push(z);this._ycoords.push(A);this._currentX=z;this._currentY=A;},_clearAndUpdateCoords:function(){var z=this._xcoords.pop()||0,A=this._ycoords.pop()||0;this._updateCoords(z,A);},_updateNodePosition:function(){var A=this.get("node"),z=this.get("x"),B=this.get("y");A.style.position="absolute";A.style.left=(z+this._left)+"px";A.style.top=(B+this._top)+"px";},_updateDrawingQueue:function(x){this._methods.push(x);},lineTo:function(G,E,z){var D=arguments,A=0,C,H,F,B=this._stroke&&this._strokeWeight?this._strokeWeight:0;if(!this._lineToMethods){this._lineToMethods=[];}if(typeof G==="string"||typeof G==="number"){D=[[G,E]];}C=D.length;for(;A<C;++A){if(D[A]){H=D[A][0];F=D[A][1];this._updateDrawingQueue(["lineTo",H,F]);this._lineToMethods[this._lineToMethods.length]=this._methods[this._methods.length-1];this._trackSize(H-B,F-B);this._trackSize(H+B,F+B);this._updateCoords(H,F);}}this._drawingComplete=false;return this;},moveTo:function(A,B){var z=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._updateDrawingQueue(["moveTo",A,B]);this._trackSize(A-z,B-z);this._trackSize(A+z,B+z);this._updateCoords(A,B);this._drawingComplete=false;return this;},curveTo:function(C,A,K,J,G,F){var H,D,L,I,B,z,E;this._updateDrawingQueue(["bezierCurveTo",C,A,K,J,G,F]);this._drawingComplete=false;I=Math.max(G,Math.max(C,K));z=Math.max(F,Math.max(A,J));B=Math.min(G,Math.min(C,K));E=Math.min(F,Math.min(A,J));H=Math.abs(I-B);D=Math.abs(z-E);L=[[this._currentX,this._currentY],[C,A],[K,J],[G,F]];this._setCurveBoundingBox(L,H,D);this._updateCoords(G,F);return this;},quadraticCurveTo:function(C,B,H,G){var I,D,K,J,A,z,F,E=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._updateDrawingQueue(["quadraticCurveTo",C,B,H,G]);this._drawingComplete=false;J=Math.max(H,C);z=Math.max(G,B);A=Math.min(H,C);F=Math.min(G,B);I=Math.abs(J-A);D=Math.abs(z-F);K=[[this._currentX,this._currentY],[C,B],[H,G]];this._setCurveBoundingBox(K,I,D);this._updateCoords(H,G);return this;},drawCircle:function(B,F,A){var D=0,C=2*Math.PI,z=this._stroke&&this._strokeWeight?this._strokeWeight:0,E=A*2;E+=z;this._drawingComplete=false;this._trackSize(B+E,F+E);this._trackSize(B-z,F-z);this._updateCoords(B,F);this._updateDrawingQueue(["arc",B+A,F+A,A,D,C,false]);return this;},drawDiamond:function(A,E,D,z){var C=D*0.5,B=z*0.5;this.moveTo(A+C,E);this.lineTo(A+D,E+B);this.lineTo(A+C,E+z);this.lineTo(A,E+B);this.lineTo(A+C,E);return this;},drawEllipse:function(K,I,L,Q){var N=8,F=-(45/180)*Math.PI,S=0,E,C=L/2,D=Q/2,O=0,H=K+C,G=I+D,M,J,R,P,B,A,z=this._stroke&&this._strokeWeight?this._strokeWeight:0;M=H+Math.cos(0)*C;J=G+Math.sin(0)*D;this.moveTo(M,J);for(;O<N;O++){S+=F;E=S-(F/2);R=H+Math.cos(S)*C;P=G+Math.sin(S)*D;B=H+Math.cos(E)*(C/Math.cos(F/2));A=G+Math.sin(E)*(D/Math.cos(F/2));this._updateDrawingQueue(["quadraticCurveTo",B,A,R,P]);}this._trackSize(K+L+z,I+Q+z);this._trackSize(K-z,I-z);this._updateCoords(K,I);return this;},drawRect:function(A,D,B,C){var z=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(A,D);this.lineTo(A+B,D);this.lineTo(A+B,D+C);this.lineTo(A,D+C);this.lineTo(A,D);return this;},drawRoundRect:function(A,F,B,D,C,E){var z=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(A,F+E);this.lineTo(A,F+D-E);this.quadraticCurveTo(A,F+D,A+C,F+D);this.lineTo(A+B-C,F+D);this.quadraticCurveTo(A+B,F+D,A+B,F+D-E);this.lineTo(A+B,F+E);this.quadraticCurveTo(A+B,F,A+B-C,F);this.lineTo(A+C,F);this.quadraticCurveTo(A,F,A,F+E);return this;},drawWedge:function(J,H,N,G,C,D){var z=this._stroke&&this._strokeWeight?this._strokeWeight:0,M,L,F,R,E,K,I,Q,P,B,A,O=0;D=D||C;this._drawingComplete=false;this._updateDrawingQueue(["moveTo",J,H]);D=D||C;if(Math.abs(G)>360){G=360;}M=Math.ceil(Math.abs(G)/45);L=G/M;F=-(L/180)*Math.PI;R=(N/180)*Math.PI;if(M>0){K=J+Math.cos(N/180*Math.PI)*C;I=H+Math.sin(N/180*Math.PI)*D;this.lineTo(K,I);for(;O<M;++O){R+=F;E=R-(F/2);Q=J+Math.cos(R)*C;P=H+Math.sin(R)*D;B=J+Math.cos(E)*(C/Math.cos(F/2));A=H+Math.sin(E)*(D/Math.cos(F/2));this._updateDrawingQueue(["quadraticCurveTo",B,A,Q,P]);}this._updateDrawingQueue(["lineTo",J,H]);}this._trackSize(0-z,0-z);this._trackSize((C*2)+z,(C*2)+z);return this;},end:function(){this._closePath();return this;},closePath:function(){this._updateDrawingQueue(["closePath"]);this._updateDrawingQueue(["beginPath"]);},_getLinearGradient:function(){var L=c.Lang.isNumber,Q=this.get("fill"),H=Q.stops,E,P,O,R=0,S=H.length,z,J=0,I=0,K=this.get("width"),T=this.get("height"),N=Q.rotation||0,V,U,D,B,C=J+K/2,A=I+T/2,G,F=Math.PI/180,M=parseFloat(parseFloat(Math.tan(N*F)).toFixed(8));if(Math.abs(M)*K/2>=T/2){if(N<180){D=I;B=I+T;}else{D=I+T;B=I;}V=C-((A-D)/M);U=C-((A-B)/M);}else{if(N>90&&N<270){V=J+K;U=J;}else{V=J;U=J+K;}D=((M*(C-V))-A)*-1;B=((M*(C-U))-A)*-1;}z=this._context.createLinearGradient(V,D,U,B);for(;R<S;++R){O=H[R];E=O.opacity;P=O.color;G=O.offset;if(L(E)){E=Math.max(0,Math.min(1,E));P=this._toRGBA(P,E);}else{P=t(P);}G=O.offset||R/(S-1);z.addColorStop(G,P);}return z;},_getRadialGradient:function(){var O=c.Lang.isNumber,U=this.get("fill"),P=U.r,G=U.fx,E=U.fy,I=U.stops,F,R,Q,V=0,X=I.length,A,L=0,K=0,M=this.get("width"),Y=this.get("height"),Z,W,D,C,T,S,z,N,aa,ab,H,J,B;
S=L+M/2;z=K+Y/2;Z=M*G;D=Y*E;W=L+M/2;C=K+Y/2;T=M*P;ab=Math.sqrt(Math.pow(Math.abs(S-Z),2)+Math.pow(Math.abs(z-D),2));if(ab>=T){J=ab/T;if(J===1){J=1.01;}N=(Z-S)/J;aa=(D-z)/J;N=N>0?Math.floor(N):Math.ceil(N);aa=aa>0?Math.floor(aa):Math.ceil(aa);Z=S+N;D=z+aa;}if(P>=0.5){A=this._context.createRadialGradient(Z,D,P,W,C,P*M);B=1;}else{A=this._context.createRadialGradient(Z,D,P,W,C,M/2);B=P*2;}for(;V<X;++V){Q=I[V];F=Q.opacity;R=Q.color;H=Q.offset;if(O(F)){F=Math.max(0,Math.min(1,F));R=this._toRGBA(R,F);}else{R=t(R);}H=Q.offset||V/(X-1);H*=B;if(H<=1){A.addColorStop(H,R);}}return A;},_initProps:function(){this._methods=[];this._lineToMethods=[];this._xcoords=[0];this._ycoords=[0];this._width=0;this._height=0;this._left=0;this._top=0;this._right=0;this._bottom=0;this._currentX=0;this._currentY=0;},_drawingComplete:false,_createGraphic:function(x){var y=c.config.doc.createElement("canvas");return y;},getBezierData:function(B,A){var C=B.length,z=[],y,x;for(y=0;y<C;++y){z[y]=[B[y][0],B[y][1]];}for(x=1;x<C;++x){for(y=0;y<C-x;++y){z[y][0]=(1-A)*z[y][0]+A*z[parseInt(y+1,10)][0];z[y][1]=(1-A)*z[y][1]+A*z[parseInt(y+1,10)][1];}}return[z[0][0],z[0][1]];},_setCurveBoundingBox:function(I,E,A){var z=0,y=this._currentX,F=y,D=this._currentY,x=D,C=Math.round(Math.sqrt((E*E)+(A*A))),G=1/C,B=this._stroke&&this._strokeWeight?this._strokeWeight:0,H;for(;z<C;++z){H=this.getBezierData(I,G*z);y=isNaN(y)?H[0]:Math.min(H[0],y);F=isNaN(F)?H[0]:Math.max(H[0],F);D=isNaN(D)?H[1]:Math.min(H[1],D);x=isNaN(x)?H[1]:Math.max(H[1],x);}y=Math.round(y*10)/10;F=Math.round(F*10)/10;D=Math.round(D*10)/10;x=Math.round(x*10)/10;this._trackSize(F+B,x+B);this._trackSize(y-B,D-B);},_trackSize:function(x,y){if(x>this._right){this._right=x;}if(x<this._left){this._left=x;}if(y<this._top){this._top=y;}if(y>this._bottom){this._bottom=y;}this._width=this._right-this._left;this._height=this._bottom-this._top;}};c.CanvasDrawing=b;n=function(x){this._transforms=[];this.matrix=new c.Matrix();n.superclass.constructor.apply(this,arguments);};n.NAME="canvasShape";c.extend(n,c.GraphicBase,c.mix({init:function(){this.initializer.apply(this,arguments);},initializer:function(x){var y=this,z=x.graphic;y._initProps();y.createNode();y._xcoords=[0];y._ycoords=[0];if(z){this._setGraphic(z);}y._updateHandler();},_setGraphic:function(x){var y;if(x instanceof c.CanvasGraphic){this._graphic=x;}else{x=c.one(x);y=new c.CanvasGraphic({render:x});y._appendShape(this);this._graphic=y;}},addClass:function(x){var y=c.one(this.get("node"));y.addClass(x);},removeClass:function(x){var y=c.one(this.get("node"));y.removeClass(x);},getXY:function(){var C=this.get("graphic"),A=C.getXY(),z=this.get("x"),B=this.get("y");return[A[0]+z,A[1]+B];},setXY:function(B){var D=this.get("graphic"),A=D.getXY(),z=B[0]-A[0],C=B[1]-A[1];this._set("x",z);this._set("y",C);this._updateNodePosition(z,C);},contains:function(x){return x===c.one(this.node);},test:function(x){return c.one(this.get("node")).test(x);},compareTo:function(x){var y=this.node;return y===x;},_getDefaultFill:function(){return{type:"solid",cx:0.5,cy:0.5,fx:0.5,fy:0.5,r:0.5};},_getDefaultStroke:function(){return{weight:1,dashstyle:"none",color:"#000",opacity:1};},_left:0,_right:0,_top:0,_bottom:0,createNode:function(){var x=c.config.doc.createElement("canvas"),y=this.get("id");this._context=x.getContext("2d");x.setAttribute("overflow","visible");x.style.overflow="visible";if(!this.get("visible")){x.style.visibility="hidden";}x.setAttribute("id",y);y="#"+y;this.node=x;this.addClass(e(s)+" "+e(this.name));},on:function(y,x){if(c.Node.DOM_EVENTS[y]){return c.one("#"+this.get("id")).on(y,x);}return c.on.apply(this,arguments);},_setStrokeProps:function(D){var y,C,B,A,z,x;if(D){y=D.color;C=h(D.weight);B=h(D.opacity);A=D.linejoin||"round";z=D.linecap||"butt";x=D.dashstyle;this._miterlimit=null;this._dashstyle=(x&&c.Lang.isArray(x)&&x.length>1)?x:null;this._strokeWeight=C;if(o(C)&&C>0){this._stroke=1;}else{this._stroke=0;}if(o(B)){this._strokeStyle=this._toRGBA(y,B);}else{this._strokeStyle=y;}this._linecap=z;if(A=="round"||A=="bevel"){this._linejoin=A;}else{A=parseInt(A,10);if(o(A)){this._miterlimit=Math.max(A,1);this._linejoin="miter";}}}else{this._stroke=0;}},set:function(){var x=this,y=arguments[0];m.prototype.set.apply(x,arguments);if(x.initialized){x._updateHandler();}},_setFillProps:function(B){var z=o,x,y,A;if(B){x=B.color;A=B.type;if(A=="linear"||A=="radial"){this._fillType=A;}else{if(x){y=B.opacity;if(z(y)){y=Math.max(0,Math.min(1,y));x=this._toRGBA(x,y);}else{x=t(x);}this._fillColor=x;this._fillType="solid";}else{this._fillColor=null;}}}else{this._fillType=null;this._fillColor=null;}},translate:function(z,A){this._translateX+=z;this._translateY+=A;this._addTransform("translate",arguments);},translateX:function(y){this._translateX+=y;this._addTransform("translateX",arguments);},translateY:function(x){this._translateY+=x;this._addTransform("translateY",arguments);},skew:function(z,A){this._addTransform("skew",arguments);},skewX:function(y){this._addTransform("skewX",arguments);},skewY:function(x){this._addTransform("skewY",arguments);},rotate:function(x){this._rotation=x;this._addTransform("rotate",arguments);},scale:function(z,A){this._addTransform("scale",arguments);},_rotation:0,_transform:"",_addTransform:function(y,x){x=c.Array(x);this._transform=u.trim(this._transform+" "+y+"("+x.join(", ")+")");x.unshift(y);this._transforms.push(x);if(this.initialized){this._updateTransform();}},_updateTransform:function(){var D=this.node,C,A,z=this.get("transformOrigin"),y=this.matrix,B=0,x=this._transforms.length;if(this._transforms&&this._transforms.length>0){for(;B<x;++B){C=this._transforms[B].shift();if(C){y[C].apply(y,this._transforms[B]);}}A=y.toCSSText();}this._graphic.addToRedrawQueue(this);z=(100*z[0])+"% "+(100*z[1])+"%";D.style.MozTransformOrigin=z;D.style.webkitTransformOrigin=z;D.style.msTransformOrigin=z;D.style.OTransformOrigin=z;if(A){D.style.MozTransform=A;D.style.webkitTransform=A;D.style.msTransform=A;D.style.OTransform=A;}this._transforms=[];
},_updateHandler:function(){this._draw();this._updateTransform();},_draw:function(){var x=this.node;this.clear();this._closePath();x.style.left=this.get("x")+"px";x.style.top=this.get("y")+"px";},_closePath:function(){if(!this._methods){return;}var B=this.get("node"),I=this._right-this._left,F=this._bottom-this._top,y=this._context,C=[],z=this._methods.concat(),E=0,D,x,H,A,G=0;this._context.clearRect(0,0,B.width,B.height);if(this._methods){G=z.length;if(!G||G<1){return;}for(;E<G;++E){C[E]=z[E].concat();H=C[E];A=H[0]=="quadraticCurveTo"?H.length:3;for(D=1;D<A;++D){if(D%2===0){H[D]=H[D]-this._top;}else{H[D]=H[D]-this._left;}}}B.setAttribute("width",Math.min(I,2000));B.setAttribute("height",Math.min(2000,F));y.beginPath();for(E=0;E<G;++E){H=C[E].concat();if(H&&H.length>0){x=H.shift();if(x){if(x=="closePath"){this._strokeAndFill(y);}if(x&&x=="lineTo"&&this._dashstyle){H.unshift(this._xcoords[E]-this._left,this._ycoords[E]-this._top);this._drawDashedLine.apply(this,H);}else{y[x].apply(y,H);}}}}this._strokeAndFill(y);this._drawingComplete=true;this._clearAndUpdateCoords();this._updateNodePosition();this._methods=z;}},_strokeAndFill:function(x){if(this._fillType){if(this._fillType=="linear"){x.fillStyle=this._getLinearGradient();}else{if(this._fillType=="radial"){x.fillStyle=this._getRadialGradient();}else{x.fillStyle=this._fillColor;}}x.closePath();x.fill();}if(this._stroke){if(this._strokeWeight){x.lineWidth=this._strokeWeight;}x.lineCap=this._linecap;x.lineJoin=this._linejoin;if(this._miterlimit){x.miterLimit=this._miterlimit;}x.strokeStyle=this._strokeStyle;x.stroke();}},_drawDashedLine:function(G,M,x,J){var y=this._context,K=this._dashstyle[0],I=this._dashstyle[1],A=K+I,D=x-G,H=J-M,L=Math.sqrt(Math.pow(D,2)+Math.pow(H,2)),B=Math.floor(Math.abs(L/A)),z=Math.atan2(H,D),F=G,E=M,C;D=Math.cos(z)*A;H=Math.sin(z)*A;for(C=0;C<B;++C){y.moveTo(F,E);y.lineTo(F+Math.cos(z)*K,E+Math.sin(z)*K);F+=D;E+=H;}y.moveTo(F,E);L=Math.sqrt((x-F)*(x-F)+(J-E)*(J-E));if(L>K){y.lineTo(F+Math.cos(z)*K,E+Math.sin(z)*K);}else{if(L>0){y.lineTo(F+Math.cos(z)*L,E+Math.sin(z)*L);}}y.moveTo(x,J);},clear:function(){this._initProps();if(this.node){this._context.clearRect(0,0,this.node.width,this.node.height);}return this;},getBounds:function(){var D=this._type,E=this.get("stroke"),B=this.get("width"),C=this.get("height"),A=this.get("x"),F=this.get("y"),z=0;if(D=="path"){A=A+this._left;F=F+this._top;B=this._right-this._left;C=this._bottom-this._top;}if(E&&E.weight){z=E.weight;}B=(A+B+z)-(A-z);C=(F+C+z)-(F-z);A-=z;F-=z;return this._getContentRect(B,C,A,F);},_getContentRect:function(K,C,I,F){var A=this.get("transformOrigin"),J=A[0]*K,H=A[1]*C,E=this.matrix.getTransformArray(this.get("transform")),G=new c.Matrix(),B=0,D=E.length,z,L,M;if(this._type=="path"){J=J+I;H=H+F;}J=!isNaN(J)?J:0;H=!isNaN(H)?H:0;G.translate(J,H);for(;B<D;B=B+1){z=E[B];L=z.shift();if(L){G[L].apply(G,z);}}G.translate(-J,-H);M=G.getContentRect(K,C,I,F);return M;},destroy:function(){var x=this.get("graphic");if(x){x.removeShape(this);}else{this._destroy();}},_destroy:function(){if(this.node){c.one(this.node).remove(true);this._context=null;this.node=null;}}},c.CanvasDrawing.prototype));n.ATTRS={transformOrigin:{valueFn:function(){return[0.5,0.5];}},transform:{setter:function(x){this.matrix.init();this._transforms=this.matrix.getTransformArray(x);this._transform=x;return x;},getter:function(){return this._transform;}},node:{readOnly:true,getter:function(){return this.node;}},id:{valueFn:function(){return c.guid();},setter:function(y){var x=this.node;if(x){x.setAttribute("id",y);}return y;}},width:{value:0},height:{value:0},x:{value:0},y:{value:0},visible:{value:true,setter:function(z){var y=this.get("node"),x=z?"visible":"hidden";if(y){y.style.visibility=x;}return z;}},fill:{valueFn:"_getDefaultFill",setter:function(z){var y,x=this.get("fill")||this._getDefaultFill();y=(z)?c.merge(x,z):null;if(y&&y.color){if(y.color===undefined||y.color=="none"){y.color=null;}}this._setFillProps(y);return y;}},stroke:{valueFn:"_getDefaultStroke",setter:function(z){var y=this.get("stroke")||this._getDefaultStroke(),x;if(z&&z.hasOwnProperty("weight")){x=parseInt(z.weight,10);if(!isNaN(x)){z.weight=x;}}z=(z)?c.merge(y,z):null;this._setStrokeProps(z);return z;}},autoSize:{value:false},pointerEvents:{value:"visiblePainted"},graphic:{readOnly:true,getter:function(){return this._graphic;}}};c.CanvasShape=n;p=function(x){p.superclass.constructor.apply(this,arguments);};p.NAME="canvasPath";c.extend(p,c.CanvasShape,{_type:"path",_draw:function(){this._closePath();this._updateTransform();},createNode:function(){var x=c.config.doc.createElement("canvas"),y=this.get("id");this._context=x.getContext("2d");x.setAttribute("overflow","visible");x.setAttribute("pointer-events","none");x.style.pointerEvents="none";x.style.overflow="visible";x.setAttribute("id",y);y="#"+y;this.node=x;this.addClass(e(s)+" "+e(this.name));},end:function(){this._draw();}});p.ATTRS=c.merge(c.CanvasShape.ATTRS,{width:{getter:function(){var x=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._width-x;},setter:function(x){this._width=x;return x;}},height:{getter:function(){var x=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._height-x;},setter:function(x){this._height=x;return x;}},path:{readOnly:true,getter:function(){return this._path;}}});c.CanvasPath=p;w=function(){w.superclass.constructor.apply(this,arguments);};w.NAME="canvasRect";c.extend(w,c.CanvasShape,{_type:"rect",_draw:function(){var x=this.get("width"),y=this.get("height");this.clear();this.drawRect(0,0,x,y);this._closePath();}});w.ATTRS=c.CanvasShape.ATTRS;c.CanvasRect=w;q=function(x){q.superclass.constructor.apply(this,arguments);};q.NAME="canvasEllipse";c.extend(q,n,{_type:"ellipse",_draw:function(){var x=this.get("width"),y=this.get("height");this.clear();this.drawEllipse(0,0,x,y);this._closePath();}});q.ATTRS=c.merge(n.ATTRS,{xRadius:{setter:function(x){this.set("width",x*2);},getter:function(){var x=this.get("width");
if(x){x*=0.5;}return x;}},yRadius:{setter:function(x){this.set("height",x*2);},getter:function(){var x=this.get("height");if(x){x*=0.5;}return x;}}});c.CanvasEllipse=q;k=function(x){k.superclass.constructor.apply(this,arguments);};k.NAME="canvasCircle";c.extend(k,c.CanvasShape,{_type:"circle",_draw:function(){var x=this.get("radius");if(x){this.clear();this.drawCircle(0,0,x);this._closePath();}}});k.ATTRS=c.merge(c.CanvasShape.ATTRS,{width:{setter:function(x){this.set("radius",x/2);return x;},getter:function(){return this.get("radius")*2;}},height:{setter:function(x){this.set("radius",x/2);return x;},getter:function(){return this.get("radius")*2;}},radius:{lazyAdd:false}});c.CanvasCircle=k;g=function(){g.superclass.constructor.apply(this,arguments);};g.NAME="canvasPieSlice";c.extend(g,c.CanvasShape,{_type:"path",_draw:function(D){var A=this.get("cx"),E=this.get("cy"),C=this.get("startAngle"),B=this.get("arc"),z=this.get("radius");this.clear();this._left=A;this._right=z;this._top=E;this._bottom=z;this.drawWedge(A,E,C,B,z);this.end();}});g.ATTRS=c.mix({cx:{value:0},cy:{value:0},startAngle:{value:0},arc:{value:0},radius:{value:0}},c.CanvasShape.ATTRS);c.CanvasPieSlice=g;function d(x){d.superclass.constructor.apply(this,arguments);}d.NAME="canvasGraphic";d.ATTRS={render:{},id:{valueFn:function(){return c.guid();},setter:function(y){var x=this._node;if(x){x.setAttribute("id",y);}return y;}},shapes:{readOnly:true,getter:function(){return this._shapes;}},contentBounds:{readOnly:true,getter:function(){return this._contentBounds;}},node:{readOnly:true,getter:function(){return this._node;}},width:{setter:function(x){if(this._node){this._node.style.width=x+"px";}return x;}},height:{setter:function(x){if(this._node){this._node.style.height=x+"px";}return x;}},autoSize:{value:false},preserveAspectRatio:{value:"xMidYMid"},resizeDown:{getter:function(){return this._resizeDown;},setter:function(x){this._resizeDown=x;if(this._node){this._redraw();}return x;}},x:{getter:function(){return this._x;},setter:function(x){this._x=x;if(this._node){this._node.style.left=x+"px";}return x;}},y:{getter:function(){return this._y;},setter:function(x){this._y=x;if(this._node){this._node.style.top=x+"px";}return x;}},autoDraw:{value:true},visible:{value:true,setter:function(x){this._toggleVisible(x);return x;}}};c.extend(d,c.GraphicBase,{_x:0,_y:0,getXY:function(){var x=c.one(this._node),y;if(x){y=x.getXY();}return y;},_resizeDown:false,initializer:function(z){var B=this.get("render"),y=this.get("visible")?"visible":"hidden",x=this.get("width")||0,A=this.get("height")||0;this._shapes={};this._redrawQueue={};this._contentBounds={left:0,top:0,right:0,bottom:0};this._node=f.createElement("div");this._node.style.position="absolute";this._node.style.visibility=y;this.set("width",x);this.set("height",A);if(B){this.render(B);}},render:function(A){var x=c.one(A),B=this._node,y=this.get("width")||parseInt(x.getComputedStyle("width"),10),z=this.get("height")||parseInt(x.getComputedStyle("height"),10);x=x||f.body;x.appendChild(B);B.style.display="block";B.style.position="absolute";B.style.left="0px";B.style.top="0px";this.set("width",y);this.set("height",z);this.parentNode=x;return this;},destroy:function(){this.removeAllShapes();if(this._node){this._removeChildren(this._node);c.one(this._node).destroy();}},addShape:function(x){x.graphic=this;if(!this.get("visible")){x.visible=false;}var z=this._getShapeClass(x.type),y=new z(x);this._appendShape(y);return y;},_appendShape:function(y){var z=y.node,x=this._frag||this._node;if(this.get("autoDraw")){x.appendChild(z);}else{this._getDocFrag().appendChild(z);}},removeShape:function(x){if(!(x instanceof n)){if(u.isString(x)){x=this._shapes[x];}}if(x&&x instanceof n){x._destroy();delete this._shapes[x.get("id")];}if(this.get("autoDraw")){this._redraw();}return x;},removeAllShapes:function(){var x=this._shapes,y;for(y in x){if(x.hasOwnProperty(y)){x[y].destroy();}}this._shapes={};},clear:function(){this.removeAllShapes();},_removeChildren:function(x){if(x&&x.hasChildNodes()){var y;while(x.firstChild){y=x.firstChild;this._removeChildren(y);x.removeChild(y);}}},_toggleVisible:function(A){var z,y=this._shapes,x=A?"visible":"hidden";if(y){for(z in y){if(y.hasOwnProperty(z)){y[z].set("visible",A);}}}if(this._node){this._node.style.visibility=x;}},_getShapeClass:function(y){var x=this._shapeClass[y];if(x){return x;}return y;},_shapeClass:{circle:c.CanvasCircle,rect:c.CanvasRect,path:c.CanvasPath,ellipse:c.CanvasEllipse,pieslice:c.CanvasPieSlice},getShapeById:function(y){var x=this._shapes[y];return x;},batch:function(y){var x=this.get("autoDraw");this.set("autoDraw",false);y();this._redraw();this.set("autoDraw",x);},_getDocFrag:function(){if(!this._frag){this._frag=f.createDocumentFragment();}return this._frag;},_redraw:function(){var D=this.get("autoSize"),B=this.get("preserveAspectRatio"),E=this.get("resizeDown")?this._getUpdatedContentBounds():this._contentBounds,x,H,I,F,J,A,z=0,y=0,G,C=this.get("node");if(D){if(D=="sizeContentToGraphic"){x=E.width;H=E.height;I=parseFloat(v.getComputedStyle(C,"width"));F=parseFloat(v.getComputedStyle(C,"height"));G=new c.Matrix();if(B=="none"){J=I/x;A=F/H;}else{if(x/H!==I/F){if(x*F/H>I){J=A=I/x;y=this._calculateTranslate(B.slice(5).toLowerCase(),H*I/x,F);}else{J=A=F/H;z=this._calculateTranslate(B.slice(1,4).toLowerCase(),x*F/H,I);}}}v.setStyle(C,"transformOrigin","0% 0%");z=z-(E.left*J);y=y-(E.top*A);G.translate(z,y);G.scale(J,A);v.setStyle(C,"transform",G.toCSSText());}else{this.set("width",E.right);this.set("height",E.bottom);}}if(this._frag){this._node.appendChild(this._frag);this._frag=null;}},_calculateTranslate:function(x,A,z){var y=z-A,B;switch(x){case"mid":B=y*0.5;break;case"max":B=y;break;default:B=0;break;}return B;},addToRedrawQueue:function(x){var z,y;this._shapes[x.get("id")]=x;if(!this.get("resizeDown")){z=x.getBounds();y=this._contentBounds;y.left=y.left<z.left?y.left:z.left;y.top=y.top<z.top?y.top:z.top;y.right=y.right>z.right?y.right:z.right;y.bottom=y.bottom>z.bottom?y.bottom:z.bottom;
y.width=y.right-y.left;y.height=y.bottom-y.top;this._contentBounds=y;}if(this.get("autoDraw")){this._redraw();}},_getUpdatedContentBounds:function(){var B,z,y,x=this._shapes,A={left:0,top:0,right:0,bottom:0};for(z in x){if(x.hasOwnProperty(z)){y=x[z];B=y.getBounds();A.left=Math.min(A.left,B.left);A.top=Math.min(A.top,B.top);A.right=Math.max(A.right,B.right);A.bottom=Math.max(A.bottom,B.bottom);}}A.width=A.right-A.left;A.height=A.bottom-A.top;this._contentBounds=A;return A;}});c.CanvasGraphic=d;},"@VERSION@",{"requires":["graphics"]});