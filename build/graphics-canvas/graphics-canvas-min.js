YUI.add("graphics-canvas",function(d,k){var u="canvasShape",a=/[a-z][^a-z]*/ig,n=/[-]?[0-9]*[0-9|\.][0-9]*/g,g=d.config.doc,w=d.Lang,o=d.AttributeLite,p,r,A,s,l,h,z=d.DOM,j=d.Color,t=parseInt,i=parseFloat,q=w.isNumber,m=RegExp,v=j.toRGB,b=j.toHex,f=d.ClassNameManager.getClassName;function c(){}c.prototype={_pathSymbolToMethod:{M:"moveTo",m:"relativeMoveTo",L:"lineTo",l:"relativeLineTo",C:"curveTo",c:"relativeCurveTo",Q:"quadraticCurveTo",q:"relativeQuadraticCurveTo",z:"closePath",Z:"closePath"},_currentX:0,_currentY:0,_toRGBA:function(C,B){B=(B!==undefined)?B:1;if(!j.re_RGB.test(C)){C=b(C);}if(j.re_hex.exec(C)){C="rgba("+[t(m.$1,16),t(m.$2,16),t(m.$3,16)].join(",")+","+B+")";}return C;},_toRGB:function(B){return v(B);},setSize:function(B,C){if(this.get("autoSize")){if(B>this.node.getAttribute("width")){this.node.style.width=B+"px";this.node.setAttribute("width",B);}if(C>this.node.getAttribute("height")){this.node.style.height=C+"px";this.node.setAttribute("height",C);}}},_updateCoords:function(B,C){this._xcoords.push(B);this._ycoords.push(C);this._currentX=B;this._currentY=C;},_clearAndUpdateCoords:function(){var B=this._xcoords.pop()||0,C=this._ycoords.pop()||0;this._updateCoords(B,C);},_updateNodePosition:function(){var C=this.get("node"),B=this.get("x"),D=this.get("y");C.style.position="absolute";C.style.left=(B+this._left)+"px";C.style.top=(D+this._top)+"px";},_updateDrawingQueue:function(B){this._methods.push(B);},lineTo:function(){this._lineTo.apply(this,[d.Array(arguments),false]);},relativeLineTo:function(){this._lineTo.apply(this,[d.Array(arguments),true]);},_lineTo:function(H,B){var J=H[0],C,E,K,I,F=this._stroke&&this._strokeWeight?this._strokeWeight:0,G=B?parseFloat(this._currentX):0,D=B?parseFloat(this._currentY):0;if(!this._lineToMethods){this._lineToMethods=[];}E=H.length-1;if(typeof J==="string"||typeof J==="number"){for(C=0;C<E;C=C+2){K=parseFloat(H[C]);I=parseFloat(H[C+1]);K=K+G;I=I+D;this._updateDrawingQueue(["lineTo",K,I]);this._trackSize(K-F,I-F);this._trackSize(K+F,I+F);this._updateCoords(K,I);}}else{for(C=0;C<E;C=C+1){K=parseFloat(H[C][0]);I=parseFloat(H[C][1]);this._updateDrawingQueue(["lineTo",K,I]);this._lineToMethods[this._lineToMethods.length]=this._methods[this._methods.length-1];this._trackSize(K-F,I-F);this._trackSize(K+F,I+F);this._updateCoords(K,I);}}this._drawingComplete=false;return this;},moveTo:function(){this._moveTo.apply(this,[d.Array(arguments),false]);},relativeMoveTo:function(){this._moveTo.apply(this,[d.Array(arguments),true]);},_moveTo:function(D,G){var C=this._stroke&&this._strokeWeight?this._strokeWeight:0,F=G?parseFloat(this._currentX):0,E=G?parseFloat(this._currentY):0,B=parseFloat(D[0])+F,H=parseFloat(D[1])+E;this._updateDrawingQueue(["moveTo",B,H]);this._trackSize(B-C,H-C);this._trackSize(B+C,H+C);this._updateCoords(B,H);this._drawingComplete=false;return this;},curveTo:function(){this._curveTo.apply(this,[d.Array(arguments),false]);},relativeCurveTo:function(){this._curveTo.apply(this,[d.Array(arguments),true]);},_curveTo:function(J,C){var L,F,N,M,D,B,K,E=0,H,I=C?parseFloat(this._currentX):0,G=C?parseFloat(this._currentY):0;H=J.length-5;for(;E<H;E=E+6){cp1x=parseFloat(J[E])+I;cp1y=parseFloat(J[E+1])+G;cp2x=parseFloat(J[E+2])+I;cp2y=parseFloat(J[E+3])+G;x=parseFloat(J[E+4])+I;y=parseFloat(J[E+5])+G;this._updateDrawingQueue(["bezierCurveTo",cp1x,cp1y,cp2x,cp2y,x,y]);this._drawingComplete=false;M=Math.max(x,Math.max(cp1x,cp2x));B=Math.max(y,Math.max(cp1y,cp2y));D=Math.min(x,Math.min(cp1x,cp2x));K=Math.min(y,Math.min(cp1y,cp2y));L=Math.abs(M-D);F=Math.abs(B-K);N=[[this._currentX,this._currentY],[cp1x,cp1y],[cp2x,cp2y],[x,y]];this._setCurveBoundingBox(N,L,F);this._currentX=x;this._currentY=y;}},quadraticCurveTo:function(){this._quadraticCurveTo.apply(this,[d.Array(arguments),false]);},relativeQuadraticCurveTo:function(){this._quadraticCurveTo.apply(this,[d.Array(arguments),true]);},_quadraticCurveTo:function(C,R){var F,E,I,H,J,P,S,Q,D,G,K,N=0,O=C.length-3,B=this._stroke&&this._strokeWeight?this._strokeWeight:0,M=R?parseFloat(this._currentX):0,L=R?parseFloat(this._currentY):0;for(;N<O;N=N+4){F=parseFloat(C[N])+M;E=parseFloat(C[N+1])+L;I=parseFloat(C[N+2])+M;H=parseFloat(C[N+3])+L;this._drawingComplete=false;Q=Math.max(I,F);G=Math.max(H,E);D=Math.min(I,F);K=Math.min(H,E);J=Math.abs(Q-D);P=Math.abs(G-K);S=[[this._currentX,this._currentY],[F,E],[I,H]];this._setCurveBoundingBox(S,J,P);this._updateDrawingQueue(["quadraticCurveTo",F,E,I,H]);this._updateCoords(I,H);}return this;},drawCircle:function(D,H,C){var F=0,E=2*Math.PI,B=this._stroke&&this._strokeWeight?this._strokeWeight:0,G=C*2;G+=B;this._drawingComplete=false;this._trackSize(D+G,H+G);this._trackSize(D-B,H-B);this._updateCoords(D,H);this._updateDrawingQueue(["arc",D+C,H+C,C,F,E,false]);return this;},drawDiamond:function(C,G,F,B){var E=F*0.5,D=B*0.5;this.moveTo(C+E,G);this.lineTo(C+F,G+D);this.lineTo(C+E,G+B);this.lineTo(C,G+D);this.lineTo(C+E,G);return this;},drawEllipse:function(M,K,N,S){var P=8,H=-(45/180)*Math.PI,U=0,G,E=N/2,F=S/2,Q=0,J=M+E,I=K+F,O,L,T,R,D,C,B=this._stroke&&this._strokeWeight?this._strokeWeight:0;O=J+Math.cos(0)*E;L=I+Math.sin(0)*F;this.moveTo(O,L);for(;Q<P;Q++){U+=H;G=U-(H/2);T=J+Math.cos(U)*E;R=I+Math.sin(U)*F;D=J+Math.cos(G)*(E/Math.cos(H/2));C=I+Math.sin(G)*(F/Math.cos(H/2));this._updateDrawingQueue(["quadraticCurveTo",D,C,T,R]);}this._trackSize(M+N+B,K+S+B);this._trackSize(M-B,K-B);this._updateCoords(M,K);return this;},drawRect:function(C,F,D,E){var B=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(C,F);this.lineTo(C+D,F);this.lineTo(C+D,F+E);this.lineTo(C,F+E);this.lineTo(C,F);return this;},drawRoundRect:function(C,H,D,F,E,G){var B=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(C,H+G);this.lineTo(C,H+F-G);this.quadraticCurveTo(C,H+F,C+E,H+F);this.lineTo(C+D-E,H+F);this.quadraticCurveTo(C+D,H+F,C+D,H+F-G);this.lineTo(C+D,H+G);this.quadraticCurveTo(C+D,H,C+D-E,H);this.lineTo(C+E,H);
this.quadraticCurveTo(C,H,C,H+G);return this;},drawWedge:function(L,J,P,I,E,F){var B=this._stroke&&this._strokeWeight?this._strokeWeight:0,O,N,H,T,G,M,K,S,R,D,C,Q=0;F=F||E;this._drawingComplete=false;this._updateDrawingQueue(["moveTo",L,J]);F=F||E;if(Math.abs(I)>360){I=360;}O=Math.ceil(Math.abs(I)/45);N=I/O;H=-(N/180)*Math.PI;T=(P/180)*Math.PI;if(O>0){M=L+Math.cos(P/180*Math.PI)*E;K=J+Math.sin(P/180*Math.PI)*F;this.lineTo(M,K);for(;Q<O;++Q){T+=H;G=T-(H/2);S=L+Math.cos(T)*E;R=J+Math.sin(T)*F;D=L+Math.cos(G)*(E/Math.cos(H/2));C=J+Math.sin(G)*(F/Math.cos(H/2));this._updateDrawingQueue(["quadraticCurveTo",D,C,S,R]);}this._updateDrawingQueue(["lineTo",L,J]);}this._trackSize(0-B,0-B);this._trackSize((E*2)+B,(E*2)+B);return this;},end:function(){this._closePath();return this;},closePath:function(){this._updateDrawingQueue(["closePath"]);this._updateDrawingQueue(["beginPath"]);},_getLinearGradient:function(){var N=d.Lang.isNumber,S=this.get("fill"),J=S.stops,G,R,Q,T=0,U=J.length,B,L=0,K=0,M=this.get("width"),V=this.get("height"),P=S.rotation||0,X,W,F,D,E=L+M/2,C=K+V/2,I,H=Math.PI/180,O=parseFloat(parseFloat(Math.tan(P*H)).toFixed(8));if(Math.abs(O)*M/2>=V/2){if(P<180){F=K;D=K+V;}else{F=K+V;D=K;}X=E-((C-F)/O);W=E-((C-D)/O);}else{if(P>90&&P<270){X=L+M;W=L;}else{X=L;W=L+M;}F=((O*(E-X))-C)*-1;D=((O*(E-W))-C)*-1;}B=this._context.createLinearGradient(X,F,W,D);for(;T<U;++T){Q=J[T];G=Q.opacity;R=Q.color;I=Q.offset;if(N(G)){G=Math.max(0,Math.min(1,G));R=this._toRGBA(R,G);}else{R=v(R);}I=Q.offset||T/(U-1);B.addColorStop(I,R);}return B;},_getRadialGradient:function(){var Q=d.Lang.isNumber,W=this.get("fill"),R=W.r,I=W.fx,G=W.fy,K=W.stops,H,T,S,X=0,Z=K.length,C,N=0,M=0,O=this.get("width"),aa=this.get("height"),ab,Y,F,E,V,U,B,P,ac,ad,J,L,D;U=N+O/2;B=M+aa/2;ab=O*I;F=aa*G;Y=N+O/2;E=M+aa/2;V=O*R;ad=Math.sqrt(Math.pow(Math.abs(U-ab),2)+Math.pow(Math.abs(B-F),2));if(ad>=V){L=ad/V;if(L===1){L=1.01;}P=(ab-U)/L;ac=(F-B)/L;P=P>0?Math.floor(P):Math.ceil(P);ac=ac>0?Math.floor(ac):Math.ceil(ac);ab=U+P;F=B+ac;}if(R>=0.5){C=this._context.createRadialGradient(ab,F,R,Y,E,R*O);D=1;}else{C=this._context.createRadialGradient(ab,F,R,Y,E,O/2);D=R*2;}for(;X<Z;++X){S=K[X];H=S.opacity;T=S.color;J=S.offset;if(Q(H)){H=Math.max(0,Math.min(1,H));T=this._toRGBA(T,H);}else{T=v(T);}J=S.offset||X/(Z-1);J*=D;if(J<=1){C.addColorStop(J,T);}}return C;},_initProps:function(){this._methods=[];this._lineToMethods=[];this._xcoords=[0];this._ycoords=[0];this._width=0;this._height=0;this._left=0;this._top=0;this._right=0;this._bottom=0;this._currentX=0;this._currentY=0;},_drawingComplete:false,_createGraphic:function(B){var C=d.config.doc.createElement("canvas");return C;},getBezierData:function(F,E){var G=F.length,D=[],C,B;for(C=0;C<G;++C){D[C]=[F[C][0],F[C][1]];}for(B=1;B<G;++B){for(C=0;C<G-B;++C){D[C][0]=(1-E)*D[C][0]+E*D[parseInt(C+1,10)][0];D[C][1]=(1-E)*D[C][1]+E*D[parseInt(C+1,10)][1];}}return[D[0][0],D[0][1]];},_setCurveBoundingBox:function(M,I,E){var D=0,C=this._currentX,J=C,H=this._currentY,B=H,G=Math.round(Math.sqrt((I*I)+(E*E))),K=1/G,F=this._stroke&&this._strokeWeight?this._strokeWeight:0,L;for(;D<G;++D){L=this.getBezierData(M,K*D);C=isNaN(C)?L[0]:Math.min(L[0],C);J=isNaN(J)?L[0]:Math.max(L[0],J);H=isNaN(H)?L[1]:Math.min(L[1],H);B=isNaN(B)?L[1]:Math.max(L[1],B);}C=Math.round(C*10)/10;J=Math.round(J*10)/10;H=Math.round(H*10)/10;B=Math.round(B*10)/10;this._trackSize(J+F,B+F);this._trackSize(C-F,H-F);},_trackSize:function(B,C){if(B>this._right){this._right=B;}if(B<this._left){this._left=B;}if(C<this._top){this._top=C;}if(C>this._bottom){this._bottom=C;}this._width=this._right-this._left;this._height=this._bottom-this._top;}};d.CanvasDrawing=c;p=function(B){this._transforms=[];this.matrix=new d.Matrix();p.superclass.constructor.apply(this,arguments);};p.NAME="canvasShape";d.extend(p,d.GraphicBase,d.mix({init:function(){this.initializer.apply(this,arguments);},initializer:function(B){var C=this,E=B.graphic,D=this.get("data");C._initProps();C.createNode();C._xcoords=[0];C._ycoords=[0];if(E){this._setGraphic(E);}if(D){C._parsePathData(D);}C._updateHandler();},_setGraphic:function(B){var C;if(B instanceof d.CanvasGraphic){this._graphic=B;}else{B=d.one(B);C=new d.CanvasGraphic({render:B});C._appendShape(this);this._graphic=C;}},addClass:function(B){var C=d.one(this.get("node"));C.addClass(B);},removeClass:function(B){var C=d.one(this.get("node"));C.removeClass(B);},getXY:function(){var E=this.get("graphic"),C=E.getXY(),B=this.get("x"),D=this.get("y");return[C[0]+B,C[1]+D];},setXY:function(D){var F=this.get("graphic"),C=F.getXY(),B=D[0]-C[0],E=D[1]-C[1];this._set("x",B);this._set("y",E);this._updateNodePosition(B,E);},contains:function(B){return B===d.one(this.node);},test:function(B){return d.one(this.get("node")).test(B);},compareTo:function(B){var C=this.node;return C===B;},_getDefaultFill:function(){return{type:"solid",cx:0.5,cy:0.5,fx:0.5,fy:0.5,r:0.5};},_getDefaultStroke:function(){return{weight:1,dashstyle:"none",color:"#000",opacity:1};},_left:0,_right:0,_top:0,_bottom:0,createNode:function(){var B=d.config.doc.createElement("canvas"),C=this.get("id");this._context=B.getContext("2d");B.setAttribute("overflow","visible");B.style.overflow="visible";if(!this.get("visible")){B.style.visibility="hidden";}B.setAttribute("id",C);C="#"+C;this.node=B;this.addClass(f(u)+" "+f(this.name));},on:function(C,B){if(d.Node.DOM_EVENTS[C]){return d.one("#"+this.get("id")).on(C,B);}return d.on.apply(this,arguments);},_setStrokeProps:function(H){var C,G,F,E,D,B;if(H){C=H.color;G=i(H.weight);F=i(H.opacity);E=H.linejoin||"round";D=H.linecap||"butt";B=H.dashstyle;this._miterlimit=null;this._dashstyle=(B&&d.Lang.isArray(B)&&B.length>1)?B:null;this._strokeWeight=G;if(q(G)&&G>0){this._stroke=1;}else{this._stroke=0;}if(q(F)){this._strokeStyle=this._toRGBA(C,F);}else{this._strokeStyle=C;}this._linecap=D;if(E=="round"||E=="bevel"){this._linejoin=E;}else{E=parseInt(E,10);if(q(E)){this._miterlimit=Math.max(E,1);this._linejoin="miter";}}}else{this._stroke=0;}},set:function(){var B=this,C=arguments[0];
o.prototype.set.apply(B,arguments);if(B.initialized){B._updateHandler();}},_setFillProps:function(F){var D=q,B,C,E;if(F){B=F.color;E=F.type;if(E=="linear"||E=="radial"){this._fillType=E;}else{if(B){C=F.opacity;if(D(C)){C=Math.max(0,Math.min(1,C));B=this._toRGBA(B,C);}else{B=v(B);}this._fillColor=B;this._fillType="solid";}else{this._fillColor=null;}}}else{this._fillType=null;this._fillColor=null;}},translate:function(B,C){this._translateX+=B;this._translateY+=C;this._addTransform("translate",arguments);},translateX:function(B){this._translateX+=B;this._addTransform("translateX",arguments);},translateY:function(B){this._translateY+=B;this._addTransform("translateY",arguments);},skew:function(B,C){this._addTransform("skew",arguments);},skewX:function(B){this._addTransform("skewX",arguments);},skewY:function(B){this._addTransform("skewY",arguments);},rotate:function(B){this._rotation=B;this._addTransform("rotate",arguments);},scale:function(B,C){this._addTransform("scale",arguments);},_rotation:0,_transform:"",_addTransform:function(C,B){B=d.Array(B);this._transform=w.trim(this._transform+" "+C+"("+B.join(", ")+")");B.unshift(C);this._transforms.push(B);if(this.initialized){this._updateTransform();}},_updateTransform:function(){var H=this.node,G,E,D=this.get("transformOrigin"),C=this.matrix,F=0,B=this._transforms.length;if(this._transforms&&this._transforms.length>0){for(;F<B;++F){G=this._transforms[F].shift();if(G){C[G].apply(C,this._transforms[F]);}}E=C.toCSSText();}this._graphic.addToRedrawQueue(this);D=(100*D[0])+"% "+(100*D[1])+"%";z.setStyle(H,"transformOrigin",D);if(E){z.setStyle(H,"transform",E);}this._transforms=[];},_updateHandler:function(){this._draw();this._updateTransform();},_draw:function(){var B=this.node;this.clear();this._closePath();B.style.left=this.get("x")+"px";B.style.top=this.get("y")+"px";},_closePath:function(){if(!this._methods){return;}var F=this.get("node"),M=this._right-this._left,J=this._bottom-this._top,C=this._context,G=[],D=this._methods.concat(),I=0,H,B,L,E,K=0;this._context.clearRect(0,0,F.width,F.height);if(this._methods){K=D.length;if(!K||K<1){return;}for(;I<K;++I){G[I]=D[I].concat();L=G[I];E=L[0]=="quadraticCurveTo"?L.length:3;for(H=1;H<E;++H){if(H%2===0){L[H]=L[H]-this._top;}else{L[H]=L[H]-this._left;}}}F.setAttribute("width",Math.min(M,2000));F.setAttribute("height",Math.min(2000,J));C.beginPath();for(I=0;I<K;++I){L=G[I].concat();if(L&&L.length>0){B=L.shift();if(B){if(B=="closePath"){C.closePath();this._strokeAndFill(C);}else{if(B&&B=="lineTo"&&this._dashstyle){L.unshift(this._xcoords[I]-this._left,this._ycoords[I]-this._top);this._drawDashedLine.apply(this,L);}else{C[B].apply(C,L);}}}}}this._strokeAndFill(C);this._drawingComplete=true;this._clearAndUpdateCoords();this._updateNodePosition();this._methods=D;}},_strokeAndFill:function(B){if(this._fillType){if(this._fillType=="linear"){B.fillStyle=this._getLinearGradient();}else{if(this._fillType=="radial"){B.fillStyle=this._getRadialGradient();}else{B.fillStyle=this._fillColor;}}B.closePath();B.fill();}if(this._stroke){if(this._strokeWeight){B.lineWidth=this._strokeWeight;}B.lineCap=this._linecap;B.lineJoin=this._linejoin;if(this._miterlimit){B.miterLimit=this._miterlimit;}B.strokeStyle=this._strokeStyle;B.stroke();}},_drawDashedLine:function(K,Q,B,N){var C=this._context,O=this._dashstyle[0],M=this._dashstyle[1],E=O+M,H=B-K,L=N-Q,P=Math.sqrt(Math.pow(H,2)+Math.pow(L,2)),F=Math.floor(Math.abs(P/E)),D=Math.atan2(L,H),J=K,I=Q,G;H=Math.cos(D)*E;L=Math.sin(D)*E;for(G=0;G<F;++G){C.moveTo(J,I);C.lineTo(J+Math.cos(D)*O,I+Math.sin(D)*O);J+=H;I+=L;}C.moveTo(J,I);P=Math.sqrt((B-J)*(B-J)+(N-I)*(N-I));if(P>O){C.lineTo(J+Math.cos(D)*O,I+Math.sin(D)*O);}else{if(P>0){C.lineTo(J+Math.cos(D)*P,I+Math.sin(D)*P);}}C.moveTo(B,N);},clear:function(){this._initProps();if(this.node){this._context.clearRect(0,0,this.node.width,this.node.height);}return this;},getBounds:function(){var E=this._type,C=this.get("width"),D=this.get("height"),B=this.get("x"),F=this.get("y");if(E=="path"){B=B+this._left;F=F+this._top;C=this._right-this._left;D=this._bottom-this._top;}return this._getContentRect(C,D,B,F);},_getContentRect:function(M,E,K,H){var C=this.get("transformOrigin"),L=C[0]*M,J=C[1]*E,G=this.matrix.getTransformArray(this.get("transform")),I=new d.Matrix(),D=0,F=G.length,B,N,O;if(this._type=="path"){L=L+K;J=J+H;}L=!isNaN(L)?L:0;J=!isNaN(J)?J:0;I.translate(L,J);for(;D<F;D=D+1){B=G[D];N=B.shift();if(N){I[N].apply(I,B);}}I.translate(-L,-J);O=I.getContentRect(M,E,K,H);return O;},toFront:function(){var B=this.get("graphic");if(B){B._toFront(this);}},toBack:function(){var B=this.get("graphic");if(B){B._toBack(this);}},_parsePathData:function(D){var B,F,H,J=d.Lang.trim(D.match(a)),E=0,G,I,C=this._pathSymbolToMethod;if(J){this.clear();G=J.length||0;for(;E<G;E=E+1){I=J[E];F=I.substr(0,1),H=I.substr(1).match(n);B=C[F];if(B){if(H){this[B].apply(this,H);}else{this[B].apply(this);}}}this.end();}},destroy:function(){var B=this.get("graphic");if(B){B.removeShape(this);}else{this._destroy();}},_destroy:function(){if(this.node){d.one(this.node).remove(true);this._context=null;this.node=null;}}},d.CanvasDrawing.prototype));p.ATTRS={transformOrigin:{valueFn:function(){return[0.5,0.5];}},transform:{setter:function(B){this.matrix.init();this._transforms=this.matrix.getTransformArray(B);this._transform=B;return B;},getter:function(){return this._transform;}},node:{readOnly:true,getter:function(){return this.node;}},id:{valueFn:function(){return d.guid();},setter:function(C){var B=this.node;if(B){B.setAttribute("id",C);}return C;}},width:{value:0},height:{value:0},x:{value:0},y:{value:0},visible:{value:true,setter:function(D){var C=this.get("node"),B=D?"visible":"hidden";if(C){C.style.visibility=B;}return D;}},fill:{valueFn:"_getDefaultFill",setter:function(D){var C,B=this.get("fill")||this._getDefaultFill();C=(D)?d.merge(B,D):null;if(C&&C.color){if(C.color===undefined||C.color=="none"){C.color=null;}}this._setFillProps(C);return C;}},stroke:{valueFn:"_getDefaultStroke",setter:function(D){var C=this.get("stroke")||this._getDefaultStroke(),B;
if(D&&D.hasOwnProperty("weight")){B=parseInt(D.weight,10);if(!isNaN(B)){D.weight=B;}}D=(D)?d.merge(C,D):null;this._setStrokeProps(D);return D;}},autoSize:{value:false},pointerEvents:{value:"visiblePainted"},data:{setter:function(B){if(this.get("node")){this._parsePathData(B);}return B;}},graphic:{readOnly:true,getter:function(){return this._graphic;}}};d.CanvasShape=p;r=function(B){r.superclass.constructor.apply(this,arguments);};r.NAME="canvasPath";d.extend(r,d.CanvasShape,{_type:"path",_draw:function(){this._closePath();this._updateTransform();},createNode:function(){var B=d.config.doc.createElement("canvas"),C=this.get("id");this._context=B.getContext("2d");B.setAttribute("overflow","visible");B.setAttribute("pointer-events","none");B.style.pointerEvents="none";B.style.overflow="visible";B.setAttribute("id",C);C="#"+C;this.node=B;this.addClass(f(u)+" "+f(this.name));},end:function(){this._draw();}});r.ATTRS=d.merge(d.CanvasShape.ATTRS,{width:{getter:function(){var B=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._width-B;},setter:function(B){this._width=B;return B;}},height:{getter:function(){var B=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._height-B;},setter:function(B){this._height=B;return B;}},path:{readOnly:true,getter:function(){return this._path;}}});d.CanvasPath=r;A=function(){A.superclass.constructor.apply(this,arguments);};A.NAME="canvasRect";d.extend(A,d.CanvasShape,{_type:"rect",_draw:function(){var B=this.get("width"),C=this.get("height");this.clear();this.drawRect(0,0,B,C);this._closePath();}});A.ATTRS=d.CanvasShape.ATTRS;d.CanvasRect=A;s=function(B){s.superclass.constructor.apply(this,arguments);};s.NAME="canvasEllipse";d.extend(s,p,{_type:"ellipse",_draw:function(){var B=this.get("width"),C=this.get("height");this.clear();this.drawEllipse(0,0,B,C);this._closePath();}});s.ATTRS=d.merge(p.ATTRS,{xRadius:{setter:function(B){this.set("width",B*2);},getter:function(){var B=this.get("width");if(B){B*=0.5;}return B;}},yRadius:{setter:function(B){this.set("height",B*2);},getter:function(){var B=this.get("height");if(B){B*=0.5;}return B;}}});d.CanvasEllipse=s;l=function(B){l.superclass.constructor.apply(this,arguments);};l.NAME="canvasCircle";d.extend(l,d.CanvasShape,{_type:"circle",_draw:function(){var B=this.get("radius");if(B){this.clear();this.drawCircle(0,0,B);this._closePath();}}});l.ATTRS=d.merge(d.CanvasShape.ATTRS,{width:{setter:function(B){this.set("radius",B/2);return B;},getter:function(){return this.get("radius")*2;}},height:{setter:function(B){this.set("radius",B/2);return B;},getter:function(){return this.get("radius")*2;}},radius:{lazyAdd:false}});d.CanvasCircle=l;h=function(){h.superclass.constructor.apply(this,arguments);};h.NAME="canvasPieSlice";d.extend(h,d.CanvasShape,{_type:"path",_draw:function(F){var C=this.get("cx"),G=this.get("cy"),E=this.get("startAngle"),D=this.get("arc"),B=this.get("radius");this.clear();this._left=C;this._right=B;this._top=G;this._bottom=B;this.drawWedge(C,G,E,D,B);this.end();}});h.ATTRS=d.mix({cx:{value:0},cy:{value:0},startAngle:{value:0},arc:{value:0},radius:{value:0}},d.CanvasShape.ATTRS);d.CanvasPieSlice=h;function e(B){e.superclass.constructor.apply(this,arguments);}e.NAME="canvasGraphic";e.ATTRS={render:{},id:{valueFn:function(){return d.guid();},setter:function(C){var B=this._node;if(B){B.setAttribute("id",C);}return C;}},shapes:{readOnly:true,getter:function(){return this._shapes;}},contentBounds:{readOnly:true,getter:function(){return this._contentBounds;}},node:{readOnly:true,getter:function(){return this._node;}},width:{setter:function(B){if(this._node){this._node.style.width=B+"px";}return B;}},height:{setter:function(B){if(this._node){this._node.style.height=B+"px";}return B;}},autoSize:{value:false},preserveAspectRatio:{value:"xMidYMid"},resizeDown:{value:false},x:{getter:function(){return this._x;},setter:function(B){this._x=B;if(this._node){this._node.style.left=B+"px";}return B;}},y:{getter:function(){return this._y;},setter:function(B){this._y=B;if(this._node){this._node.style.top=B+"px";}return B;}},autoDraw:{value:true},visible:{value:true,setter:function(B){this._toggleVisible(B);return B;}}};d.extend(e,d.GraphicBase,{set:function(C,G){var F=this,B={autoDraw:true,autoSize:true,preserveAspectRatio:true,resizeDown:true},E,D=false;o.prototype.set.apply(F,arguments);if(F._state.autoDraw===true&&d.Object.size(this._shapes)>0){if(w.isString&&B[C]){D=true;}else{if(w.isObject(C)){for(E in B){if(B.hasOwnProperty(E)&&C[E]){D=true;break;}}}}}if(D){F._redraw();}},_x:0,_y:0,getXY:function(){var B=d.one(this._node),C;if(B){C=B.getXY();}return C;},initializer:function(D){var F=this.get("render"),C=this.get("visible")?"visible":"hidden",B=this.get("width")||0,E=this.get("height")||0;this._shapes={};this._redrawQueue={};this._contentBounds={left:0,top:0,right:0,bottom:0};this._node=g.createElement("div");this._node.style.position="absolute";this._node.style.visibility=C;this.set("width",B);this.set("height",E);if(F){this.render(F);}},render:function(E){var B=d.one(E),F=this._node,C=this.get("width")||parseInt(B.getComputedStyle("width"),10),D=this.get("height")||parseInt(B.getComputedStyle("height"),10);B=B||g.body;B.appendChild(F);F.style.display="block";F.style.position="absolute";F.style.left="0px";F.style.top="0px";this.set("width",C);this.set("height",D);this.parentNode=B;return this;},destroy:function(){this.removeAllShapes();if(this._node){this._removeChildren(this._node);d.one(this._node).destroy();}},addShape:function(B){B.graphic=this;if(!this.get("visible")){B.visible=false;}var D=this._getShapeClass(B.type),C=new D(B);this._appendShape(C);return C;},_appendShape:function(C){var D=C.node,B=this._frag||this._node;if(this.get("autoDraw")){B.appendChild(D);}else{this._getDocFrag().appendChild(D);}},removeShape:function(B){if(!(B instanceof p)){if(w.isString(B)){B=this._shapes[B];}}if(B&&B instanceof p){B._destroy();delete this._shapes[B.get("id")];}if(this.get("autoDraw")){this._redraw();
}return B;},removeAllShapes:function(){var B=this._shapes,C;for(C in B){if(B.hasOwnProperty(C)){B[C].destroy();}}this._shapes={};},clear:function(){this.removeAllShapes();},_removeChildren:function(B){if(B&&B.hasChildNodes()){var C;while(B.firstChild){C=B.firstChild;this._removeChildren(C);B.removeChild(C);}}},_toggleVisible:function(E){var D,C=this._shapes,B=E?"visible":"hidden";if(C){for(D in C){if(C.hasOwnProperty(D)){C[D].set("visible",E);}}}if(this._node){this._node.style.visibility=B;}},_getShapeClass:function(C){var B=this._shapeClass[C];if(B){return B;}return C;},_shapeClass:{circle:d.CanvasCircle,rect:d.CanvasRect,path:d.CanvasPath,ellipse:d.CanvasEllipse,pieslice:d.CanvasPieSlice},getShapeById:function(C){var B=this._shapes[C];return B;},batch:function(C){var B=this.get("autoDraw");this.set("autoDraw",false);C();this.set("autoDraw",B);},_getDocFrag:function(){if(!this._frag){this._frag=g.createDocumentFragment();}return this._frag;},_redraw:function(){var H=this.get("autoSize"),F=this.get("preserveAspectRatio"),I=this.get("resizeDown")?this._getUpdatedContentBounds():this._contentBounds,B,L,M,J,N,E,D=0,C=0,K,G=this.get("node");if(H){if(H=="sizeContentToGraphic"){B=I.right-I.left;L=I.bottom-I.top;M=parseFloat(z.getComputedStyle(G,"width"));J=parseFloat(z.getComputedStyle(G,"height"));K=new d.Matrix();if(F=="none"){N=M/B;E=J/L;}else{if(B/L!==M/J){if(B*J/L>M){N=E=M/B;C=this._calculateTranslate(F.slice(5).toLowerCase(),L*M/B,J);}else{N=E=J/L;D=this._calculateTranslate(F.slice(1,4).toLowerCase(),B*J/L,M);}}}z.setStyle(G,"transformOrigin","0% 0%");D=D-(I.left*N);C=C-(I.top*E);K.translate(D,C);K.scale(N,E);z.setStyle(G,"transform",K.toCSSText());}else{this.set("width",I.right);this.set("height",I.bottom);}}if(this._frag){this._node.appendChild(this._frag);this._frag=null;}},_calculateTranslate:function(B,E,D){var C=D-E,F;switch(B){case"mid":F=C*0.5;break;case"max":F=C;break;default:F=0;break;}return F;},addToRedrawQueue:function(B){var D,C;this._shapes[B.get("id")]=B;if(!this.get("resizeDown")){D=B.getBounds();C=this._contentBounds;C.left=C.left<D.left?C.left:D.left;C.top=C.top<D.top?C.top:D.top;C.right=C.right>D.right?C.right:D.right;C.bottom=C.bottom>D.bottom?C.bottom:D.bottom;this._contentBounds=C;}if(this.get("autoDraw")){this._redraw();}},_getUpdatedContentBounds:function(){var F,D,C,B=this._shapes,E={};for(D in B){if(B.hasOwnProperty(D)){C=B[D];F=C.getBounds();E.left=w.isNumber(E.left)?Math.min(E.left,F.left):F.left;E.top=w.isNumber(E.top)?Math.min(E.top,F.top):F.top;E.right=w.isNumber(E.right)?Math.max(E.right,F.right):F.right;E.bottom=w.isNumber(E.bottom)?Math.max(E.bottom,F.bottom):F.bottom;}}E.left=w.isNumber(E.left)?E.left:0;E.top=w.isNumber(E.top)?E.top:0;E.right=w.isNumber(E.right)?E.right:0;E.bottom=w.isNumber(E.bottom)?E.bottom:0;this._contentBounds=E;return E;},_toFront:function(C){var B=this.get("node");if(C instanceof d.CanvasShape){C=C.get("node");}if(B&&C){B.appendChild(C);}},_toBack:function(C){var B=this.get("node"),D;if(C instanceof d.CanvasShape){C=C.get("node");}if(B&&C){D=B.firstChild;if(D){B.insertBefore(C,D);}else{B.appendChild(C);}}}});d.CanvasGraphic=e;},"@VERSION@",{"requires":["graphics"]});