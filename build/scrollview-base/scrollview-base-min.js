YUI.add("scrollview-base",function(Y,NAME){var getClassName=Y.ClassNameManager.getClassName,DOCUMENT=Y.config.doc,WINDOW=Y.config.win,IE=Y.UA.ie,NATIVE_TRANSITIONS=Y.Transition.useNative,SCROLLVIEW="scrollview",CLASS_NAMES={vertical:getClassName(SCROLLVIEW,"vert"),horizontal:getClassName(SCROLLVIEW,"horiz")},EV_SCROLL_END="scrollEnd",FLICK="flick",DRAG="drag",MOUSEWHEEL="mousewheel",UI="ui",TOP="top",RIGHT="right",BOTTOM="bottom",LEFT="left",PX="px",AXIS="axis",SCROLL_Y="scrollY",SCROLL_X="scrollX",BOUNCE="bounce",DISABLED="disabled",DECELERATION="deceleration",DIM_X="x",DIM_Y="y",BOUNDING_BOX="boundingBox",CONTENT_BOX="contentBox",GESTURE_MOVE="gesturemove",START="start",END="end",EMPTY="",ZERO="0s",_constrain=function(val,min,max){return Math.min(Math.max(val,min),max)};function ScrollView(){ScrollView.superclass.constructor.apply(this,arguments)}Y.ScrollView=Y.extend(ScrollView,Y.Widget,{_forceHWTransforms:Y.UA.webkit?!0:!1,_prevent:{start:!1,move:!0,end:!1},initializer:function(config){var sv=this;sv._bb=sv.get(BOUNDING_BOX),sv._cb=sv.get(CONTENT_BOX),sv._cDecel=sv.get(DECELERATION),sv._cBounce=sv.get(BOUNCE),sv._cAxis=sv.get(AXIS)},bindUI:function(){var sv=this;sv._bindFlick(sv.get(FLICK)),sv._bindDrag(sv.get(DRAG)),sv._bindMousewheel(sv.get(MOUSEWHEEL)),sv._bindAttrs(),IE&&sv._fixIESelect(sv._bb,sv._cb)},_bindAttrs:function(){var sv=this,scrollChangeHandler=sv._afterScrollChange,dimChangeHandler=sv._afterDimChange;sv.after({scrollEnd:sv._afterScrollEnd,disabledChange:sv._afterDisabledChange,flickChange:sv._afterFlickChange,dragChange:sv._afterDragChange,axisChange:sv._afterAxisChange,scrollYChange:scrollChangeHandler,scrollXChange:scrollChangeHandler,heightChange:dimChangeHandler,widthChange:dimChangeHandler}),Y.one(WINDOW).after("resize",dimChangeHandler,sv)},_bindDrag:function(drag){var sv=this,bb=sv._bb;bb.detach(DRAG+"|*"),drag&&bb.on(DRAG+"|"+GESTURE_MOVE+START,Y.bind(sv._onGestureMoveStart,sv))},_bindFlick:function(flick){var sv=this,bb=sv._bb;bb.detach(FLICK+"|*"),flick&&bb.on(FLICK+"|"+FLICK,Y.bind(sv._flick,sv),flick)},_bindMousewheel:function(mousewheel){var sv=this,bb=sv._bb;bb.detach(MOUSEWHEEL+"|*"),mousewheel&&Y.one(DOCUMENT).on(MOUSEWHEEL,Y.bind(sv._mousewheel,sv))},syncUI:function(){var sv=this,scrollDims=sv._getScrollDims(),width=scrollDims.offsetWidth,height=scrollDims.offsetHeight,scrollWidth=scrollDims.scrollWidth,scrollHeight=scrollDims.scrollHeight;sv._cAxis===undefined&&sv._set(AXIS,{x:scrollWidth>width,y:scrollHeight>height}),sv.rtl=sv._cb.getComputedStyle("direction")==="rtl",sv._cDisabled=sv.get(DISABLED),sv._uiDimensionsChange(),sv._isOOB()&&sv._snapBack()},_getScrollDims:function(){var sv=this,cb=sv._cb,bb=sv._bb,TRANS=ScrollView._TRANSITION,dims;return NATIVE_TRANSITIONS&&(cb.setStyle(TRANS.DURATION,ZERO),cb.setStyle(TRANS.PROPERTY,EMPTY)),dims={offsetWidth:bb.get("offsetWidth"),offsetHeight:bb.get("offsetHeight"),scrollWidth:bb.get("scrollWidth"),scrollHeight:bb.get("scrollHeight")},dims},_uiDimensionsChange:function(){var sv=this,bb=sv._bb,scrollDims=sv._getScrollDims(),width=scrollDims.offsetWidth,height=scrollDims.offsetHeight,scrollWidth=scrollDims.scrollWidth,scrollHeight=scrollDims.scrollHeight,rtl=sv.rtl,svAxis=sv._cAxis,svAxisX=svAxis.x,svAxisY=svAxis.y;svAxisX&&bb.addClass(CLASS_NAMES.horizontal),svAxisY&&bb.addClass(CLASS_NAMES.vertical),sv._minScrollX=rtl?-(scrollWidth-width):0,sv._maxScrollX=rtl?0:scrollWidth-width,sv._minScrollY=0,sv._maxScrollY=scrollHeight-height},scrollTo:function(x,y,duration,easing,node){if(this._cDisabled)return;var sv=this,cb=sv._cb,TRANS=ScrollView._TRANSITION,callback=Y.bind(sv._onTransEnd,sv),newX=0,newY=0,transition={},transform;duration=duration||0,easing=easing||ScrollView.EASING,node=node||cb,x!==null&&(sv.set(SCROLL_X,x,{src:UI}),newX=-x),y!==null&&(sv.set(SCROLL_Y,y,{src:UI}),newY=-y),transform=sv._transform(newX,newY),NATIVE_TRANSITIONS&&node.setStyle(TRANS.DURATION,ZERO).setStyle(TRANS.PROPERTY,EMPTY),duration===0?NATIVE_TRANSITIONS?node.setStyle("transform",transform):(x!==null&&node.setStyle(LEFT,newX+PX),y!==null&&node.setStyle(TOP,newY+PX)):(transition.easing=easing,transition.duration=duration/1e3,NATIVE_TRANSITIONS?transition.transform=transform:(transition.left=newX+PX,transition.top=newY+PX),node.transition(transition,callback))},_transform:function(x,y){var prop="translate("+x+"px, "+y+"px)";return this._forceHWTransforms&&(prop+=" translateZ(0)"),prop},_onTransEnd:function(e){var sv=this;sv.fire(EV_SCROLL_END)},_onGestureMoveStart:function(e){if(this._cDisabled)return!1;var sv=this,bb=sv._bb,currentX=sv.get(SCROLL_X),currentY=sv.get(SCROLL_Y),clientX=e.clientX,clientY=e.clientY;sv._prevent.start&&e.preventDefault(),sv._flickAnim&&sv._flickAnim.cancel(),e.stopPropagation(),sv._gesture={axis:null,startX:currentX,startY:currentY,startClientX:clientX,startClientY:clientY,endClientX:null,endClientY:null,deltaX:null,deltaY:null,flick:null,onGestureMove:bb.on(DRAG+"|"+GESTURE_MOVE,Y.bind(sv._onGestureMove,sv)),onGestureMoveEnd:bb.on(DRAG+"|"+GESTURE_MOVE+END,Y.bind(sv._onGestureMoveEnd,sv))}},_onGestureMove:function(e){var sv=this,gesture=sv._gesture,svAxis=sv._cAxis,svAxisX=svAxis.x,svAxisY=svAxis.y,startX=gesture.startX,startY=gesture.startY,startClientX=gesture.startClientX,startClientY=gesture.startClientY,clientX=e.clientX,clientY=e.clientY;sv._prevent.move&&e.preventDefault(),gesture.deltaX=startClientX-clientX,gesture.deltaY=startClientY-clientY,gesture.axis===null&&(gesture.axis=Math.abs(gesture.deltaX)>Math.abs(gesture.deltaY)?DIM_X:DIM_Y),gesture.axis===DIM_X&&svAxisX?sv.set(SCROLL_X,startX+gesture.deltaX):gesture.axis===DIM_Y&&svAxisY&&sv.set(SCROLL_Y,startY+gesture.deltaY)},_onGestureMoveEnd:function(e){var sv=this,gesture=sv._gesture,flick=gesture.flick,clientX=e.clientX,clientY=e.clientY,isOOB;sv._prevent.end&&e.preventDefault(),gesture.endClientX=clientX,gesture.endClientY=clientY,!flick&&gesture.deltaX!==null&&gesture.deltaY!==null&&(sv._isOOB()?sv._snapBack():sv.pages&&!sv.pages.get(AXIS)[gesture.axis]&&sv._onTransEnd())},_flick:function(e){if(this._cDisabled)return!1;var sv=this,gesture=sv._gesture,svAxis=sv._cAxis,svAxisX=svAxis.x,svAxisY=svAxis.y,flick=e.flick,flickAxis=flick.axis;gesture.flick=flick,(flickAxis===DIM_X&&svAxisX||flickAxis===DIM_Y&&svAxisY)&&sv._flickFrame(flick.velocity)},_flickFrame:function(velocity){var sv=this,gesture=sv._gesture,flickAxis=gesture.flick.axis,currentX=sv.get(SCROLL_X),currentY=sv.get(SCROLL_Y),minX=sv._minScrollX,maxX=sv._maxScrollX,minY=sv._minScrollY,maxY=sv._maxScrollY,deceleration=sv._cDecel,bounce=sv._cBounce,svAxis=sv._cAxis,svAxisX=svAxis.x,svAxisY=svAxis.y,step=ScrollView.FRAME_STEP,newX=currentX-velocity*step,newY=currentY-velocity*step;velocity*=deceleration;if(sv._isOOB())sv._snapBack();else if(Math.abs(velocity).toFixed(4)<=.015)sv._onTransEnd();else{if(flickAxis===DIM_X&&svAxisX){if(newX<minX||newX>maxX)velocity*=bounce;sv.set(SCROLL_X,newX)}else if(flickAxis===DIM_Y&&svAxisY){if(newY<minY||newY>maxY)velocity*=bounce;sv.set(SCROLL_Y,newY)}sv._flickAnim=Y.later(step,sv,"_flickFrame",[velocity])}},_mousewheel:function(e){var sv=this,scrollY=sv.get(SCROLL_Y),bb=sv._bb,scrollOffset=10,isForward=e.wheelDelta>0,scrollToY=scrollY-(isForward?1:-1)*scrollOffset;scrollToY=_constrain(scrollToY,sv._minScrollY,sv._maxScrollY),bb.contains(e.target)&&(sv.set(SCROLL_Y,scrollToY),sv.scrollbars&&(sv.scrollbars._update(),sv.scrollbars.flash()),sv._onTransEnd(),e.preventDefault())},_isOOB:function(){var sv=this,svAxis=sv._cAxis,svAxisX=svAxis.x,svAxisY=svAxis.y,currentX=sv.get(SCROLL_X),currentY=sv.get(SCROLL_Y),minX=sv._minScrollX,minY=sv._minScrollY,maxX=sv._maxScrollX,maxY=sv._maxScrollY;return svAxisX&&(currentX<minX||currentX>maxX)||svAxisY&&(currentY<minY||currentY>maxY)},_snapBack:function(){var sv=this,currentX=sv.get(SCROLL_X),currentY=sv.get(SCROLL_Y),minX=sv._minScrollX,minY=sv._minScrollY,maxX=sv._maxScrollX,maxY=sv._maxScrollY,newY=_constrain(currentY,minY,maxY),newX=_constrain(currentX,minX,maxX),duration=ScrollView.SNAP_DURATION;newX!==currentX?sv.set(SCROLL_X,newX,{duration:duration}):newY!==currentY?sv.set(SCROLL_Y,newY,{duration:duration}):sv._onTransEnd()},_afterScrollChange:function(e){if(e.src===ScrollView.UI_SRC)return!1;var sv=this,duration=e.duration,easing=e.easing,val=e.newVal,scrollToArgs=[];e.attrName===SCROLL_X?(scrollToArgs.push(val),scrollToArgs.push(sv.get(SCROLL_Y))):(scrollToArgs.push(sv.get(SCROLL_X)),scrollToArgs.push(val)),scrollToArgs.push(duration),scrollToArgs.push(easing),sv.scrollTo.apply(sv,scrollToArgs)},_afterFlickChange:function(e){this._bindFlick(e.newVal)},_afterDisabledChange:function(e){this._cDisabled=e.newVal},_afterAxisChange:function(e){this._cAxis=e.newVal},_afterDragChange:function(e){this._bindDrag(e.newVal)},_afterMousewheelChange:function(e){this._bindMousewheel(e.newVal)},_afterDimChange:function(){this._uiDimensionsChange()},_afterScrollEnd:function(e){var sv=this,gesture=sv._gesture;gesture&&gesture.onGestureMove&&gesture.onGestureMove.detach&&gesture.onGestureMove.detach(),gesture&&gesture.onGestureMoveEnd&&gesture.onGestureMoveEnd.detach&&gesture.onGestureMoveEnd.detach(),sv._flickAnim&&(sv._flickAnim.cancel&&sv._flickAnim.cancel(),delete sv._flickAnim)},_axisSetter:function(val,name){if(Y.Lang.isString(val))return{x:val.match(/x/i)?!0:!1,y:val.match(/y/i)?!0:!1}}},{NAME:"scrollview",ATTRS:{axis:{setter:"_axisSetter",writeOnce:"initOnly"},scrollY:{value:0},scrollX:{value:0},deceleration:{value:.93},bounce:{value:.1},flick:{value:{minDistance:10,minVelocity:.3}},drag:{value:!0},mousewheel:{value:!0}},CLASS_NAMES:CLASS_NAMES,UI_SRC:UI,BOUNCE_RANGE:150,FRAME_STEP:16,EASING:"cubic-bezier(0, 0.1, 0, 1.0)",SNAP_EASING:"ease-out",SNAP_DURATION:400,_TRANSITION:{DURATION:Y.Transition._VENDOR_PREFIX+"TransitionDuration",PROPERTY:Y.Transition._VENDOR_PREFIX+"TransitionProperty"}})},"@VERSION@",{requires:["widget","event-gestures","event-mousewheel","transition"],skinnable:!0})