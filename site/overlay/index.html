<?php 
$title="The Overlay Widget";
$section="overlay";
$component="Overlay";
$highlightSyntax = true;
$releasenotes = true;
include "../inc/header.inc";
?>
<div id="yui-main">
    <div class="yui-b">
        <div class="yui-ge">
            <div class="yui-u first" id="main">
            <!-- main column -->

                <h2><?php echo $component;?></h2>

                <div id="promo" class="component">

                    <p>Overlay is a positionable and stackable widget, which also provides support for the standard module format layout, with a header, body and footer section.

                    The overlay is built by extending <a href="../api/Widget.html"><code>Widget</code></a> and adding the <a href="../api/WidgetPosition.html"><code>WidgetPosition</code></a>, <a href="../api/WidgetStack.html"><code>WidgetStack</code></a>, <a href="../api/WidgetPositionExt.html"><code>WidgetPositionExt</code></a> and <a href="../api/WidgetStdMod.html"><code>WidgetStdMod</code></a> extensions, 
                    and doesn't actually need to add any implementation code of its own. The <a href="../examples/widget/widget-build.html">"Building Custom Widget Classes"</code></a> example shows how you can use these extensions to build classes which mix and match the above features.</p>

                    <p>
                        For the 3.0.0 PR2 release, the Overlay supports basic XY page positioning, alignment and centering relative to a node or the viewport, header, body, footer section support with progressive enhancement and zIndex with shimming support. Future versions will introduce support for event triggers to maintain alignment/centering, managed stacking (bring to top), constrained positioning.
                    </p>

                    <div class="yui-g">
                        <div class="yui-u first">
                            <div id="jumps">
                                <h4>On This Page</h4>
                                <ul>
                                    <li><a href="#start">Getting Started</a></li>
                                    <li><a href="#using">Using the <?php echo $component;?></a>
                                        <ul class="topspace">
                                            <li><a href="#instantiating">Instantiating The Overlay</a></li>
                                            <li><a href="#attributes">Attributes</a></li>
                                            <li><a href="#positioning">Positioning</a></li>
                                            <li><a href="#stacking">Stacking</a></li>
                                            <li><a href="#content">Setting Section Content</a></li>
                                            <li><a href="#markup">Markup Structure</a></li>
                                            <li><a href="#css">CSS</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="#support">Support &amp; Community</a></li>
                                    <li><a href="#filingbugs">Bug Reports &amp; Feature Requests</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="yui-u">
                            <?php
                            include('../inc/quicklinks.inc');
                            ?>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div><!-- /promo -->

                <?php
                    $componentShort = "Overlay";
                    $requiredModules = array("overlay");
                    include("../inc/gettingStarted.inc");
                ?>

                <h3 id="using">Using the <?php echo $component;?></h3>

                <p>This section describes how to use the <?php echo $component;?> in further detail.
                It contains these subsections:</p>

                <ul class="topspace">
                    <li><a href="#instantiating">Instantiating The Overlay</a></li>
                    <li><a href="#attributes">Attributes</a></li>
                    <li><a href="#positioning">Positioning</a></li>
                    <li><a href="#stacking">Stacking</a></li>
                    <li><a href="#content">Setting Section Content</a></li>
                    <li><a href="#markup">Markup Structure</a></li>
                    <li><a href="#css">CSS</a></li>
                </ul>

            <h4 id="instantiating">Instantiating The Overlay</h4>

            <p>The Overlay widget extends the <code>Widget</code> class, and hence the Overlay constructor follows the same pattern as any Widget constructor, accepting a configuration object to set the initial configuration for the widget.</p>

            <h5>Instantiating From Markup: Progressive Enhancement</h5>

            <p>The overlay can be instantiated from markup, by specifying the <code>contentBox</code> which contains the header, body and footer content for the overlay:</p>

            <textarea name="code" class="HTML" rows="1" cols="60">
                &lt;div id="myContent"&gt;
                    &lt;div class="yui-widget-hd"&gt;Overlay Header&lt;/div&gt;
                    &lt;div class="yui-widget-bd"&gt;Overlay Body&lt;/div&gt;
                    &lt;div class="yui-widget-ft"&gt;Overlay Footer&lt;/div&gt;
                &lt;/div&gt;
            </textarea>

            <p>The header, body and footer sections provided in markup need to be marked with the class name which <code>Overlay</code> (or more accurately, <code>WidgetStdMod</code>) expects for the section ("yui-widget-hd", "yui-widget-bd" and "yui-widget-ft") as shown above. 
            All of these sections are optional, and if content is set via the API at a later point will be created dynamically.</p>

            <p>When instantiating from markup, a reference to the <code>contentBox</code> is provided in the configuration object. This reference can be a node reference, or a selector string which can be used to identify the node. If the selector string is too broad (returns multiple nodes), the first node found will be used.
            The following code targets the markup shown above:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                YUI({...}).use("overlay", function(Y) {

                    ...
                    var overlay = new Y.Overlay({
                        // Specify a reference to a content box, 
                        // which already exists on the page and contains
                        // header/body/footer content
                        contentBox:"#myContent",

                        // Also set some of the attributes inherited from
                        // the base Widget class.
                        visible:false,
                        width:"20em"
                    });
                    ...

                });
            </textarea>

            <p>Following instantiation, a call to <code>render</code> is required to have the Overlay's state reflected in the DOM, as with all YUI 3 widgets:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                var overlay = new Y.Overlay({ ... });
                overlay.render();
            </textarea>

            <p>Note that you could set the state of the Overlay multiple times (modifying content, changing dimensions etc.) before rendering. 
            When the <code>render</code> method is invoked, the state of the Overlay at that point in time will be reflected in the DOM.</p>

            <p>When <code>render</code> is invoked, the overlay's content box will be wrapped by the bounding box (another DIV), to provide the <a href="../widget/index.html#markup">nested box structure</a> common to all widgets.</p>

            <h5>Instantiating From Script</h5>

            <p>You can also create Overlay instances entirely from script, setting content programmatically, using the <code>headerContent</code>, <code>bodyContent</code> and <code>footerContent</code> attributes.</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                    var overlay = new Y.Overlay({
                        headerContent:"My Overlay Header",
                        bodyContent:"My Overlay Body",
                        footerContent:"My Footer Content",
                        ...
                    });
                    overlay.render("#parentNode");
                });
            </textarea>

            <p>Content can be strings containing markup (innerHTML will be used to set the content), or <code>Node</code> references, in which case they will be appended to the section (header, body or footer) node.</p>

            <p>The <code>render</code> method can be passed a node reference (or a selector string) as shown above, to specify the node
            under which the overlay's bounding box should be added to the DOM. When rendering an overlay instance which has not been created from markup 
            (so it does not have a position in the DOM) if this argument is not provided the overlay will be added to the document's body element (inserted as the first child to avoid the potential for "operation aborted" errors in IE6).
            </p>

            <h4 id="attributes">Attributes</h4>
            
            <p>On top of the attributes provided by <a href="../widget/index.html#attributes">Widget</a>, Overlay adds the following key attributes (through the extensions mentioned above)</p>

            <table>
                <tr><th>Attribute</th><th>Description</th></tr>
                <tr><td><code>x</code>, <code>y</code> and <code>xy</code></td><td>Positioning attributes, to set the XY position in page co-ordinates on the Overlay's bounding box. Set to [0,0] by default</td></tr>
                <tr><td><code>zIndex</code></td><td>Sets the z-index on the Overlay's bounding box. Set to 0 by default.</td></tr>
                <tr><td><code>shim</code></td><td>Boolean, indicating whether or not an iframe shim should be added to the Overlay to protect against select box bleed through. It is only enabled by default for IE6.</td></tr>
                <tr><td><code>align</code></td><td>Used to align a specific point on the Overlay's bounding box to a specific point on another node, or the viewport. Set to null by default.</td></tr>
                <tr><td><code>centered</code></td><td>Used to center the Overlay inside another node, or inside the viewport. Set to false by default.</td></tr>
                <tr><td><code>headerContent</code></td><td>Used to set the content of the Overlay's header section. No default value set.</td></tr>
                <tr><td><code>bodyContent</code></td><td>Used to set the content of the Overlay's body section. No default value set.</td></tr>
                <tr><td><code>footerContent</code></td><td>Used to set the content of the Overlay's footer section. No default value set.</td></tr>
                <tr><td><code>fillHeight</code></td><td>Specifies which of the 3 sections - header, body or footer, should be automatically sized to fill out the height of the Overlay, if a fixed height has been set. Set to WidgetStdMod.BODY by default. Can be disabled by setting to null.</td></tr>
            </table>

            <h4 id="positioning">Positioning</h4>
            
            <h5>Basic XY Positioning</h5>

            <p>Overlay provides basic XY positioning support through its <code>x</code>, <code>y</code> and <code>xy</code> attributes as well as a convenience <code>move</code> method which wraps the <code>xy</code> attribute.</p>

            <p>The xy position of the overlay can be set in the constructor, as with any attribute value:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                    var overlay = new Y.Overlay({
                        contentBox:"myContent",
                        xy: [200,100]
                    });
                    overlay.render();

                    // or

                    var overlay = new Y.Overlay({
                        contentBox:"myContent",
                        x: 200,
                        y: 100
                    });
                    overlay.render();

                    // or

                    var overlay = new Y.Overlay({
                        contentBox:"myContent",
                        x: 200 // y defaults to 0
                    });
                    overlay.render();
            </textarea>

            <p>The overlay's default position, if xy values are not provided, will be 0,0. Note that xy are page co-ordinates, not relative co-ordinates.</p>

            <p>Changes in the overlay's position (when set programmatically through the API) can be monitored by listening for the attribute <code>xyChange</code> event. Listeners
            to this event will receive an event facade, which contains previous and new xy values:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                // Listen to the "on" moment, if you're interested in
                // preventing the change in position from occuring.
                overlay.on("xyChange", function(e) {

                    var currPosition = e.prevVal;
                    var newPosition = e.newVal;

                    if (newPosition[0] > MAX_X || newPosition[1] > MAX_Y) {
                        // Stop move from occuring. 
                        e.preventDefault();
                    }
                });

                // Listen to the "after" moment, if you're just interested 
                // in being notified when the position has been changed.
                overlay.after("xyChange", function(e) {
                    var position = e.newVal;
                    console.log("Overlay has been moved to: " + position[0] + "," position[1]);
                });
            </textarea>

            <p>Note that changing just the <code>x</code> or <code>y</code> attribute value, individually, will still fire the <code>xy</code> change event. The <code>x</code> and 
            <code>y</code> attribute values are simply convenience wrappers which end up setting the <code>xy</code> attribute.</p>

            <p>XY position can also be set after construction, as with any attribute, using <code>set</code> to change the attribute value directly, or using the <code>move</code> method:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                overlay.set("x", 100);

                overlay.set("y", 200);

                overlay.set("xy", [100,200]);

                overlay.move(100,200);

                overlay.move([100,200]);
            </textarea>

            <p>The <a href="../examples/overlay/overlay-xy.html">Basic XY Positioning</a> example shows basic positioning in action.</p>

            <h5>Extended XY Positioning</h5>
            
            <p>Overlay also provides support to help position it relative to another node on the page, or the viewport, through the <code>align</code> and <code>centered</code> attributes, as well as 
            the corresponding <code>align()</code> and <code>centered()</code> convenience methods, through the application of the <code>WidgetPositionExt</code> extension.</p>

            <p>The <code>align</code> attribute accepts as a value an object literal with the following properties:</p>
            <dl>
                <dt>node</dt>
                <dd>
                  The node to which the Widget is to be aligned. If set to null, or not provided, the Overlay is aligned to the viewport
                </dd>
                <dt>points</dt>
                <dd>
                  <p>
                  A two element array, defining the two points on the Overlay and node which are to be aligned. The first element is the point on the Overlay, and the second element is the point on the node (or viewport).
                  Supported alignment points are defined as static properties on <a href="../api/WidgetPositionExt.html#property_WidgetPostionExt.TL"><code>WidgetPositionExt</code></a>.
                  </p>
                  <p>
                  e.g. <code>[WidgetPositionExt.TR, WidgetPositionExt.TL]</code> aligns the Top-Right corner of the Overlay with the
                  Top-Left corner of the node/viewport, and <code>[WidgetPositionExt.CC, WidgetPositionExt.TC]</code> aligns the Center of the 
                  Overlay with the Top-Center edge of the node/viewport.
                  </p>
                </dd>
            </dl>

            <textarea name="code" class="JScript" cols="60" rows="1">
                // Align the:
                // top-left corner of the overlay, with the 
                // top-right corner of the node with id = "okBtn"
                overlay.set("align", {
                    node:"#okBtn,
                    points:[WidgetPositionExt.TL, WidgetPositionExt.TR]
                });

                // Align the:
                // right-center edge of the overlay, with the 
                // right-center edge of the viewport (no node specified)
                overlay.set("align", {
                    points:[WidgetPositionExt.RC, WidgetPositionExt.RC]
                });
                
                // Align the:
                // center of the overlay, with the 
                // top-left corner of the node with id = "okBtn"
                overlay.align("#okBtn", [WidgetPostionExt.CC, WidgetPositionExt.TL]);
            </textarea>

            <p>The <code>centered</code> property can either by set to <code>true</code> to center the Overlay in the viewport, or set to a selector string or node reference to center the Overlay in a particular node.</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                // Center the overlay in the node with id = "module"
                overlay.set("align", {
                    centered:"#module
                });

                // Center the overlay in the viewport
                overlay.set("align", {
                    center:true
                });
            </textarea>

            <p>The <a href="../examples/overlay/overlay-align.html">"Extended XY Positioning"</a> example shows extended positioning in action.</p>

            <p>Note that currently alignment/centering is not maintained when the viewport is scrolled, window resized etc. Support to re-align the overlay on a default and custom set of trigger events will be 
            provided in a future release.</p>

            <h4 id="stacking">Stacking</h4>

            <p>
            The Overlay provides basic stacking support in the form of a <code>zIndex</code> attribute and a <code>shim</code> attribute. The shimming support protects against &lt;select&gt; box bleed through on 
            IE6 (It is enabled by default for IE6) by adding an iframe shim to the overlay's bounding box (positioned underneath the content box). The default value of the <code>zIndex</code> attribute is 0.</p>
            
            <p>Using the <code>zIndex</code> and <code>shim</code> attributes is the same as any other attribute, with the ability to set values in the constructor, or at a later point in time:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                // Disable shim for all browsers, set zIndex to 10
                var overlay = new Y.Overlay({
                    shim:false, // Disable for all browsers, including IE6
                    zIndex:10
                });
                
                // Set zIndex to 10. Shim is enabled for IE6 but disabled for all
                // other browsers (default value)
                var overlay = new Y.Overlay({
                    zIndex:10
                });
            </textarea>

            <p>Stacking support also provides support to protect against scroll bar bleed through in older Gecko browsers on the Mac (Firefox 2 for example), by the application "overflow:auto" to the bounding box,
            using the following rules:</p>

            <textarea name="code" class="CSS" cols="60" rows="1">
                /* The following rules are applied, only for Gecko < 1.9 on Mac OS (Firefox 2/mac for example]) */
            
                /* 
                   Applied when the Overlay is shown.
                   Prevents bleedthrough of scrollbars under the overlay. 
                */
                .yui-widget-show-scrollbars {
                    overflow: auto;
                }

                /* 
                   Applied when the Overlay is hidden.
                   Prevents scrollbars inside the overlay from remaining visible. 
                */
                .yui-widget-hide-scrollbars,
                .yui-widget-hide-scrollbars * {
                    overflow: hidden;
                }
            </textarea>

            <p>The <a href="../examples/overlay/overlay-stack.html">"Stack Support"</a> example creates a simple "bringToTop" implementation based on the <code>zIndex</code> attribute. 
            This support will be provided as part of Overlay itself (or more precisely, as part of <code>WidgetStack</code>) in a future release.</p>

            <h4 id="content">Setting Section Content</h4>

            <p>Overlay uses the standard module format for its rendering. It provides a header, body and footer section as described above (through the <code>WidgetStdMod</code> extension).</p>

            <h5>Replacing Content</h5>

            <p>The content for each of these sections is settable either through the <code>headerContent</code>, <code>bodyContent</code> and <code>footerContent</code> attributes. Setting the content
            through these properties will replace any existing content in the section. The content can either be specified as a string, in which case innerHTML will be used to set the new content, or 
            specified as a <code>Node</code> instance, in which case the content will be added to the respective section using <code>appendChild</code> after clearing existing content.</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                var overlay = new Y.Overlay({
                    headerContent: '&lt;span class="title" &gt;My Header Content&lt;/span&gt;',
                    bodyContent: '&lt;div class="mod" &gt;My Body Content&lt;/div&gt;'
                    // Don't want a footer
                });
                
                // or 

                overlay.set("headerContent", '&lt;span class="title" &gt;My Header Content&lt;/span&gt;');
                
                // or 

                var headerContent = Y.Node.create("&lt;span&gt;&lt;/span&gt;");
                headerContent.set("innerHTML", "My Header Content");
                headerContent.addClass("title"); 

                overlay.set("headerContent", headerContent);
            </textarea>
            
            <p>Overlay will not create the section if there has been no content set for it. (So, for example, the overlay above will not have a footer section). Also, if the section doesn't exist it will be created,
            the first time content is set for it.</p>

            <p>As with any attribute change, you can listen for (and prevent) changes in content by listening for the corresponding attribute change event:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                overlay.on("bodyContentChange", function(e) {
                    if (someCondition) {
                        // Don't allow body content to be updated
                        e.preventDefault():
                    }
                });

                overlay.after("bodyContentChange", function(e) {
                    // body section has been modified
                });
            </textarea>

            <p>Setting content in any of the sections will fire Widget's <code>contentUpdate</code> event, which can be monitored if you want to be notified of changes to any section, however this event is purely a catch-all notification
            event. It cannot be prevented to stop the content change from occuring:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                overlay.after("contentUpdate", function(e) {
                    // Content has been updated in one of the standard module sections.
                });
            </textarea>

            <h5>Inserting/Appending Content</h5>

            <p>Setting content using the attributes mentioned above always results in content being replaced. If you need to insert content before, or append content after, existing content in the section, you can use the <code>setStdModContent(section, content, where)</code> method Overlay provides:</p>

            <textarea name="code" class="JScript" cols="60" rows="1">
                overlay.setStdModContent(
                    WidgetStdMod.HEADER,       // Section
                    "New Content To Insert",   // Content
                    WidgetStdMod.BEFORE        // Where
                );

                overlay.setStdModContent(
                    WidgetStdMod.FOOTER,      // Section
                    "New Content To Append",  // Content
                    WidgetStdMod.AFTER        // Where
                );
            </textarea>

            <ul>
                <li>The <code>section</code> argument specifies which section is to be updated. The constants <code>WidgetStdMod.HEADER</code>, <code>WidgetStdMod.BODY</code> and <code>WidgetStdMod.FOOTER</code> define valid values.</li>
                <li>The <code>content</code> argument specifies the new content to be added, which, as with the attributes can be a string HTML value or a node reference.</li>
                <li>The <code>where</code> argument specifies whether the content should be added before, after or replace existing content. The constants <code>WidgetStdMod.BEFORE</code>, <code>WidgetStdMod.AFTER</code> and <code>WidgetStdMod.REPLACE</code></p> define valid values.</li>
            </ul>

            <p><em>Note, the above <code>WidgetStdMod</code> constants define the set of valid values wherever the API expects a "section" or "where" argument.</em></p>

            <p>The content change events mentioned above, will be fired when content is set through the <code>setStdModContent</code> method just as they would when setting the content using the attribute.</p>

            <p>The <a href="../examples/overlay/overlay-stdmod.html">Standard Module</a> example provides a way to exercise the above content attributes and methods.</p>

            <h4 id="markup">Markup Structure</h4>

            <p>The final rendered Overlay has the markup structure shown below:</p>

            <textarea name="code" class="HTML" rows="1" cols="60">
                &lt;div class="yui-widget yui-overlay yui-widget-positioned yui-widget-stacked"&gt; &lt;!--Bounding Box--&gt;

                    &lt;div class="yui-overlay-content yui-widget-stdmod"&gt;                       &lt;!--Content Box--&gt;

                        &lt;div class="yui-widget-hd"&gt;Overlay Header Content&lt;/div&gt;  &lt;!--Header Section--&gt;
                        &lt;div class="yui-widget-bd"&gt;Overlay Body Content&lt;/div&gt;    &lt;!--Body Section--&gt;
                        &lt;div class="yui-widget-ft"&gt;Overlay Footer Content&lt;/div&gt;  &lt;!--Footer Section--&gt;

                    &lt;/div&gt;

                    &lt;iframe class="yui-widget-shim"&gt;&lt;/iframe&gt  &lt;!-- Stacking shim, if enabled--&gt;

                &lt;/div&gt;
            </textarea>

            <p>The bounding box is absolutely positioned by default, and top/left positioning and z-index values are applied to it. The nested bounding box/content box structure is discussed in detail on the <a href="../widget/index.html#markup">Widget markup discussion</a>.</p>

            <p>In addition to the default classes applied to the bounding box and content box for all widgets ("yui-overlay", "yui-overlay-content", "yui-widget"), the <code>WidgetStdMod</code>, <code>WidgetPositioned</code> and <code>WidgetStack</code> extensions also mark the appropriate boxes with 
            "yui-widget-stdmod", "yui-widget-positioned" and "yui-widget-stacked" classes as shown above.</p>

            <p>The iframe shim, added if <code>shim</code> is enabled, is added to the bounding box, as sibling to the content box and stacked underneath it (using a -ve z-index).</p>

            <h4 id="css">CSS</h4>

            <p>Overlay is a generic, foundation widget and doesn't ship with a default look/feel out of the box. Its Sam Skin (build/overlay/assets/skins/sam/overlay.css) implementation consists only of core functional rules, to control how it is positioned and how it is hidden:</p>

            <textarea name="code" class="CSS" cols="60" rows="1">
                .yui-overlay {
                    position:absolute;
                }

                .yui-overlay-hidden {
                    visibility:hidden
                }
            </textarea>

            <p>Since it includes the <code>WidgetStack</code> extension, the following functional CSS is also provided (through build/widget/assets/skins/sam/widget-stack.css) to handle the shim element,
            (along with the Gecko/Mac scroll bar support CSS mentioned above)</p>

            <textarea name="code" class="CSS" cols="60" rows="1">
                .yui-widget-stacked .yui-widget-shim {
                    opacity:0;
                    filter:alpha(opacity=0);
                    position:absolute;
                    border:none;
                    top:0px;
                    left:0px;
                    padding:0;
                    margin:0;
                    z-index:-1;
                    width:100%;
                    height:100%;
                    /* 
                       We'll be setting these programmatically for IE6, 
                       to account for cases where height is not set 
                    */
                    _width:0;
                    _height:0;
                }
            </textarea>

            <?php # include "../inc/mobileSection.inc";?>
            <?php include "../inc/support.inc"; ?>

        </div>
        <div class="yui-u sidebar">

            <div id="examples">
                <?php include("../inc/examplesNav/".$section.".inc"); ?>
            </div>

            <!-- delicious module -->
            <?php require('../inc/mod-delicious.inc'); ?>
            <!-- /delicious module -->

        </div>
      </div>
</div>
</div>
<?php include "../inc/side.inc" ?>
<?php include "../inc/footer.inc" ?>
