<?php
$title="The IO Utility";
$section="io";
$component="IO Utility";
$highlightSyntax = true;
$releasenotes = true;
include "../inc/header.inc";
?>
<div id="yui-main">
	<div class="yui-b">
		<div class="yui-ge">
			<div class="yui-u first" id="main">
			<!-- main column -->

				<h2><?php echo $component;?></h2>

				<div id="promo" class="component">
					<p></p>
					<div class="yui-g">
						<div class="yui-u first">
							<div id="jumps">
								<h4>On This Page</h4>
								<ul>
									<li><a href="#start">Getting Started</a></li>
									<li><a href="#using">Using the <?php echo $component;?></a>
										<ul class="topspace">
										<li><a href="#IO">Using YUI.io</a></li>
										<li><a href="#issues">Known Issues</a></li>
										</ul></li>
									<li><a href="#support">Support &amp; Community</a></li>
									<li><a href="#filingbugs">Bug Reports &amp; Feature Requests</a></li>
								</ul>
							</div>
						</div>
						<div class="yui-u">
							<?php
							include('../inc/quicklinks.inc');
							?>
						</div>
					</div>
					<div class="clear"></div>
				</div><!-- /promo -->

				<h3 id="start">Getting Started</h3>

				<h4 id="dependencies">Include Dependencies</h4>

				<p>To use <?php echo $component;?>, include the following source files in your web page with the script tag:</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;!-- Dependencies --&gt;
				&lt;script src=&quot;http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/yui/yui.js&quot; type="text/javascript"&gt;&lt;/script&gt;

				&lt;!-- Source file --&gt;
				&lt;script src=&quot;http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/io.js&quot; type="text/javascript"&gt;&lt;/script&gt;
				</textarea>
				<p>NOTE: Cross-domain transactions with IO require the use of io.swf.  Make sure this dependency is deployed and accessible by io.js.

				<?php
				include "../inc/include-notice.inc";
				?>

				<h4 id="your id here">A Simple Transaction</h4>
				<p>
				<code>io()</code> is the primary method for making an HTTP request.  This method accepts two arguments: uri and the configuration object.
				</p>
				<ul>
					<li><strong>uri:</strong> This parameter specifies the URI for the transaction</li>
					<li><strong>configuration:</strong> This parameter is an object of keys and values of configurations specific to the transaction.  Please see: <a href="">The Configuration Object</a> for more information on all available configuration properties.</li>
				</ul>
				<p>
				YUI.io returns an object with the following members:
				</p>
				<ul>
					<li><strong>id:</strong> This is the unique identifier of the transaction.</li>
					<li><strong>abort():</strong> Aborts the specific transaction.</li>
					<li><strong>isInProgress:</strong> A boolean value indicating whether the transaction has completed.</li>
				</ul>
				<p>
				This is an example GET transaction, handling the response at the earliest opportunity.
				</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;script&gt;
				// Create a YUI instance using IO module.
				var Y = new YUI().use("io");
				var uri = "get.php?foo=bar";

				// Define a function to handle the response data.
				function complete(id, o, args) {
				  var id = id; // Transaction ID.
				  var data = o.responseText; // Response data.
				  var args = args[1]; // 'ipsum'.
				};

				// Subscribe to event "io:complete", and pass an array
				// as an argument to the event handler "complete". Since
				// "complete" is global.
				// At this point in the transaction lifecycle, success or
				// failure is not yet know.
				Y.on('io:complete', complete, this, ['lorem', 'ipsum']);

				// Make an HTTP request to 'get.php'.
				// NOTE: This transaction does not use a configuration object.
				var request = Y.io(uri);
				&lt;/script&gt;
				</textarea>

				<h3 id="IO">Using IO</h3>

				<p>This section describes how to use the <?php echo $component;?> in further detail.  It contains these subsections:</p>
				<ul class="topspace">
					<li><a href="#configuration">The Configuration Object</a></li>
					<li><a href="#events">Events</a></li>
					<li><a href="#xdr">Cross-Domain Requests</a></li>
					<li><a href="#headers">Setting HTTP Headers</a></li>
					<li><a href="#queue">Queue</a></li>
				</ul>

				<h4 id="configuration">The Configuration Object</h4>

				<p>This object is the second argument of <code>YUI.io()</code>.  Its configurations help define transaction parameters and transaction response handling.  The configuration object, as well as all configuration properties are optional.  The following table describes all configuration properties used by <code>IO</code>.</p>

				<table>
					<thead>
						<tr>
							<th>Property</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>method (string)</td>
							<td>Defines the HTTP method for the transaction.  If this property is undefined or omitted, the default value is GET.</td>
						</tr>
						<tr>
							<td>data (string)</td>
							<td>Transaction data as a string of key-value pairs (e.g., <code>"foo=bar&baz=boo"</code>).  If the HTTP method is GET, the data are appended to the URI to form a querystring.  If HTTP POST, the data are passed as the message body.</td>
						</tr>
						<tr>
							<td>headers (object)</td>
							<td>Specific HTTP headers and values to be sent with the transaction (e.g., <code>{ 'Content-Type': 'application/xml; charset=utf-8' } </code>).</td>
						</tr>
						<tr>
							<td>on (object)</td>
							<td>This object defines the events and event handlers to be used for the transaction.  These events fire in addition to the global IO events.  Define as many events as desired for the transaction; all events handlers are optional.
								<ul class="topspace">
									<li><strong>start:</strong> <em>event handler</em></li>
									<li><strong>complete:</strong> <em>event handler</em></li>
									<li><strong>success:</strong> <em>event handler</em></li>
									<li><strong>failure:</strong> <em>event handler</em></li>
									<li><strong>abort:</strong> <em>event handler</em></li>
								</ul>
							NOTE: These events are accessible only to the transaction's subscribers, whereas global IO events are accessible by all subscribers.
							</td>
						</tr>
						<tr>
							<td>context</td>
							<td>Defines the execution context of the event handler functions for the transaction. If undefined, a default value of <code>window</code> is used.</td>
						</tr>
						<tr>
							<td>form (object)</td>
							<td>This object instructs IO to use the labels and values of the specified HTML form as transaction data.
								<ul class="topspace">
									<li><strong>id:</strong> This property can be defined as the id(String) of an HTML form or an object reference of the HTML form.</li>
									<li><strong>useDisabled:</strong> When set to <strong>true</strong>, disabled field values are included as data.  The default value is false.</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td>xdr (object)</td>
							<td>Defines the transport to be used for cross-domain requests (e.g., <code>{ use:'flash' }</code> ).  The transaction will use the specified transport instead of XMLHttpRequest.  Currently, the only alternate transport supported is Flash, requiring Flash Player 9 (player 9.0.124 is recommended).
							</td>
						</tr>
						<tr>
							<td>arguments (object)</td>
							<td><p>Object, array, string, or number passed to all registered, transaction event handlers.  This value is available as the second argument in the "start" and "abort" event handlers; and, it is the third argument in the "complete", "success", and "failure" event handlers.</p></td>
						</tr>
						<tr>
							<td>timeout</td>
							<td>This value, defined as milliseconds, is a time threshold for the transaction (e.g., <code>{ timeout: 2000 }</code> ). When this limit is reached, and the transaction's Complete event has not yet fired, the transaction will be aborted.</td>
						</tr>
					</tbody>
				</table>
				<p>
				This is an example of a configuration object, with all properties defined.
				</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				/*
				 * This is an example configuration object will all properties defined.
				 *
				 * method: This transaction will use HTTP POST.
				 * data: "user=yahoo" will comprise the POST message.
				 * headers: Object of HTTP request headers for this transaction.  The
				 *          first header defines "Content-Type" and the second is a
				 *          custom header.
				 * on: Object of defined event handlers for "start", "complete",
				 *     and "abort".  These handlers are methods of an object
				 *     named "Dispatch".
				 * context: Event handlers will execute in the propert object context,
				 *          so usage 'this' will reference Dispatch.
				 * form: Object specifying the HTML form to be serialized into a key-value
				 *       string and sent as data; and, informing IO to include disabled
				 *       HTML form fields as part of the data.
				 * xdr: Informs IO to use the defined transport, in this case Flash,
				 *      to make a cross-domain request for this transaction.
				 * arguments: Object of data, passed as an argument to the event
				 *            handlers.
				 */
				var cfg = {
					method: 'POST',
					data: 'user=yahoo',
					headers: {
						'Content-Type': 'application/json',
						'X-TRANSPORT-TYPE': 'Flash'
					},
					on: {
						start: Dispatch.start,
						complete: Dispatch.complete,
						abort: Dispatch.abort
						}
					},
					context: Dispatch,
					form: {
						id: formObject,
						useDisabled: true
					},
					xdr: { use: 'flash' },
					arguments: {
						start: 'foo',
						complete: 'bar',
						abort: 'baz'
					}
				};
				</textarea>

				<h4 id="response">The Response Object</h4>
				<p>
				When a transaction is complete, the response data are passed as an object to the event handler.
				</p>
				<table>
					<thead>
						<tr>
							<th>Field</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody>
					<tr>
					  <td><strong>status</strong></td>

					  <td>The HTTP status code of the transaction.</td>
					</tr>
					<tr>
					  <td><strong>statusText</strong></td>
					  <td>The HTTP status message.</td>
					</tr>
					<tr>

					  <td><strong>getResponseHeader(<em>headername</em>)</strong></td>
					  <td>Returns the string value of the specified header label.</td>
					</tr>
					<tr>
					  <td><strong>getAllResponseHeaders</strong></td>
					  <td>All response HTTP headers are available as a string.  Each label-value pair is delimited by "\n".</td>

					</tr>
					<tr>
					  <td><strong>responseText</strong></td>
					  <td>The response data as a unicode string.</td>
					</tr>
					<tr>
					  <td><strong>responseXML</strong></td>
					  <td>The response data as an XML document object.</td>
					</tr>
					</tbody>
				  </table>

				<h4 id="events">Events</h4>
				<p>
					IO events provide access to data during a transaction's lifecycle.  There are two aspects to IO events: global and transaction.  Global events are fired by IO for all transactions, and these events are accessible to all event subscribers.  Transaction events are created and fired only if their event handlers are defined in the configuration object.  Global events are identified by the <code>io:eventname</code> pattern.  The following example describes the event subscription syntax for global events:
				</p>
				<p>
				The following table describes the available IO events:
				</p>
				<table>
					<thead>
						<tr>
							<th>Event</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td><strong>io:start</strong></td>
							<td>
							<p>Fires when a request is made to a resource.  The event handler's arguments signature is:</p>
							<textarea name="code" class="HTML" cols="60" rows="1">
							function onStart(transactionid, arguments) {
							  // transactionid : The transaction's ID.
							  // arguments: Array ['foo','bar'].
							}

							// Subscribe to "io.start".
							Y.on('io:start', onStart, this, { start: ['foo','bar']; );
							</textarea>
							</td>
						</tr>
						<tr>
							<td><strong>io:complete</strong></td>
							<td>
							<p>Fires after "io:start", when the transaction is complete and response data are available.  This is the earliest opportunity to access any response data.  The event handler's arguments signature is:</p>
							<textarea name="code" class="HTML" cols="60" rows="1">
							function onComplete(transactionid, response, arguments) {
							  // transactionid : The transaction's ID.
							  // response: The response object.
							  // arguments: Object containing an array { complete: ['foo', 'bar'] }.
							}

							// Subscribe to "io.complete".
							Y.on('io:complete', onComplete, this, { complete: ['foo', 'bar'] } );
							</textarea>
							</td>
						</tr>
						<tr>
							<td><strong>io:success</strong></td>
							<td>
							<p>Fires after the "complete" event, when the response HTTP status resolves to 2xx.  The event handler's arguments signature is:</p>
							<textarea name="code" class="HTML" cols="60" rows="1">
							function onSuccess(transactionid, response, arguments) {
							  // transactionid : The transaction's ID.
							  // response: The response object.
							  // arguments: Boolean "true".
							}

							// Subscribe to "io.success".
							Y.on('io:success', onSuccess, this, true);
							</textarea>
							</td>
						</tr>
						<tr>
							<td><strong>io:failure</strong></td>
							<td>
							<p>Fires after the "complete" event, when the response HTTP status resolves to 4xx. 5xx, or any undefined HTTP status.  The event handler's arguments signature is:</p>
							<textarea name="code" class="HTML" cols="60" rows="1">
							function onFailure(transactionid, response, arguments) {
							  // transactionid : The transaction's ID.
							  // response: The response object.
							  // arguments: String "Transaction Failed".
							}
							// Subscribe to "io.failure".
							Y.on('io:failure', onFailure, this, 'Transaction Failed');
							</textarea>
							</td>
						</tr>
						<tr>
							<td><strong>io:abort</strong></td>
							<td>
							<p>Fires when a request times out, or when the transaction is explicitly aborted.  The event handler's arguments signature is:</p>
							<textarea name="code" class="HTML" cols="60" rows="1">
							function onFailure(transactionid, arguments) {
							  // transactionid : The transaction's ID.
							  // arguments: Number 0.
							}

							// Subscribe to "io.abort".
							Y.on('io:abort', onAbort, this, 0);
							</textarea>
							</td>
						</tr>
						<tr>
							<td><strong>io:xdrReady</strong></td>
							<td>
							Fires when the XDR transport is ready for use.  This event only fires once when the transport initialization is complete.
							</td>
						</tr>
					</tbody>
				</table>

				<p>The following example demonstrates an IO transaction with an event handler subscribed to "io:complete".</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				// Create a YUI instance using IO module.
				var Y = new YUI().use("io");

				/*
				 * Create a function as the event handler for the event "io:complete".
				 *
				 * The function will receive the following arguments:
				 * - The ID of the transaction
				 * - Object containing the response data.
				 * - Argument one defined when subscribing to the event(e.g., "foo").
				 * - Argument two defined when subscribing to the event(e.g., "bar").
				 */
				function onComplete(transactionId, responseObject, arg1, arg2) {
					/*
					 * The argument 'responseObject' is the response object.  Its
					 * properties are:
					 * - status
					 * - statusText
					 * - getResponseHeader(headerName)
					 * - getAllResponseHeaders
					 * - responseText
					 * - responseXML
					 *
					 * NOTE: In an XDR transaction, only the responseText property is defined.
					 */
				};

				/*
				 * Subscribe to the event "io:complete", using Y.on.
				 *
				 * - 'io:complete' : Subscribe to this IO event.
				 * - onComplete : The event handler to be subscribed to 'io:complete'.
				 * - this : The execution context of the event handler, in this case 'this'
				 *          since the doComplete is defined as a global function.
				 * - 'foo' : The first argument received by the event handler.
				 * - 'bar' : The second argument received by the event handler.
				 *           Additional arguments can be defined, as desired.
				 */
				Y.on('io:complete', onComplete, this, "foo", "bar");

				// Starts the transaction.
				var request = Y.io(uri);
				</textarea>

				<h4 id="xdr">Cross-Domain Transactions</h4>
				<p>By default, IO uses the XMLHttpRequest object as the transport for HTTP transactions.  IO can also be instructed to use an alternate transport to make cross-domain, HTTP transactions.  Currently, IO can make use of Flash as an alternate transport for such requests.  To prepare IO for cross-domain transactions, the transport must be initialized and the file "io.swf" is deployed and accessible.  For each transaction, the configuration object's <code>xdr</code> property must be defined with <code>{ use: 'flash' }</code> so IO will use the designated transport, instead of using the default transport of XMLHttpRequest.</p>
				<p>
				As <code>io.swf</code> is written in ActionScript 3, Flash Player 9 or better is required (version <strong>9.0.124</strong> or better is recommended).  Additionally, a cross-domain policy file must be deployed at the resource to grant the client access to the remote domain.  A cross-domain request will not be successful without this policy file hosted at the resource.  The following example file grants permissive access to the host from all requests, but the host will only accept custom HTTP headers originating from <code>yahoo.com</code>.
				</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;?xml version="1.0"?&gt;
				&lt;!DOCTYPE cross-domain-policy SYSTEM
				"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd"&gt;
				&lt;cross-domain-policy&gt;
					&lt;allow-access-from domain="*"/&gt;
					&lt;allow-http-request-headers-from domain="*.yahoo.com" headers="*"/&gt;
				&lt;/cross-domain-policy&gt;
				</textarea>
				<p>
				For more information on cross-domain policy file specifications, see the following articles at Adobe Developer Connection.
				</p>
				<ul>
					<li><a href="http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html">Cross-Domain Policy File Specifications</a>.</li>
					<li><a href="http://kb.adobe.com/selfservice/viewContent.do?externalId=kb403030">HTTP Headers Blacklist</a>.</li>
				</ul>
				<p>
				The following example demonstrates a cross-domain transaction, starting with the initialization of the XDR transport, and subscribing to three global IO events.
				</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;script&gt;
				// Create a YUI instance using IO.
				var Y = new YUI().use('io');

				// Create a configuration object containing three defined properties:
				// id: Identifies the transport to be used.
				// yid: The ID of the YUI instance.
				// src: The path to the Flash file.
				var xdrCfg = {
					id:'flash',
					yid: Y.id,
					src:'io.swf'
				};

				// Initialize the define transport
				Y.io.transport(xdrCfg);

				// Define the configurations to be used for each transaciton.
				// Since cfg.method isn't defined, the HTTP method will
				// default to GET.
				var cfg = {
				  data: "xdr=true", // Transaction data sent to the URI.
				  use: 'flash', // Instruct IO to use the XDR transport.
				  timeout: 3000, // Abort the transaction, if it is still pending, after 3000ms.
				  arguments: {
				    start: 'foo',
				    complete: 'bar',
				    abort: 'baz'
				  } // An object passed, as an argument, to the event handlers.
				};

				/*
				 * GlobalEventHandler is an example object that encapsulates
				 * event handlers for "io:start", "io:complete", and "io:abort".
				 *
				 * start( ) // Event handler for "io:start"
				 * complete( ) // Event handler for "io:complete".
				 * abort( ) // Event handler for "io:abort".
				 */
				var GlobalEventHandler = {
				  start: function(id, args) {
				    var args = args.start // 'foo'
				  },
				  complete: function(id, o, args) {
				    var args = args.complete // 'bar'

				    // Note: Only strings are supported in an XDR response.
				    // o.responseXML is not supported at this time.
				    var data = o.responseText;
				  },
				  abort: function(id, args) {
				    var args = args.abort // args = 'baz'
				  }
				};

				// Subscribe GlobalEventHandler.start to event "io:start".
				Y.on('io:start', GlobalEventHandler.start, this);
				// Subscribe GlobalEventHandler.complete to event "io:complete".
				Y.on('io:complete', GlobalEventHandler.complete, this);
				// Subscribe GlobalEventHandler to event "io:abort".
				Y.on('io:abort', GlobalEventHandler.abort, this);
				&lt;/script&gt;

				// Start the transaction
				var request = Y.io(uri, cfg);
				</textarea>

				<h4 id="headers">Setting HTTP Headers</h4>
				<p>
				IO can be configured to send default HTTP Headers for all transactions, in addition to any HTTP headers defined in the configuration object.  Headers can be set or removed as needed.  The following example shows how to set and how to delete default headers in IO:
				</p>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;script&gt;
				// Create a YUI instance using IO.
				var Y = new YUI().use('io');

				// Set a new default HTTP header.
				Y.io.header('Content-Type', 'application/json');

				// To remove an existing header, use the same method, but omit the value.
				Y.io.header('Content-Type');
				&lt;/script&gt;
				</textarea>

				<h4 id="queue">Queue</h4>
				<p>
				IO provides a basic mechanism for storing transactions for future processing.  The queue can be configured to store a set number of transactions, and transactions can be promoted to the front of the queue, or they can be purged from the queue.
				</p>
				<table>
					<thead>
						<tr>
							<th>Field</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody>
					<tr>
					  <td><strong>queue(uri, configuration)</strong></td>
					  <td>Method signature is identical to IO, but returns the id of the transaction, or false if the transaction cannot be placed in the queue.</td>
					</tr>
					<tr>
					  <td><strong>queue.start()</strong></td>
					  <td>Activates the queue, and begins processing transactions in the queue.  This is the default state of the queue.</td>
					</tr>
					<tr>

					  <td><strong>queue.stop()</strong></td>
					  <td>Deactivates the queue.  Transactions sent to queue() will be stored until the queue is started.</td>
					</tr>
					<tr>
					  <td><strong>queue.size(n)</strong></td>
					  <td>Sets the maximum number of transactions that can be stored in the queue, when the queue is stopped.  When this limit is reached, additional transactions sent to queue() will return false.</td>
					</tr>
					<tr>
					  <td><strong>queue.promote(id)</strong></td>
					  <td>Moves the specified transaction stored in the queue to the head of the queue.</td>
					</tr>
					<tr>
					  <td><strong>queue.purge(id)</strong></td>
					  <td>Deletes the specified transaction stored in the queue.</td>
					</tr>
					</tbody>
				</table>
				<textarea name="code" class="HTML" cols="60" rows="1">
				&lt;script&gt;
				// Create a YUI instance using IO.
				var Y = new YUI().use('io');

				// Stop the queue so transactions can be stored.
				Y.queue.stop();

				// Send three transactions into the queue for storage.
				var task0 = Y.queue(uri);
				var task1 = Y.queue(uri);
				var task2 = Y.queue(uri);

				// This IO request is processed immediately.
				var task3 = Y.io(uri);

				// Promote task2 to the top of the queue.
				Y.queue.promote(task2);

				// Purge task1 from the queue.
				Y.queue.purge(task1);

				// Re-start the queue.
				// Transactions are sent in the following order: task2, task0.
				Y.queue.start();

				&lt;/script&gt;
				</textarea>

				<h3 id="issues">Known Issues</h3>
				<ul>
					<li>Cross-domain requests, in PR1</li>
						<ul>
							<li>Custom HTTP headers are only sent with HTTP POST.  This is a Flash Player issue.</li>
							<li>Only <code>responseText</code> is populated in the response object.  HTTP status and HTTP response headers are not available.  These data are not accessible by Flash Player, except in IE.</li>
							<li>XML response data are not supported.</li>
							<li>Opera 9.50 and 9.51 will throw a Security Exception, even with a valid crossdomain.xml file deployed at the resource.</li>
						</ul>
					<li>Forms features not supported with PR1</li>
						<ul>
							<li>File uploading.</li>
							<li>Multiple HTML Submit buttons in one HTML form.</li>
						</ul>
				</ul>

<?php # include "../inc/mobileSection.inc";?>
<!--<p>Animation on mobile devices is limited by processor and system overhead.  Even on PCs, animation within a web browser can tax the processor, and the processing power in mobile devices is much more limited.  In general, DOM animations will look choppy on a mobile device, so you may want to avoid them altogether if designing specifically for mobile.  Using an easing method in some cases helps to make the animation appear to run more smoothly.  On the iPhone specifically, the "easeBoth" easing, in our experience, provides the smoothest animation across most animation types.</p>-->
<?php
include "../inc/support.inc";
?>

		</div>
<div class="yui-u sidebar">

	<?php
	include "../inc/cheatsheet.inc";
	?>

			<div id="examples">
<?php
	include("../inc/examplesNav/".$section.".inc");
?>
		   </div>

		<!-- delicious module -->
		<?php require('../inc/mod-delicious.inc'); ?>
		<!-- /delicious module -->


		 </div>
      </div>

</div>
</div>

<?php include "../inc/side.inc" ?>
<?php include "../inc/footer.inc" ?>




