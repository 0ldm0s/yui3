<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>Attribute</title>
    <script type="text/javascript" src="../build/yui/yui.js"></script>
    <script type="text/javascript" src="../build/base/base.js"></script>
    <script type="text/javascript" src="../build/dom/dom.js"></script>    
    <script type="text/javascript" src="../build/attribute/attribute-debug.js"></script>

    <script type="text/javascript">

    (function() {
        var Y = YUI().use("dump", "base");
        var CLONE_ENUM = Y.Attribute.CLONE;

        // ----- Main Class -----
        function ClassOne(config) {
            ClassOne.superclass.constructor.apply(this, arguments);
        }

        ClassOne.NAME = "main";

        ClassOne.ATTRS = {
            A: {
                value : {
                    a : {
                        aa : "foo"
                    },
                    b : "bar"
                },
                clone : CLONE_ENUM.DEEP
            },

            B: {
                value : {
                    b : {
                        bb : [0,1,2]
                    }
                },
                clone : CLONE_ENUM.SHALLOW
            },

            C: {
                value : {
                    c : {
                        cc : Y.Node.get("#foo")
                    }
                }
            },

            D: {
                value : {
                    d : {
                        dd : 15
                    }
                }
            },

            E: {
                value : {foo:"Ebar"},
                set: function(val) {
                    val.foo += "Modified";
                }
            },

            F: {
                value : "Ffoo",
                readOnly: true,
                set : function(val) {
                    return val.toUpperCase();
                }
            },

            G: {
                writeOnce: true,
                value:"GFoo"
            },
            
            H: {
                value:"HFoo",
            }
        };

        Y.extend(ClassOne, Y.Base);

        x = new ClassOne({G:"GBar"});

        var valA = x.get("A");
        Y.log("Attempt Ref Change");

        valA.b = "Changed a.b reference";
        valA.a.aa = "Changed a.a.aa reference";

        x.set("A.a.aa", "legit");

        Y.log(x.get("A"));
        Y.log(x.get("A.a"));
        Y.log(x.get("A.a.aa"));
        Y.log(x.get("A.b"));

        x.on("EChange", function(e) {
            Y.log("ON");
            Y.log(e.prevVal);
            Y.log(e.newVal);
            Y.log(e.attrName);
            Y.log(this.get("E"));
            // e.preventDefault();
        });

        x.after("EChange", function(e) {
            Y.log("AFTER");
            Y.log(e.prevVal);
            Y.log(e.newVal);
            Y.log(e.attrName);
            Y.log(this.get("E"));
        });

        x.set("E", {foo:"newbar"});
        x.set("F", "FShouldNotGetSet-ReadOnly");
        x.set("G", "GShouldNotGetSet-WriteOnce");
    })();
    </script>
</head>
<body>
    <div id="foo"></div>
</body>
</html>