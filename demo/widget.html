<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>Widget Class</title>

    <script type="text/javascript" src="../build/yui/yui.js"></script>

    <style type="text/css">
        .yui-pewidget, .yui-widget {
            background:#ccc;
            height:100px;
            overflow:hidden;
            border:1px solid #000;
            margin:5px;
        }

        .yui-pewidget-hidden, .yui-widget-hidden {
            visibility:hidden;
        }

        .yui-pewidget-focus, .yui-widget-focus {
            background-color: yellow;
        }
    </style>
</head>

<body class="yui-skin-sam">

    <button id="control-show" type="button">show widget 1</button>
    <button id="control-hide" type="button">hide widget 1</button>
    <button id="control-destroy" type="button">destroy widget 1</button>    

    <div id="alpha">Widget.Alpha</div>

    <div id="beta-box">
        <div id="beta-content">
            <span class="label">Widget.Beta</span>
        </div>
    </div>

	<div id="widget-3-container"></div>

    <script type="text/javascript">
        YUI({filter:"raw", base:"../build/"}).use("dump", "widget", function(Y) {

            function PEWidget(config) {
                PEWidget.superclass.constructor.apply(this, arguments);
            }

            PEWidget.NAME = "pewidget";

            PEWidget.ATTRS = {
                label : {
                    value: {
                        contents: null
                    }
                },
                
                strings : {
                    value : {
                        LABEL_A: "Foo",
                        LABEL_B: "Bar"
                    }
                }
            };

            PEWidget.HTML_PARSER = {
                label : function(node) {
                    var found = node.query("span.label");
                    if (found) {
                        return {
                            contents: found.get("innerHTML")
                        };
                    }
                }
            };

            Y.extend(PEWidget, Y.Widget);

			widget = new Y.Widget({ contentBox: '#alpha', width: 200 });
			widget.render();

			widget.on('click', function(e) {
				Y.log('"widget:focus" Custom Event');
			});

			Y.on('click', Y.bind(widget.show, widget), '#control-show');
			Y.on('click', Y.bind(widget.hide, widget), '#control-hide');

			widget2 = new PEWidget({ boundingBox: "#beta-box", contentBox: '#beta-content', "strings.LABEL_A" : "FooBar"});
			widget2.render();

            Y.log("label value from markup: " + widget2.get("label").contents, "info");
            Y.log("getStrings('en-US-1945') value: " + Y.dump(widget2.getStrings("en-US-1945")), "info");
            Y.log("getString('LABEL_A', 'fr-CA-tt') value: " + widget2.getString("LABEL_A", "fr-CA-tt"), "info");

            widget2.set("locale", "en-UK");
            widget2.set("strings", {LABEL_B:"JollyGoodFooISay"});

            Y.log("getStrings (en-UK): " + Y.dump(widget2.getStrings("en-uk")), "info");

            widget2.set("locale", "en");

            Y.log("getStrings (en): " + Y.dump(widget2.getStrings()), "info");

            var container = Y.Node.get("#widget-3-container"); 

			widget3 = new Y.Widget({ width: 200, height:200 });
			widget3.render(container);
            widget3.get("contentBox").set("innerHTML", "Widget Gamma");

            Y.on("click", function() {
                var widget1Ref = Y.Widget.getByNode('#alpha');

                widget1Ref.after("destroy", function() {
                    Y.log("widget1 destroyed");
                });

                if (widget1Ref) {
                    widget1Ref.destroy();
                }
            }, '#control-destroy');
        });
    </script>
</body>
</html>
